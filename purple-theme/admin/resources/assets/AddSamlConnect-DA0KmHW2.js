import{jsxs as c,Fragment as I,jsx as e}from"react/jsx-runtime";import{u as b,b as S,Z as P,T as F,a0 as y,a1 as g,bl as x,ai as T,ak as k,f,aj as A,c as w,g as C,e as D,P as V,F as j,h,L as H,bY as L,A as U,bZ as $}from"./index-C9t2UlUN.js";import{F as q}from"./FormAccess-DnQCcStE.js";import{V as z}from"./ViewHeader-cxZm8XhN.js";import{F as G}from"./FileUploadForm-DmYGfve4.js";import{K}from"./KeycloakTextInput-DrlF32nr.js";import{D as O}from"./DiscoveryEndpointField-Dgm9W27d.js";import{D as B,S as N}from"./SamlGeneralSettings-CdfgS81L.js";import{A as R}from"./Form-Cdw1qhWG.js";import"react";import"react-dom";import"./copy-icon-CYSS18Ce.js";import"./ToolbarContent-D6TJq6fk.js";import"./FileUpload-CTw4RKK1.js";import"./CodeEditor-Cp4g17EF.js";import"./EmptyStateBody-CyIhnUop.js";import"./EmptyStateSecondaryActions-BekVwNvY.js";import"./Modal-Bgkd26UL.js";import"./KeycloakTextArea-DChmurIP.js";import"./discovery-settings-sewf1As9.js";import"./ExpandableSection-DjAskWMd.js";import"./DisplayOrder-Dong-iTt.js";const W=()=>{const{t}=b(),m="saml",{realm:s}=S(),{setValue:n,register:p,setError:d,clearErrors:u,formState:{errors:i}}=P(),l=r=>{Object.entries(r).map(([a,o])=>n(`config.${a}`,o))},v=async r=>{if(u("discoveryError"),!r)return;const a=new FormData;a.append("providerId",m),a.append("file",new Blob([r]));try{const o=await T(`${k(f.baseUrl)}admin/realms/${s}/identity-provider/import-config`,{method:"POST",body:a,headers:A(await f.getAccessToken())});if(o.ok){const E=await o.json();l(E)}else d("discoveryError",{type:"manual",message:o.statusText})}catch(o){d("discoveryError",{type:"manual",message:o.message})}};return c(I,{children:[e(F,{headingLevel:"h2",size:"xl",className:"kc-form-panel__title",children:t("samlSettings")}),e(y,{label:t("serviceProviderEntityId"),fieldId:"kc-service-provider-entity-id",labelIcon:e(g,{helpText:t("serviceProviderEntityIdHelp"),fieldLabelId:"serviceProviderEntityId"}),isRequired:!0,helperTextInvalid:t("required"),validated:i.config?.entityId?"error":"default",children:e(K,{"data-testid":"serviceProviderEntityId",id:"kc-service-provider-entity-id",validated:i.config?.entityId?"error":"default",defaultValue:`${x.authServerUrl}/realms/${s}`,...p("config.entityId",{required:!0})})}),e(O,{id:"saml",fileUpload:e(y,{label:t("importConfig"),fieldId:"kc-import-config",labelIcon:e(g,{helpText:t("importConfigHelp"),fieldLabelId:"importConfig"}),validated:i.discoveryError?"error":"default",helperTextInvalid:i.discoveryError?.message,children:e(G,{id:"kc-import-config",extension:".xml",hideDefaultPreview:!0,unWrap:!0,validated:i.discoveryError?"error":"default",onChange:r=>v(r)})}),children:r=>e(B,{readOnly:r})})]})};function fe(){const{t}=b(),m=w(),s="saml",n=C({defaultValues:{alias:s,config:{allowCreate:"true"}}}),{handleSubmit:p,formState:{isDirty:d}}=n,{addAlert:u,addError:i}=D(),{realm:l}=S(),v=async r=>{delete r.discoveryEndpoint;try{await f.identityProviders.create({...r,providerId:s}),u(t("createIdentityProviderSuccess"),U.success),m($({realm:l,providerId:s,alias:r.alias,tab:"settings"}))}catch(a){i("createIdentityProviderError",a)}};return c(I,{children:[e(z,{titleKey:t("addSamlProvider")}),e(V,{variant:"light",children:e(j,{...n,children:c(q,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:p(v),children:[e(N,{}),e(W,{}),c(R,{children:[e(h,{isDisabled:!d,variant:"primary",type:"submit","data-testid":"createProvider",children:t("add")}),e(h,{variant:"link","data-testid":"cancel",component:r=>e(H,{...r,to:L({realm:l})}),children:t("cancel")})]})]})})})]})}export{fe as default};
//# sourceMappingURL=AddSamlConnect-DA0KmHW2.js.map
