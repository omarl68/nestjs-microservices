{"version":3,"file":"NewRealmForm-XufHYZyL.js","sources":["../../src/realm/add/NewRealmForm.tsx"],"sourcesContent":["import type RealmRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/realmRepresentation\";\nimport {\n  ActionGroup,\n  Button,\n  FormGroup,\n  PageSection,\n  Switch,\n} from \"@patternfly/react-core\";\nimport { useState } from \"react\";\nimport { Controller, useForm } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\nimport { useNavigate } from \"react-router-dom\";\n\nimport { adminClient } from \"../../admin-client\";\nimport { useAlerts } from \"../../components/alert/Alerts\";\nimport { FormAccess } from \"../../components/form/FormAccess\";\nimport { JsonFileUpload } from \"../../components/json-file-upload/JsonFileUpload\";\nimport { KeycloakTextInput } from \"../../components/keycloak-text-input/KeycloakTextInput\";\nimport { ViewHeader } from \"../../components/view-header/ViewHeader\";\nimport { useRealms } from \"../../context/RealmsContext\";\nimport { useWhoAmI } from \"../../context/whoami/WhoAmI\";\nimport { toDashboard } from \"../../dashboard/routes/Dashboard\";\nimport { convertFormValuesToObject, convertToFormValues } from \"../../util\";\n\nexport default function NewRealmForm() {\n  const { t } = useTranslation();\n  const navigate = useNavigate();\n  const { refresh, whoAmI } = useWhoAmI();\n  const { refresh: refreshRealms } = useRealms();\n  const { addAlert, addError } = useAlerts();\n  const [realm, setRealm] = useState<RealmRepresentation>();\n\n  const {\n    register,\n    handleSubmit,\n    control,\n    setValue,\n    formState: { errors },\n  } = useForm<RealmRepresentation>({ mode: \"onChange\" });\n\n  const handleFileChange = (obj?: object) => {\n    const defaultRealm = { id: \"\", realm: \"\", enabled: true };\n    convertToFormValues(obj || defaultRealm, setValue);\n    setRealm(obj || defaultRealm);\n  };\n\n  const save = async (fields: RealmRepresentation) => {\n    try {\n      await adminClient.realms.create({\n        ...realm,\n        ...convertFormValuesToObject(fields),\n      });\n      addAlert(t(\"saveRealmSuccess\"));\n\n      refresh();\n      await refreshRealms();\n      navigate(toDashboard({ realm: fields.realm }));\n    } catch (error) {\n      addError(\"saveRealmError\", error);\n    }\n  };\n\n  return (\n    <>\n      <ViewHeader titleKey=\"createRealm\" subKey=\"realmExplain\" />\n      <PageSection variant=\"light\">\n        <FormAccess\n          isHorizontal\n          onSubmit={handleSubmit(save)}\n          role=\"view-realm\"\n          isReadOnly={!whoAmI.canCreateRealm()}\n        >\n          <JsonFileUpload\n            id=\"kc-realm-filename\"\n            allowEditingUploadedText\n            onChange={handleFileChange}\n          />\n          <FormGroup\n            label={t(\"realmNameField\")}\n            isRequired\n            fieldId=\"kc-realm-name\"\n            validated={errors.realm ? \"error\" : \"default\"}\n            helperTextInvalid={errors.realm?.message}\n          >\n            <KeycloakTextInput\n              isRequired\n              id=\"kc-realm-name\"\n              validated={errors.realm ? \"error\" : \"default\"}\n              {...register(\"realm\", {\n                required: { value: true, message: t(\"required\") },\n              })}\n            />\n          </FormGroup>\n          <FormGroup label={t(\"enabled\")} fieldId=\"kc-realm-enabled-switch\">\n            <Controller\n              name=\"enabled\"\n              defaultValue={true}\n              control={control}\n              render={({ field }) => (\n                <Switch\n                  id=\"kc-realm-enabled-switch\"\n                  name=\"enabled\"\n                  label={t(\"on\")}\n                  labelOff={t(\"off\")}\n                  isChecked={field.value}\n                  onChange={field.onChange}\n                  aria-label={t(\"enabled\")}\n                />\n              )}\n            />\n          </FormGroup>\n          <ActionGroup>\n            <Button variant=\"primary\" type=\"submit\">\n              {t(\"create\")}\n            </Button>\n            <Button variant=\"link\" onClick={() => navigate(-1)}>\n              {t(\"cancel\")}\n            </Button>\n          </ActionGroup>\n        </FormAccess>\n      </PageSection>\n    </>\n  );\n}\n"],"names":["NewRealmForm","t","useTranslation","navigate","useNavigate","refresh","whoAmI","useWhoAmI","refreshRealms","useRealms","addAlert","addError","useAlerts","realm","setRealm","useState","register","handleSubmit","control","setValue","errors","useForm","handleFileChange","obj","defaultRealm","convertToFormValues","jsxs","Fragment","jsx","ViewHeader","PageSection","FormAccess","fields","adminClient","convertFormValuesToObject","toDashboard","error","JsonFileUpload","FormGroup","KeycloakTextInput","Controller","field","Switch","ActionGroup","Button"],"mappings":"iwBAwBA,SAAwBA,IAAe,CAC/B,KAAA,CAAE,EAAAC,GAAMC,IACRC,EAAWC,IACX,CAAE,QAAAC,EAAS,OAAAC,CAAO,EAAIC,EAAU,EAChC,CAAE,QAASC,CAAc,EAAIC,EAAU,EACvC,CAAE,SAAAC,EAAU,SAAAC,CAAS,EAAIC,EAAU,EACnC,CAACC,EAAOC,CAAQ,EAAIC,EAA8B,EAElD,CACJ,SAAAC,EACA,aAAAC,EACA,QAAAC,EACA,SAAAC,EACA,UAAW,CAAE,OAAAC,CAAO,CAClB,EAAAC,EAA6B,CAAE,KAAM,UAAY,CAAA,EAE/CC,EAAoBC,GAAiB,CACzC,MAAMC,EAAe,CAAE,GAAI,GAAI,MAAO,GAAI,QAAS,IAC/BC,EAAAF,GAAOC,EAAcL,CAAQ,EACjDL,EAASS,GAAOC,CAAY,CAAA,EAmB9B,OAEIE,EAAAC,EAAA,CAAA,SAAA,CAAAC,EAACC,EAAW,CAAA,SAAS,cAAc,OAAO,eAAe,EACzDD,EAACE,EAAY,CAAA,QAAQ,QACnB,SAAAJ,EAACK,EAAA,CACC,aAAY,GACZ,SAAUd,EAtBL,MAAOe,GAAgC,CAC9C,GAAA,CACI,MAAAC,EAAY,OAAO,OAAO,CAC9B,GAAGpB,EACH,GAAGqB,EAA0BF,CAAM,CAAA,CACpC,EACQtB,EAAAT,EAAE,kBAAkB,CAAC,EAEtBI,IACR,MAAMG,EAAc,EACpBL,EAASgC,EAAY,CAAE,MAAOH,EAAO,KAAO,CAAA,CAAC,QACtCI,EAAO,CACdzB,EAAS,iBAAkByB,CAAK,CAClC,CAAA,CASiC,EAC3B,KAAK,aACL,WAAY,CAAC9B,EAAO,eAAe,EAEnC,SAAA,CAAAsB,EAACS,EAAA,CACC,GAAG,oBACH,yBAAwB,GACxB,SAAUf,CAAA,CACZ,EACAM,EAACU,EAAA,CACC,MAAOrC,EAAE,gBAAgB,EACzB,WAAU,GACV,QAAQ,gBACR,UAAWmB,EAAO,MAAQ,QAAU,UACpC,kBAAmBA,EAAO,OAAO,QAEjC,SAAAQ,EAACW,EAAA,CACC,WAAU,GACV,GAAG,gBACH,UAAWnB,EAAO,MAAQ,QAAU,UACnC,GAAGJ,EAAS,QAAS,CACpB,SAAU,CAAE,MAAO,GAAM,QAASf,EAAE,UAAU,CAAE,CAAA,CACjD,CAAA,CACH,CAAA,CACF,IACCqC,EAAU,CAAA,MAAOrC,EAAE,SAAS,EAAG,QAAQ,0BACtC,SAAA2B,EAACY,EAAA,CACC,KAAK,UACL,aAAc,GACd,QAAAtB,EACA,OAAQ,CAAC,CAAE,MAAAuB,CAAA,IACTb,EAACc,EAAA,CACC,GAAG,0BACH,KAAK,UACL,MAAOzC,EAAE,IAAI,EACb,SAAUA,EAAE,KAAK,EACjB,UAAWwC,EAAM,MACjB,SAAUA,EAAM,SAChB,aAAYxC,EAAE,SAAS,CAAA,CACzB,CAAA,CAAA,EAGN,IACC0C,EACC,CAAA,SAAA,CAAAf,EAACgB,GAAO,QAAQ,UAAU,KAAK,SAC5B,SAAA3C,EAAE,QAAQ,EACb,EACA2B,EAACgB,EAAO,CAAA,QAAQ,OAAO,QAAS,IAAMzC,EAAS,EAAE,EAC9C,SAAEF,EAAA,QAAQ,CACb,CAAA,CAAA,EACF,CAAA,CAAA,CAAA,EAEJ,CACF,CAAA,CAAA,CAEJ"}