{"version":3,"file":"RoutableTabs-vx5wTdby.js","sources":["../../src/components/routable-tabs/RoutableTabs.tsx"],"sourcesContent":["import {\n  Tab,\n  TabProps,\n  Tabs,\n  TabsComponent,\n  TabsProps,\n} from \"@patternfly/react-core\";\nimport {\n  Children,\n  JSXElementConstructor,\n  PropsWithChildren,\n  ReactElement,\n  isValidElement,\n} from \"react\";\nimport {\n  Path,\n  generatePath,\n  matchPath,\n  useHref,\n  useLocation,\n  useParams,\n} from \"react-router-dom\";\nimport { useServerInfo } from \"../../context/server-info/ServerInfoProvider\";\nimport { PageHandler } from \"../../page/PageHandler\";\nimport { TAB_PROVIDER } from \"../../page/PageList\";\n\n// TODO: Remove the custom 'children' props and type once the following issue has been resolved:\n// https://github.com/patternfly/patternfly-react/issues/6766\ntype ChildElement = ReactElement<TabProps, JSXElementConstructor<TabProps>>;\ntype Child = ChildElement | boolean | null | undefined;\n\n// TODO: Figure out why we need to omit 'ref' from the props.\ntype RoutableTabsProps = {\n  children: Child | Child[];\n  defaultLocation?: Partial<Path>;\n} & Omit<\n  TabsProps,\n  \"ref\" | \"activeKey\" | \"defaultActiveKey\" | \"component\" | \"children\"\n>;\n\nexport const RoutableTabs = ({\n  children,\n  defaultLocation,\n  ...otherProps\n}: RoutableTabsProps) => {\n  const { pathname } = useLocation();\n  const params = useParams();\n  const { componentTypes } = useServerInfo();\n  const tabs = componentTypes?.[TAB_PROVIDER] || [];\n\n  const matchedTabs = tabs\n    .filter((tab) => matchPath({ path: tab.metadata.path }, pathname))\n    .map((t) => ({\n      ...t,\n      pathname: generatePath(t.metadata.path, {\n        ...params,\n        ...t.metadata.params,\n      }),\n    }));\n  // Extract all keys from matchedTabs\n  const matchedTabsKeys = matchedTabs.map((t) => t.pathname);\n\n  // Extract event keys from children\n  const eventKeys = Children.toArray(children)\n    .filter((child): child is ChildElement => isValidElement(child))\n    .map((child) => child.props.eventKey.toString());\n\n  const allKeys = [...eventKeys, ...matchedTabsKeys];\n\n  // Determine if there is an exact match.\n  const exactMatch = allKeys.find(\n    (eventKey) => eventKey === decodeURI(pathname),\n  );\n\n  // Determine which event keys at least partially match the current path, then sort them so the nearest match ends up on top.\n  const nearestMatch = eventKeys\n    .filter((eventKey) => pathname.includes(eventKey))\n    .sort((a, b) => a.length - b.length)\n    .pop();\n\n  return (\n    <Tabs\n      activeKey={\n        exactMatch ?? nearestMatch ?? defaultLocation?.pathname ?? pathname\n      }\n      component={TabsComponent.nav}\n      inset={{\n        default: \"insetNone\",\n        xl: \"insetLg\",\n        \"2xl\": \"inset2xl\",\n      }}\n      {...otherProps}\n    >\n      {children}\n      {matchedTabs.map((t) => (\n        <DynamicTab key={t.id} eventKey={t.pathname} title={t.id}>\n          <PageHandler page={t} providerType={TAB_PROVIDER} />\n        </DynamicTab>\n      ))}\n    </Tabs>\n  );\n};\n\ntype DynamicTabProps = {\n  title: string;\n  eventKey: string;\n};\n\nconst DynamicTab = ({\n  children,\n  ...props\n}: PropsWithChildren<DynamicTabProps>) => {\n  const href = useHref(props.eventKey);\n\n  return (\n    <Tab href={href} {...props}>\n      {children}\n    </Tab>\n  );\n};\n\nexport const useRoutableTab = (to: Partial<Path>) => ({\n  eventKey: to.pathname ?? \"\",\n  href: useHref(to),\n});\n"],"names":["RoutableTabs","children","defaultLocation","otherProps","pathname","useLocation","params","useParams","componentTypes","useServerInfo","matchedTabs","TAB_PROVIDER","tab","matchPath","t","generatePath","matchedTabsKeys","eventKeys","Children","child","isValidElement","exactMatch","eventKey","nearestMatch","jsxs","Tabs","TabsComponent","DynamicTab","jsx","PageHandler","props","href","useHref","Tab","useRoutableTab","to"],"mappings":"+UAwCO,MAAMA,EAAe,CAAC,CAC3B,SAAAC,EACA,gBAAAC,EACA,GAAGC,CACL,IAAyB,CACjB,KAAA,CAAE,SAAAC,GAAaC,IACfC,EAASC,IACT,CAAE,eAAAC,GAAmBC,IAGrBC,GAFOF,IAAiBG,CAAY,GAAK,CAAA,GAG5C,OAAQC,GAAQC,EAAU,CAAE,KAAMD,EAAI,SAAS,MAAQR,CAAQ,CAAC,EAChE,IAAKU,IAAO,CACX,GAAGA,EACH,SAAUC,EAAaD,EAAE,SAAS,KAAM,CACtC,GAAGR,EACH,GAAGQ,EAAE,SAAS,MAAA,CACf,CACD,EAAA,EAEEE,EAAkBN,EAAY,IAAKI,GAAMA,EAAE,QAAQ,EAGnDG,EAAYC,EAAS,QAAQjB,CAAQ,EACxC,OAAQkB,GAAiCC,EAAeD,CAAK,CAAC,EAC9D,IAAKA,GAAUA,EAAM,MAAM,SAAS,UAAU,EAK3CE,EAHU,CAAC,GAAGJ,EAAW,GAAGD,CAAe,EAGtB,KACxBM,GAAaA,IAAa,UAAUlB,CAAQ,CAAA,EAIzCmB,EAAeN,EAClB,OAAQK,GAAalB,EAAS,SAASkB,CAAQ,CAAC,EAChD,KAAK,CAAC,EAAG,IAAM,EAAE,OAAS,EAAE,MAAM,EAClC,MAGD,OAAAE,EAACC,EAAA,CACC,UACEJ,GAAcE,GAAgBrB,GAAiB,UAAYE,EAE7D,UAAWsB,EAAc,IACzB,MAAO,CACL,QAAS,YACT,GAAI,UACJ,MAAO,UACT,EACC,GAAGvB,EAEH,SAAA,CAAAF,EACAS,EAAY,IAAKI,KACfa,EAAsB,CAAA,SAAUb,EAAE,SAAU,MAAOA,EAAE,GACpD,SAAAc,EAACC,GAAY,KAAMf,EAAG,aAAcH,EAAc,CAAA,EADnCG,EAAE,EAEnB,CACD,CAAA,CAAA,CAAA,CAGP,EAOMa,EAAa,CAAC,CAClB,SAAA1B,EACA,GAAG6B,CACL,IAA0C,CAClC,MAAAC,EAAOC,EAAQF,EAAM,QAAQ,EAEnC,OACGF,EAAAK,EAAA,CAAI,KAAAF,EAAa,GAAGD,EAClB,SAAA7B,CACH,CAAA,CAEJ,EAEaiC,EAAkBC,IAAuB,CACpD,SAAUA,EAAG,UAAY,GACzB,KAAMH,EAAQG,CAAE,CAClB"}