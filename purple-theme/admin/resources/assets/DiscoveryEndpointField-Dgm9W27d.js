import{jsxs as k,Fragment as F,jsx as t}from"react/jsx-runtime";import{useState as c,useEffect as w}from"react";import{u as T,Z as U,f as C,a0 as v,a1 as m,V as H,bl as j}from"./index-C9t2UlUN.js";import{K as q}from"./KeycloakTextInput-DrlF32nr.js";const L=({id:o,fileUpload:E,children:d})=>{const{t:e}=T(),{setValue:f,register:h,setError:D,watch:b,clearErrors:a,formState:{errors:s}}=U(),l=b("discoveryEndpoint"),[i,g]=c(!0),[p,n]=c(!1),[y,I]=c(),x=r=>{Object.keys(r).map(u=>f(`config.${u}`,r[u]))};return w(()=>{if(!l){n(!1);return}(async()=>{a("discoveryError");try{const r=await C.identityProviders.importFromUrl({providerId:o,fromUrl:l});x(r),I(r)}catch(r){D("discoveryError",{type:"manual",message:r.message})}n(!1)})()},[p]),k(F,{children:[t(v,{label:e(o==="oidc"?"useDiscoveryEndpoint":"useEntityDescriptor"),fieldId:"kc-discovery-endpoint",labelIcon:t(m,{helpText:e(o==="oidc"?"useDiscoveryEndpointHelp":"useEntityDescriptorHelp"),fieldLabelId:"discoveryEndpoint"}),children:t(H,{id:"kc-discovery-endpoint-switch",label:e("on"),labelOff:e("off"),isChecked:i,onChange:r=>{a("discoveryError"),g(r)},"aria-label":e(o==="oidc"?"useDiscoveryEndpoint":"useEntityDescriptor")})}),i&&t(v,{label:e(o==="oidc"?"discoveryEndpoint":"samlEntityDescriptor"),fieldId:"kc-discovery-endpoint",labelIcon:t(m,{helpText:e(o==="oidc"?"discoveryEndpointHelp":"samlEntityDescriptorHelp"),fieldLabelId:"discoveryEndpoint"}),validated:s.discoveryError||s.discoveryEndpoint?"error":y?"success":"default",helperTextInvalid:s.discoveryEndpoint?e("required"):e("noValidMetaDataFound",{error:s.discoveryError?.message}),isRequired:!0,children:t(q,{type:"url","data-testid":"discoveryEndpoint",id:"kc-discovery-endpoint",placeholder:o==="oidc"?"https://hostname/auth/realms/master/.well-known/openid-configuration":"",validated:s.discoveryError||s.discoveryEndpoint?"error":y?"success":"default",customIconUrl:p?j.resourceUrl+"/discovery-load-indicator.svg":"",...h("discoveryEndpoint",{required:!0,onBlur:()=>n(!0)})})}),!i&&E,i&&!s.discoveryError&&d(!0),!i&&d(!1)]})};export{L as D};
//# sourceMappingURL=DiscoveryEndpointField-Dgm9W27d.js.map
