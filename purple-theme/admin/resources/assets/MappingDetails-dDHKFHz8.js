import{jsxs as d,Fragment as O,jsx as p}from"react/jsx-runtime";import{useState as w}from"react";import{u as x,e as k,g as K,c as N,b as $,a as j,as as q,q as G,B as H,f as i,A as v,D as L,P as R,F as U,a0 as z,at as J,E as Q,h as F,L as W,au as X,ao as Y,av as Z,N as _,M as ee}from"./index-C9t2UlUN.js";import{u as oe}from"./ConfirmDialog-BDkqxnFL.js";import{D as te}from"./DynamicComponents-D5DD9CFr.js";import{F as ae}from"./FormAccess-DnQCcStE.js";import{V as re}from"./ViewHeader-cxZm8XhN.js";import{u as pe}from"./useParams-DL8-63Ov.js";import{A as ie}from"./Form-Cdw1qhWG.js";import"react-dom";import"./Modal-Bgkd26UL.js";import"./FileUpload-CTw4RKK1.js";import"./CodeEditor-Cp4g17EF.js";import"./copy-icon-CYSS18Ce.js";import"./EmptyStateBody-CyIhnUop.js";import"./EmptyStateSecondaryActions-BekVwNvY.js";import"./GroupPickerDialog-tI6XV7Ln.js";import"./PaginatingTableToolbar-oQUfBy2J.js";import"./ToolbarContent-D6TJq6fk.js";import"./useToggle-K3Kx99tM.js";import"./KeycloakTextInput-DrlF32nr.js";import"./DataListItemRow-Bimi62Tu.js";import"./grip-vertical-icon-B_ub3hpF.js";import"./_baseFlatten-BQ8y46Zj.js";import"./FlexItem-BEayPdRt.js";import"./KeySelect-CPI9XGq0.js";import"./MultiLineInput-DibC-IV_.js";import"./PasswordInput-CJKuHljf.js";import"./AddRoleMappingModal-BWNuJU0W.js";import"./KeycloakDataTable-2rLFZPhG.js";import"./filter-icon-C8nM2k1N.js";import"./KeycloakTextArea-DChmurIP.js";function je(){const{t:o}=x(),{addAlert:u,addError:f}=k(),{id:t,mapperId:a}=pe(),g=K(),{setValue:S,handleSubmit:D}=g,[m,b]=w(),[P,T]=w(),C=N(),{realm:y}=$(),M=j(),A=/^[{]?[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}[}]?$/,s=!!a.match(A),c=!!q(X.path),h=()=>c?Y({realm:y,id:t,tab:"mappers"}):Z({realm:y,clientId:t,tab:"mappers"});G(async()=>{let e;if(s){if(c?e=await i.clientScopes.findProtocolMapper({id:t,mapperId:a}):e=await i.clients.findProtocolMapperById({id:t,mapperId:a}),!e)throw new Error(o("notFound"));const r=M.protocolMapperTypes[e.protocol].find(l=>l.id===e.protocolMapper);return{config:{protocol:e.protocol,protocolMapper:e.protocolMapper},mapping:r,data:e}}else{const n=c?await i.clientScopes.findOne({id:t}):await i.clients.findOne({id:t});if(!n)throw new Error(o("notFound"));const l=M.protocolMapperTypes[n.protocol].find(B=>B.id===a);if(!l)throw new Error(o("notFound"));return{mapping:l,config:{protocol:n.protocol,protocolMapper:a}}}},({config:e,mapping:n,data:r})=>{T(e),b(n),r&&ee(r,S)},[]);const[V,E]=oe({titleKey:"deleteMappingTitle",messageKey:"deleteMappingConfirm",continueButtonLabel:"delete",continueButtonVariant:H.danger,onConfirm:async()=>{try{c?await i.clientScopes.delProtocolMapper({id:t,mapperId:a}):await i.clients.delProtocolMapper({id:t,mapperId:a}),u(o("mappingDeletedSuccess"),v.success),C(h())}catch(e){f("mappingDeletedError",e)}}}),I=async e=>{const n=s?"Updated":"Created";try{const r={...P,..._(e)};s?c?await i.clientScopes.updateProtocolMapper({id:t,mapperId:a},{id:a,...r}):await i.clients.updateProtocolMapper({id:t,mapperId:a},{id:a,...r}):c?await i.clientScopes.addProtocolMapper({id:t},r):await i.clients.addProtocolMapper({id:t},r),u(o(`mapping${n}Success`),v.success)}catch(r){f(`mapping${n}Error`,r)}};return d(O,{children:[p(E,{}),p(re,{titleKey:s?m?.name:o("addMapper"),subKey:s?a:"addMapperExplain",dropdownItems:s?[p(L,{value:"delete",onClick:V,children:o("delete")},"delete")]:void 0}),p(R,{variant:"light",children:p(U,{...g,children:d(ae,{isHorizontal:!0,onSubmit:D(I),role:"manage-clients",children:[p(z,{label:o("mapperType"),fieldId:"mapperType",children:p(J,{type:"text",id:"mapperType",name:"mapperType",readOnlyVariant:"default",value:m?.name})}),p(Q,{name:"name",label:o("name"),labelIcon:o("mapperNameHelp"),readOnlyVariant:s?"default":void 0,rules:{required:{value:!0,message:o("required")}}}),p(te,{properties:m?.properties||[],isNew:!s}),d(ie,{children:[p(F,{variant:"primary",type:"submit",children:o("save")}),p(F,{variant:"link",component:e=>p(W,{...e,to:h()}),children:o("cancel")})]})]})})})]})}export{je as default};
//# sourceMappingURL=MappingDetails-dDHKFHz8.js.map
