import{jsxs as k,Fragment as F,jsx as t}from"react/jsx-runtime";import{useState as s}from"react";import{b as E,u as N,e as V,p as G,B as J,f as p,A as v,ag as Q,P as X,h as Y,L as x,ap as Z,O as _,aq as $,D as ee,ar as O,ao as te,r as oe}from"./index-C9t2UlUN.js";import{g as ne}from"./utils-DeGqqWSp.js";import{A as u,r as re,a as ae,c as le,C as B}from"./ClientScopeTypes-43MQv2_N.js";import{u as ce}from"./ConfirmDialog-BDkqxnFL.js";import{a1 as se,a2 as R}from"./KeycloakDataTable-2rLFZPhG.js";import{V as ie}from"./ViewHeader-cxZm8XhN.js";import{S as pe,a as me,C as de,n as Se,t as ue,p as ye}from"./SearchFilter-BsIw65oH.js";import{b as w}from"./ToolbarContent-D6TJq6fk.js";import"react-dom";import"./Modal-Bgkd26UL.js";import"./PaginatingTableToolbar-oQUfBy2J.js";import"./EmptyStateBody-CyIhnUop.js";import"./EmptyStateSecondaryActions-BekVwNvY.js";import"./Form-Cdw1qhWG.js";import"./grip-vertical-icon-B_ub3hpF.js";import"./_baseFlatten-BQ8y46Zj.js";import"./filter-icon-C8nM2k1N.js";const he=n=>{const{t:o}=N(),{addAlert:i,addError:m}=V();return t(ae,{clientScope:n,type:n.type,all:!0,onSelect:async y=>{try{await le(n,y),i(o("clientScopeSuccess"),v.success),n.refresh()}catch(d){m("clientScopeError",d)}}})},fe=({id:n,name:o})=>{const{realm:i}=E();return t(x,{to:te({realm:i,id:n,tab:"settings"}),children:o},n)};function Ie(){const{realm:n}=E(),{t:o}=N(),{addAlert:i,addError:m}=V(),[y,d]=s(!1),[r,h]=s([]),[a,T]=s("name"),[D,f]=s(u.none),[K,g]=s("all"),I=G(),[A,j]=s(0),l=()=>{h([]),j(A+1)},U=async(e,L,c)=>{const S=await p.clientScopes.listDefaultClientScopes(),H=await p.clientScopes.listDefaultOptionalClientScopes(),M=await p.clientScopes.find(),W=a==="name"?Se(c):a==="type"?ue(D):ye(K),z=M.map(C=>({...C,type:S.find(b=>b.name===C.name)?B.default:H.find(b=>b.name===C.name)?B.optional:u.none})).filter(W);return I(z,oe("name")).slice(e,Number(e)+Number(L))},[P,q]=ce({titleKey:o("deleteClientScope",{count:r.length,name:r[0]?.name}),messageKey:"deleteConfirmClientScopes",continueButtonLabel:"delete",continueButtonVariant:J.danger,onConfirm:async()=>{const e=await p.clientScopes.find();if(Object.keys(e).length-r.length>0)try{for(const c of r){try{await re(c)}catch(S){console.warn("could not remove scope",S.response?.data?.errorMessage||S)}await p.clientScopes.del({id:c.id})}i(o("deletedSuccessClientScope"),v.success),l()}catch(c){m("deleteErrorClientScope",c)}else m(o("notAllowedToDeleteAllClientScopes"),"error")}});return k(F,{children:[t(q,{}),t(ie,{titleKey:"clientScopes",subKey:"clientScopeExplain",helpUrl:Q.clientScopesUrl}),t(X,{variant:"light",className:"pf-u-p-0",children:t(se,{loader:U,ariaLabelKey:"clientScopeList",searchPlaceholderKey:a==="name"?"searchForClientScope":void 0,isSearching:a!=="name",searchTypeComponent:t(pe,{searchType:a,onSelect:e=>T(e),withProtocol:!0}),isPaginated:!0,onSelect:e=>h([...e]),canSelectAll:!0,toolbarItem:k(F,{children:[t(me,{searchType:a,type:D,onSelect:e=>{T(e),g("all"),f(u.none),l()},onType:e=>{f(e),g("all"),l()},protocol:K,onProtocol:e=>{g(e),f(u.none),l()}}),t(w,{children:t(Y,{component:e=>t(x,{...e,to:Z({realm:n})}),children:o("createClientScope")})}),t(w,{children:t(de,{selectedRows:r,refresh:l})}),t(w,{children:t(_,{toggle:t($,{onToggle:d}),isOpen:y,isPlain:!0,dropdownItems:[t(ee,{component:"button",isDisabled:r.length===0,onClick:()=>{P(),d(!1)},children:o("delete")},"action")]})})]}),actions:[{title:o("delete"),onRowClick:e=>{h([e]),P()}}],columns:[{name:"name",cellRenderer:fe},{name:"type",displayKey:"assignedType",cellRenderer:e=>t(he,{...e,refresh:l})},{name:"protocol",displayKey:"protocol",cellRenderer:e=>ne(o,e.protocol??"openid-connect"),transforms:[R(15)]},{name:"attributes['gui.order']",displayKey:"displayOrder",cellFormatters:[O()],transforms:[R(15)]},{name:"description",cellFormatters:[O()]}]},A)})]})}export{Ie as default};
//# sourceMappingURL=ClientScopesSection-B6LNZrB1.js.map
