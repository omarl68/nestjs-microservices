import{jsxs as s,Fragment as w,jsx as e}from"react/jsx-runtime";import{u as P,b as T,a4 as R,q as y,a0 as d,a1 as n,a3 as f,V as v,I as q,J as F,S as k,f as m,g as x,c as A,e as C,F as L,P as S,h as I,dJ as H,A as D}from"./index-C9t2UlUN.js";import{u as N}from"./useParams-DL8-63Ov.js";import{useState as O}from"react";import{F as V}from"./FormAccess-DnQCcStE.js";import{K as u}from"./KeycloakTextInput-DrlF32nr.js";import{W as E,H as K,S as M}from"./SettingsCache-VBvTpNnN.js";import{i as U}from"./isEqual-CVfl2lzU.js";import{F as $,A as W}from"./Form-Cdw1qhWG.js";import"react-dom";import"./copy-icon-CYSS18Ce.js";import"./ConfirmDialog-BDkqxnFL.js";import"./Modal-Bgkd26UL.js";import"./ViewHeader-cxZm8XhN.js";import"./ToolbarContent-D6TJq6fk.js";import"./useToggle-K3Kx99tM.js";const Y=({form:a,showSectionHeading:o=!1,showSectionDescription:c=!1})=>{const{t:r}=P(),{realm:l}=T(),[p,g]=O(!1),b=R({control:a.control,name:"config.allowPasswordAuthentication"});return y(()=>m.realms.findOne({realm:l}),t=>a.setValue("parentId",t.id),[]),s(w,{children:[o&&e(E,{title:r("requiredSettings"),description:r("kerberosRequiredSettingsDescription"),showDescription:c}),s(V,{role:"manage-realm",isHorizontal:!0,children:[s(d,{label:r("uiDisplayName"),labelIcon:e(n,{helpText:r("uiDisplayNameHelp"),fieldLabelId:"uiDisplayName"}),fieldId:"kc-ui-display-name",isRequired:!0,validated:a.formState.errors.name?"error":"default",helperTextInvalid:a.formState.errors.name?.message,children:[e(u,{hidden:!0,id:"kc-ui-providerId",defaultValue:"kerberos",...a.register("providerId")}),e(u,{hidden:!0,id:"kc-ui-providerType",defaultValue:"org.keycloak.storage.UserStorageProvider",...a.register("providerType")}),e(u,{hidden:!0,id:"kc-ui-parentId",defaultValue:l,...a.register("parentId")}),e(u,{isRequired:!0,id:"kc-ui-name","data-testid":"kerberos-name",validated:a.formState.errors.name?"error":"default","aria-label":r("uiDisplayName"),...a.register("name",{required:{value:!0,message:r("validateName")}})})]}),e(d,{label:r("kerberosRealm"),labelIcon:e(n,{helpText:r("kerberosRealmHelp"),fieldLabelId:"kc-kerberos-realm"}),fieldId:"kc-kerberos-realm",isRequired:!0,validated:a.formState.errors.config?.kerberosRealm?.[0]?"error":"default",helperTextInvalid:a.formState.errors.config?.kerberosRealm?.[0].message,children:e(u,{isRequired:!0,id:"kc-kerberos-realm","data-testid":"kerberos-realm",validated:a.formState.errors.config?.kerberosRealm?.[0]?"error":"default",...a.register("config.kerberosRealm.0",{required:{value:!0,message:r("validateRealm")}})})}),e(d,{label:r("serverPrincipal"),labelIcon:e(n,{helpText:r("serverPrincipalHelp"),fieldLabelId:"serverPrincipal"}),fieldId:"kc-server-principal",isRequired:!0,validated:a.formState.errors.config?.serverPrincipal?.[0]?"error":"default",helperTextInvalid:a.formState.errors.config?.serverPrincipal?.[0].message,children:e(u,{isRequired:!0,id:"kc-server-principal","data-testid":"kerberos-principal",validated:a.formState.errors.config?.serverPrincipal?.[0]?"error":"default",...a.register("config.serverPrincipal.0",{required:{value:!0,message:r("validateServerPrincipal")}})})}),e(d,{label:r("keyTab"),labelIcon:e(n,{helpText:r("keyTabHelp"),fieldLabelId:"keyTab"}),fieldId:"kc-key-tab",isRequired:!0,validated:a.formState.errors.config?.keyTab?.[0]?"error":"default",helperTextInvalid:a.formState.errors.config?.keyTab?.[0].message,children:e(u,{isRequired:!0,id:"kc-key-tab","data-testid":"kerberos-keytab",validated:a.formState.errors.config?.keyTab?.[0]?"error":"default",...a.register("config.keyTab.0",{required:{value:!0,message:r("validateKeyTab")}})})}),s(d,{label:r("debug"),labelIcon:e(n,{helpText:r("debugHelp"),fieldLabelId:"debug"}),fieldId:"kc-debug",hasNoPaddingTop:!0,children:[" ",e(f,{name:"config.debug",defaultValue:["false"],control:a.control,render:({field:t})=>e(v,{id:"kc-debug","data-testid":"debug",onChange:i=>t.onChange([`${i}`]),isChecked:t.value?.[0]==="true",label:r("on"),labelOff:r("off"),"aria-label":r("debug")})})]}),e(d,{label:r("allowPasswordAuthentication"),labelIcon:e(n,{helpText:r("allowPasswordAuthenticationHelp"),fieldLabelId:"allowPasswordAuthentication"}),fieldId:"kc-allow-password-authentication",hasNoPaddingTop:!0,children:e(f,{name:"config.allowPasswordAuthentication",defaultValue:["false"],control:a.control,render:({field:t})=>e(v,{id:"kc-allow-password-authentication","data-testid":"allow-password-authentication",onChange:i=>t.onChange([`${i}`]),isChecked:t.value?.[0]==="true",label:r("on"),labelOff:r("off"),"aria-label":r("allowPasswordAuthentication")})})}),U(b,["true"])?s(d,{label:r("editMode"),labelIcon:e(n,{helpText:r("editModeKerberosHelp"),fieldLabelId:"editMode"}),isRequired:!0,fieldId:"kc-edit-mode",children:[" ",e(f,{name:"config.editMode[0]",defaultValue:"READ_ONLY",control:a.control,rules:{required:!0},render:({field:t})=>s(q,{toggleId:"kc-edit-mode",required:!0,onToggle:()=>g(!p),isOpen:p,onSelect:(i,h)=>{t.onChange(h),g(!1)},selections:t.value,variant:F.single,children:[e(k,{value:"READ_ONLY",isPlaceholder:!0},0),e(k,{value:"UNSYNCED"},1)]})})]}):null,e(d,{label:r("updateFirstLogin"),labelIcon:e(n,{helpText:r("updateFirstLoginHelp"),fieldLabelId:"updateFirstLogin"}),fieldId:"kc-update-first-login",hasNoPaddingTop:!0,children:e(f,{name:"config.updateProfileFirstLogin",defaultValue:["false"],control:a.control,render:({field:t})=>e(v,{id:"kc-update-first-login","data-testid":"update-first-login",onChange:i=>t.onChange([`${i}`]),isChecked:t.value?.[0]==="true",label:r("on"),labelOff:r("off"),"aria-label":r("updateFirstLogin")})})})]})]})};function se(){const{t:a}=P(),o=x({mode:"onChange"}),c=A(),{realm:r}=T(),{id:l}=N(),{addAlert:p,addError:g}=C();y(async()=>{if(l)return m.components.findOne({id:l})},i=>{if(i)b(i);else if(l)throw new Error(a("notFound"))},[]);const b=i=>{o.reset({...i})},t=async i=>{try{l?await m.components.update({id:l},i):(await m.components.create(i),c(`/${r}/user-federation`)),b(i),p(a(l?"userProviderSaveSuccess":"createUserProviderSuccess"),D.success)}catch(h){g(`${l?"userProviderSaveError":"createUserProviderError"}`,h)}};return s(w,{children:[e(L,{...o,children:e(K,{provider:"Kerberos",save:()=>o.handleSubmit(t)()})}),e(S,{variant:"light",children:e(Y,{form:o,showSectionHeading:!0})}),s(S,{variant:"light",isFilled:!0,children:[e(M,{form:o,showSectionHeading:!0}),e($,{onSubmit:o.handleSubmit(t),children:s(W,{children:[e(I,{isDisabled:!o.formState.isDirty,variant:"primary",type:"submit","data-testid":"kerberos-save",children:a("save")}),e(I,{variant:"link",onClick:()=>c(H({realm:r})),"data-testid":"kerberos-cancel",children:a("cancel")})]})})]})]})}export{se as default};
//# sourceMappingURL=UserFederationKerberosSettings-C5aU0yy7.js.map
