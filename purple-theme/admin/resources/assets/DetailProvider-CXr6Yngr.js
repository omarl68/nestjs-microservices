import{jsx as e,jsxs as c,Fragment as O}from"react/jsx-runtime";import{useState as b}from"react";import{u as q,c as E,g as H,b as L,e as j,q as G,a4 as N,B as U,f as s,aG as I,U as $,D as z,P as W,a0 as C,a2 as m,a1 as J,F as M,h as D,L as Q,aH as X}from"./index-C9t2UlUN.js";import{u as Y}from"./ConfirmDialog-BDkqxnFL.js";import{D as Z}from"./DynamicComponents-D5DD9CFr.js";import{F as _}from"./FormAccess-DnQCcStE.js";import{K as k}from"./KeycloakTextInput-DrlF32nr.js";import{V as ee}from"./ViewHeader-cxZm8XhN.js";import{u as re}from"./useParams-DL8-63Ov.js";import{A as te}from"./Form-Cdw1qhWG.js";import"react-dom";import"./Modal-Bgkd26UL.js";import"./FileUpload-CTw4RKK1.js";import"./CodeEditor-Cp4g17EF.js";import"./copy-icon-CYSS18Ce.js";import"./EmptyStateBody-CyIhnUop.js";import"./EmptyStateSecondaryActions-BekVwNvY.js";import"./GroupPickerDialog-tI6XV7Ln.js";import"./PaginatingTableToolbar-oQUfBy2J.js";import"./ToolbarContent-D6TJq6fk.js";import"./useToggle-K3Kx99tM.js";import"./DataListItemRow-Bimi62Tu.js";import"./grip-vertical-icon-B_ub3hpF.js";import"./_baseFlatten-BQ8y46Zj.js";import"./FlexItem-BEayPdRt.js";import"./KeySelect-CPI9XGq0.js";import"./MultiLineInput-DibC-IV_.js";import"./PasswordInput-CJKuHljf.js";import"./AddRoleMappingModal-BWNuJU0W.js";import"./KeycloakDataTable-2rLFZPhG.js";import"./filter-icon-C8nM2k1N.js";import"./KeycloakTextArea-DChmurIP.js";function Oe(){const{t:r}=q(),{id:t,providerId:d,subTab:l}=re(),p=E(),u=H({defaultValues:{providerId:d}}),{register:f,control:R,handleSubmit:S,reset:F,formState:{errors:g}}=u,{realm:n}=L(),{addAlert:y,addError:v}=j(),[h,T]=b(),[w,A]=b("");G(async()=>await Promise.all([s.realms.getClientRegistrationPolicyProviders({realm:n}),s.realms.findOne({realm:n}),t?s.components.findOne({id:t}):Promise.resolve()]),([i,o,a])=>{T(i.find(B=>B.id===d)),A(o?.id||""),F(a||{providerId:d})},[]);const P=N({control:R,defaultValue:"",name:"name"}),K=async i=>{i.config&&Object.entries(i.config).forEach(([o,a])=>i.config[o]=Array.isArray(a)?a:[a]);try{const o={...i,subType:l,parentId:w,providerType:"org.keycloak.services.clientregistration.policy.ClientRegistrationPolicy",providerId:d};if(t)await s.components.update({id:t},o);else{const{id:a}=await s.components.create(o);p(X({id:a,realm:n,subTab:l,providerId:d}))}y(r(`provider${t?"Updated":"Create"}Success`))}catch(o){v(`provider${t?"Updated":"Create"}Error`,o)}},[V,x]=Y({titleKey:"clientRegisterPolicyDeleteConfirmTitle",messageKey:r("clientRegisterPolicyDeleteConfirm",{name:P}),continueButtonLabel:"delete",continueButtonVariant:U.danger,onConfirm:async()=>{try{await s.components.del({realm:n,id:t}),y(r("clientRegisterPolicyDeleteSuccess")),p(I({realm:n,subTab:l}))}catch(i){v("clientRegisterPolicyDeleteError",i)}}});return h?c(O,{children:[e(ee,{titleKey:t?P:"createPolicy",subKey:t,dropdownItems:t?[e(z,{"data-testid":"delete",onClick:V,children:r("delete")},"delete")]:void 0}),e(x,{}),e(W,{variant:"light",children:c(_,{role:"manage-clients",isHorizontal:!0,onSubmit:S(K),children:[e(C,{label:r("provider"),fieldId:"provider",children:e(k,{id:"providerId","data-testid":"providerId","aria-label":r("providerId"),...f("providerId"),readOnly:!0})}),e(C,{label:r("name"),fieldId:"kc-name",helperTextInvalid:r("required"),validated:g.name?m.error:m.default,labelIcon:e(J,{helpText:r("clientPolicyNameHelp"),fieldLabelId:"kc-name"}),isRequired:!0,children:e(k,{id:"kc-name","data-testid":"name",validated:g.name?m.error:m.default,...f("name",{required:!0})})}),e(M,{...u,children:e(Z,{properties:h.properties})}),c(te,{children:[e(D,{"data-testid":"save",type:"submit",children:r("save")}),e(D,{variant:"link",component:i=>e(Q,{...i,to:I({realm:n,subTab:l})}),children:r("cancel")})]})]})})]}):e($,{})}export{Oe as default};
//# sourceMappingURL=DetailProvider-CXr6Yngr.js.map
