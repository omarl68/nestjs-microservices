import{jsxs as v,Fragment as R,jsx as e}from"react/jsx-runtime";import{useState as p}from"react";import{c as U,u as A,e as k,p as w,d as E,q as K,B as I,f as u,A as x,h as V,L as B,r as j,g as N,b as q,U as z,F as H,P as F,e1 as T,e2 as P}from"./index-C9t2UlUN.js";import{R as O,u as G}from"./RoutableTabs-vx5wTdby.js";import{U as J,s as Q}from"./UserFederationLdapForm-CxQ1tgUN.js";import{u as W}from"./ConfirmDialog-BDkqxnFL.js";import{L as X}from"./PaginatingTableToolbar-oQUfBy2J.js";import{a1 as Y}from"./KeycloakDataTable-2rLFZPhG.js";import{b as Z}from"./ToolbarContent-D6TJq6fk.js";import{E as _}from"./ExtendedHeader-CL2wJ6yY.js";import{a as D,b as C}from"./Tabs-CjrDEqsl.js";import"react-dom";import"./PageHandler-TK8xnd8P.js";import"./DynamicComponents-D5DD9CFr.js";import"./FileUpload-CTw4RKK1.js";import"./CodeEditor-Cp4g17EF.js";import"./copy-icon-CYSS18Ce.js";import"./EmptyStateBody-CyIhnUop.js";import"./EmptyStateSecondaryActions-BekVwNvY.js";import"./GroupPickerDialog-tI6XV7Ln.js";import"./useToggle-K3Kx99tM.js";import"./KeycloakTextInput-DrlF32nr.js";import"./Modal-Bgkd26UL.js";import"./Form-Cdw1qhWG.js";import"./DataListItemRow-Bimi62Tu.js";import"./grip-vertical-icon-B_ub3hpF.js";import"./_baseFlatten-BQ8y46Zj.js";import"./FlexItem-BEayPdRt.js";import"./KeySelect-CPI9XGq0.js";import"./MultiLineInput-DibC-IV_.js";import"./PasswordInput-CJKuHljf.js";import"./AddRoleMappingModal-BWNuJU0W.js";import"./filter-icon-C8nM2k1N.js";import"./KeycloakTextArea-DChmurIP.js";import"./PageList-59HC89eh.js";import"./ViewHeader-cxZm8XhN.js";import"./FormAccess-DnQCcStE.js";import"./useIsFeatureEnabled-CkHhuO9z.js";import"./SettingsCache-VBvTpNnN.js";import"./isEqual-CVfl2lzU.js";import"./MenuList-Br-Zu33q.js";const $=({toDetail:i,...o})=>e(B,{to:i(o.id),children:o.name}),ee=({toCreate:i,toDetail:o})=>{const s=U(),{t:r}=A(),{addAlert:f,addError:g}=k(),[n,y]=p(0),h=()=>y(n+1),[b,S]=p([]),m=w(),{id:L}=E(),[d,c]=p();K(()=>u.components.find({parent:L,type:"org.keycloak.storage.ldap.mappers.LDAPStorageMapper"}),a=>{S(m(a.map(M=>({...M,name:M.name,type:M.providerId})),j("name")))},[n]);const[l,t]=W({titleKey:r("deleteMappingTitle",{mapperId:d?.id}),messageKey:"deleteMappingConfirm",continueButtonLabel:"delete",continueButtonVariant:I.danger,onConfirm:async()=>{try{await u.components.del({id:d.id}),h(),f(r("mappingDeletedSuccess"),x.success),c(void 0)}catch(a){g("mappingDeletedError",a)}}});return v(R,{children:[e(t,{}),e(Y,{loader:b,ariaLabelKey:"ldapMappersList",searchPlaceholderKey:"searchForMapper",toolbarItem:e(Z,{children:e(V,{"data-testid":"add-mapper-btn",variant:"primary",component:a=>e(B,{...a,to:i}),children:r("addMapper")})}),actions:[{title:r("delete"),onRowClick:a=>{c(a),l()}}],columns:[{name:"name",cellRenderer:a=>e($,{...a,toDetail:o})},{name:"type"}],emptyState:e(X,{message:r("emptyMappers"),instructions:r("emptyMappersInstructions"),primaryActionText:r("emptyPrimaryAction"),onPrimaryAction:()=>s(i)})},n)]})};function ze(){const{t:i}=A(),o=N({mode:"onChange"}),{realm:s}=q(),{id:r}=E(),{addAlert:f,addError:g}=k(),[n,y]=p(),[h,b]=p(0),S=()=>b(t=>t+1);K(()=>u.components.findOne({id:r}),t=>{if(!t)throw new Error(i("notFound"));y(t),c(t)},[r,h]);const m=t=>G(T({realm:s,id:r,tab:t})),L=m("settings"),d=m("mappers"),c=t=>{o.reset(t),o.setValue("config.periodicChangedUsersSync",t.config?.changedSyncPeriod?.[0]!=="-1"),o.setValue("config.periodicFullSync",t.config?.fullSyncPeriod?.[0]!=="-1")},l=async t=>{try{await u.components.update({id:r},Q(t)),f(i("userProviderSaveSuccess"),x.success),S()}catch(a){g("userProviderSaveError",a)}};return n?v(H,{...o,children:[e(_,{provider:"LDAP",noDivider:!0,editMode:n.config?.editMode,save:()=>o.handleSubmit(l)()}),e(F,{variant:"light",className:"pf-u-p-0",children:v(O,{defaultLocation:T({realm:s,id:r,tab:"settings"}),isBox:!0,children:[e(D,{id:"settings",title:e(C,{children:i("settings")}),...L,children:e(F,{variant:"light",children:e(J,{id:r,onSubmit:l})})}),e(D,{id:"mappers",title:e(C,{children:i("mappers")}),"data-testid":"ldap-mappers-tab",...d,children:e(ee,{toCreate:P({realm:s,id:r,mapperId:"new"}),toDetail:t=>P({realm:s,id:r,mapperId:t})})})]})})]}):e(z,{})}export{ze as default};
//# sourceMappingURL=UserFederationLdapSettings-CU-048gC.js.map
