import{jsxs as L,jsx as t,Fragment as j}from"react/jsx-runtime";import{useState as s,useMemo as b,useEffect as E}from"react";import{u as B,a as F,p as $,r as A,Y as G,G as k,H,h as P,B as N,O as Q,Q as W,aA as Y,D as w,L as q}from"./index-C9t2UlUN.js";import{L as v}from"./PaginatingTableToolbar-oQUfBy2J.js";import{a1 as O}from"./KeycloakDataTable-2rLFZPhG.js";import{M as z,a as J}from"./Modal-Bgkd26UL.js";import{e as U,D as x,a as K,c as R,d as T}from"./DataListItemRow-Bimi62Tu.js";const X=a=>{const{t:o}=B(),c=F(),f=a.protocol,n=c.protocolMapperTypes[f],m=c.builtinProtocolMappers[f],[g,d]=s([]),[h,u]=s([]),M=$(),p=b(()=>M(m,A("name")).map(e=>{const i=n.filter(l=>l.id===e.protocolMapper)[0];return{item:e,id:e.name,description:i.helpText}}),[m,n]),[y,S]=s(p);if(a.filter&&a.filter.length!==g.length){d(a.filter);const e=a.filter.map(i=>i.name);S([...p.filter(i=>!e.includes(i.item.name))])}const D=b(()=>M(n,A("name")),[n]),r=!!a.filter,I=[o("name"),o("description")];return L(z,{"aria-label":o(r?"addPredefinedMappers":"emptySecondaryAction"),variant:J.medium,header:L(G,{role:"dialog","aria-label":o(r?"addPredefinedMappers":"emptySecondaryAction"),children:[t(k,{component:H.h1,children:o(r?"addPredefinedMappers":"emptySecondaryAction")}),t(k,{children:o(r?"predefinedMappingDescription":"configureMappingDescription")})]}),isOpen:a.open,onClose:a.toggleDialog,actions:r?[t(P,{id:"modal-confirm","data-testid":"confirm",isDisabled:y.length===0||h.length===0,onClick:()=>{a.onConfirm(h.map(({item:e})=>e)),a.toggleDialog()},children:o("add")},"confirm"),t(P,{id:"modal-cancel","data-testid":"cancel",variant:N.link,onClick:()=>{a.toggleDialog()},children:o("cancel")},"cancel")]:[],children:[!r&&L(U,{onSelectDataListItem:e=>{const i=n.find(l=>l.id===e);a.onConfirm(i),a.toggleDialog()},"aria-label":o("addPredefinedMappers"),isCompact:!0,children:[t(x,{"aria-label":o("headerName"),id:"header",children:t(K,{children:t(R,{dataListCells:I.map(e=>t(T,{style:{fontWeight:700},children:e},e))})})}),D.map(e=>t(x,{"aria-label":e.name,id:e.id,children:t(K,{children:t(R,{dataListCells:[t(T,{children:e.name},`name-${e.id}`),t(T,{children:e.helpText},`helpText-${e.id}`)]})})},e.id))]}),r&&t(O,{loader:y,onSelect:u,canSelectAll:!0,ariaLabelKey:"addPredefinedMappers",searchPlaceholderKey:"searchForMapper",columns:[{name:"id",displayKey:"name"},{name:"description",displayKey:"description"}],emptyState:t(v,{message:o("emptyMappers"),instructions:o("emptyBuiltInMappersInstructions")})})]})},Z=({id:a,name:o,detailLink:c})=>t(q,{to:c(a),children:o}),ie=({model:a,onAdd:o,onDelete:c,detailLink:f})=>{const{t:n}=B(),[m,g]=s(!1),d=a.protocolMappers,h=F().protocolMapperTypes[a.protocol],[u,M]=s(0);E(()=>M(u+1),[d]);const[p,y]=s(!1),[S,D]=s(a.protocolMappers),r=e=>{D(e?d||[]:void 0),y(!p)},I=async()=>d?d.reduce((i,l)=>{const C=h.find(({id:V})=>V===l.protocolMapper);return C?i.concat({...l,category:C.category,type:C.name,priority:C.priority}):i},[]).sort((i,l)=>i.priority-l.priority):[];return L(j,{children:[t(X,{protocol:a.protocol,filter:S,onConfirm:o,open:p,toggleDialog:()=>y(!p)}),t(O,{loader:I,ariaLabelKey:"clientScopeList",searchPlaceholderKey:"searchForMapper",toolbarItem:t(Q,{onSelect:()=>g(!1),toggle:t(W,{isPrimary:!0,id:"mapperAction",onToggle:()=>g(!m),toggleIndicator:Y,children:n("addMapper")}),isOpen:m,dropdownItems:[t(w,{onClick:()=>r(!0),children:n("fromPredefinedMapper")},"predefined"),t(w,{onClick:()=>r(!1),children:n("byConfiguration")},"byConfiguration")]}),actions:[{title:n("delete"),onRowClick:c}],columns:[{name:"name",cellRenderer:e=>t(Z,{...e,detailLink:f})},{name:"category"},{name:"type"},{name:"priority"}],emptyState:t(v,{message:n("emptyMappers"),instructions:n("emptyMappersInstructions"),secondaryActions:[{text:n("emptyPrimaryAction"),onClick:()=>r(!0)},{text:n("emptySecondaryAction"),onClick:()=>r(!1)}]})},u)]})};export{ie as M};
//# sourceMappingURL=MapperList-Caj0zikG.js.map
