import{jsxs as p,jsx as e,Fragment as U}from"react/jsx-runtime";import*as L from"react";import{useState as m,useMemo as X}from"react";import{_ as T,k as K,dZ as N,m as ee,y as ae,b8 as re,O as te,aq as se,b9 as $,L as ne,z as oe,n as ie,u as j,e as z,h as M,f as v,B as _,Y as O,G as P,b as le,c as de,a as ce,q as me,D as x,d_ as A,aQ as S,A as pe,ag as ge,P as ue,H as B,a9 as he,aa as V,d$ as fe,e0 as Ce,e1 as De}from"./index-C9t2UlUN.js";import{u as ye}from"./ConfirmDialog-BDkqxnFL.js";import{G as E,C as ve}from"./ClickableCard-CwUELw3C.js";import{F as be,a as G}from"./FlexItem-BEayPdRt.js";import{V as ke}from"./ViewHeader-cxZm8XhN.js";import{s as we}from"./sortBy-CgAHVq9r.js";import{M as Fe,a as Ie}from"./Modal-Bgkd26UL.js";import{e as Se,D as Ne,a as Oe,b as Pe,c as Le,d as Te}from"./DataListItemRow-Bimi62Tu.js";import{D as Ue}from"./DataListControl-BRWG6uCI.js";import"react-dom";import"./ToolbarContent-D6TJq6fk.js";import"./_baseFlatten-BQ8y46Zj.js";import"./grip-vertical-icon-B_ub3hpF.js";const H=r=>{var{children:o=null,className:t="",hasNoOffset:l=!1}=r,s=T(r,["children","className","hasNoOffset"]);return L.createElement("div",Object.assign({className:K(N.cardActions,l&&N.modifiers.noOffset,t)},s),o)};H.displayName="CardActions";const R=r=>{var{children:o=null,className:t="",component:l="div"}=r,s=T(r,["children","className","component"]);const i=l;return L.createElement(i,Object.assign({className:K(N.cardFooter,t)},s),o)};R.displayName="CardFooter";const q=r=>{var{children:o=null,component:t="div"}=r,l=T(r,["children","component"]);const s=t;return L.createElement(s,Object.assign({},l),o)};q.displayName="GalleryItem";const Me={name:"DatabaseIcon",height:512,width:448,svgPath:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z",yOffset:0,xOffset:0},xe=ee(Me),Ae=({title:r,dropdownItems:o,labelText:t,labelColor:l,footerText:s,to:i})=>{const[g,u]=m(!1),c=()=>{u(!g)};return p(ae,{isSelectable:!0,children:[p(re,{children:[e(H,{children:o&&e(te,{"data-testid":`${r}-dropdown`,isPlain:!0,position:"right",toggle:e(se,{onToggle:c}),isOpen:g,dropdownItems:o})}),e($,{"data-testid":"keycloak-card-title",children:e(ne,{to:i,children:r})})]}),e(oe,{}),e(R,{children:p(be,{children:[e(G,{className:"keycloak--keycloak-card__footer",children:s&&s}),e(G,{children:t&&e(ie,{color:l||"gray",children:t})})]})})]})},Be=({components:r,onClose:o})=>{const{t}=j(),{addAlert:l,addError:s}=z(),[i,g]=m(""),[u,c]=m(""),[h,b]=m(r.map(n=>n.name)),D=n=>{g(n),c(t("onDragStart",{item:n}))},y=()=>{c(t("onDragMove",{item:i}))},k=()=>{c(t("onDragCancel"))},w=n=>{c(t("onDragFinish",{list:n})),b(n)};return p(Fe,{variant:Ie.small,title:t("managePriorityOrder"),isOpen:!0,onClose:o,actions:[e(M,{id:"modal-confirm",onClick:async()=>{const n=h.map((f,F)=>{const C=r.find(I=>I.name===f);return C.config.priority=[F.toString()],v.components.update({id:C.id},C)});try{await Promise.all(n),l(t("orderChangeSuccessUserFed"))}catch(f){s("orderChangeErrorUserFed",f)}o()},children:t("save")},"confirm"),e(M,{id:"modal-cancel",variant:_.link,onClick:o,children:t("cancel")},"cancel")],children:[e(O,{className:"pf-u-pb-lg",children:e(P,{children:t("managePriorityInfo")})}),e(Se,{"aria-label":t("manageOrderTableAria"),"data-testid":"manageOrderDataList",isCompact:!0,onDragFinish:w,onDragStart:D,onDragMove:y,onDragCancel:k,itemOrder:h,children:we(r,"config.priority","name").map(n=>e(Ne,{"aria-label":n.name,id:n.name,children:p(Oe,{children:[e(Ue,{children:e(Pe,{"aria-label":t("dragHelp")})}),e(Le,{dataListCells:[e(Te,{"data-testid":n.name,children:n.name},n.name)]})]})},n.name))}),e("div",{className:"pf-screen-reader","aria-live":"assertive",children:u})]})};function We(){const[r,o]=m(),{addAlert:t,addError:l}=z(),{t:s}=j(),{realm:i}=le(),[g,u]=m(0),c=()=>u(new Date().getTime()),h=de(),[b,D]=m(!1),y=ce().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[];me(async()=>{const d={parentId:(await v.realms.findOne({realm:i})).id,type:"org.keycloak.storage.UserStorageProvider"};return v.components.find(d)},a=>{o(a)},[g]);const k=X(()=>y.map(a=>e(x,{onClick:()=>h(A({realm:i,providerId:a.id})),children:a.id.toUpperCase()=="LDAP"?a.id.toUpperCase():S(a.id)},a.id)),[]),w={variant:"link",onClick:()=>D(!0),lowerButtonTitle:s("managePriorities")};let n;const[f,F]=m(""),[C,I]=ye({titleKey:s("userFedDeleteConfirmTitle"),messageKey:s("userFedDeleteConfirm"),continueButtonLabel:"delete",continueButtonVariant:_.danger,onConfirm:async()=>{try{await v.components.del({id:f}),c(),t(s("userFedDeletedSuccess"),pe.success)}catch(a){l("userFedDeleteError",a)}}}),Q=a=>{F(a),C()},Y=(a,d)=>{const J=`${a.name}`,W=`${d.name}`;return J<W?-1:1},Z=(a,d)=>{switch(a){case"ldap":return De({realm:i,id:d});case"kerberos":return Ce({realm:i,id:d});default:return fe({realm:i,providerId:a,id:d})}};return r&&(n=r.sort(Y).map((a,d)=>e(q,{className:"keycloak-admin--user-federation__gallery-item",children:e(Ae,{to:Z(a.providerId,a.id),dropdownItems:[e(x,{onClick:()=>{Q(a.id)},"data-testid":"card-delete",children:s("delete")},`${d}-cardDelete`)],title:a.name,footerText:S(a.providerId),labelText:a.config?.enabled?.[0]!=="false"?`${s("enabled")}`:`${s("disabled")}`,labelColor:a.config?.enabled?.[0]!=="false"?"blue":"gray"})},d))),p(U,{children:[e(I,{}),b&&r&&e(Be,{onClose:()=>D(!1),components:r.filter(a=>a.config?.enabled)}),e(ke,{titleKey:"userFederation",subKey:"userFederationExplain",helpUrl:ge.userFederationUrl,...r&&r.length>0?{lowerDropdownItems:k,lowerDropdownMenuTitle:"addNewProvider",lowerButton:w}:{}}),e(ue,{children:r&&r.length>0?e(E,{hasGutter:!0,children:n}):p(U,{children:[e(O,{children:e(P,{component:B.p,children:s("getStarted")})}),e(O,{children:e(P,{className:"pf-u-mt-lg",component:B.h2,children:s("providers")})}),e("hr",{className:"pf-u-mb-lg"}),e(E,{hasGutter:!0,children:y.map(a=>e(ve,{onClick:()=>h(A({realm:i,providerId:a.id})),"data-testid":`${a.id}-card`,children:e($,{children:p(he,{hasGutter:!0,children:[e(V,{children:e(xe,{size:"lg"})}),e(V,{isFilled:!0,children:s("addProvider",{provider:S(a.id),count:4})})]})})},a.id))})]})})]})}export{We as default};
//# sourceMappingURL=UserFederationSection-C0VLyWoI.js.map
