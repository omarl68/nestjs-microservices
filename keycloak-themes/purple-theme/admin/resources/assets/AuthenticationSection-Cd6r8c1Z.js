import{jsx as e,jsxs as y,Fragment as N}from"react/jsx-runtime";import{_ as qe,k as Ue,u as I,g as L,e as O,b as _,h as v,B as M,F as $,o as U,J as ee,f as g,A as E,c as Ke,j as we,q as le,U as oe,V as te,W as B,X as Pe,C as Be,Y as ve,G as ae,H as je,P as D,E as G,M as Ie,N as Se,Z as Te,a0 as x,a1 as H,a2 as F,a3 as Y,p as Ee,a4 as ze,R as ce,a5 as de,a6 as Ge,a7 as Ye,a8 as _e,a9 as We,aa as ue,ab as Xe,ac as Qe,a as Ce,ad as Je,ae as Ze,T as et,I as tt,S as at,af as it,ag as nt,i as me,L as Re,ah as lt,n as ot,ai as rt,aj as st,ak as ct,r as dt}from"./index-C9t2UlUN.js";import*as ut from"react";import{useEffect as K,useState as T,useMemo as ke}from"react";import{u as mt}from"./ConfirmDialog-BDkqxnFL.js";import{L as pt}from"./PaginatingTableToolbar-oQUfBy2J.js";import{R as ht,u as bt}from"./RoutableTabs-vx5wTdby.js";import{a1 as Fe}from"./KeycloakDataTable-2rLFZPhG.js";import{V as yt}from"./ViewHeader-cxZm8XhN.js";import{u as ie}from"./useToggle-K3Kx99tM.js";import{N as ft}from"./NameDescription-B30C9S9E.js";import{M as re,a as Ne}from"./Modal-Bgkd26UL.js";import{F as Oe,A as X}from"./Form-Cdw1qhWG.js";import{D as At}from"./DraggableTable-CIWrK8lS.js";import{f as gt}from"./AddRoleMappingModal-BWNuJU0W.js";import{F as Q}from"./FormAccess-DnQCcStE.js";import{T as wt}from"./TimeSelector-CWH4kuIN.js";import{K as Pt}from"./KeycloakTextInput-DrlF32nr.js";import{s as vt,E as It,a as St}from"./EmptyStateBody-CyIhnUop.js";import{T as Tt,a as Et,b as xe}from"./ToolbarContent-D6TJq6fk.js";import{E as _t}from"./EmptyStateSecondaryActions-BekVwNvY.js";import{M as pe}from"./MultiLineInput-DibC-IV_.js";import{Q as Ct}from"./question-circle-icon-B-vzDm0d.js";import{T as Rt,a as R,b as k}from"./Tabs-CjrDEqsl.js";import{T as kt}from"./Trans-DcN6j3pV.js";import{s as Ft}from"./sortBy-CgAHVq9r.js";const He=t=>{var{children:n,className:a=""}=t,i=qe(t,["children","className"]);return ut.createElement("div",Object.assign({className:Ue(vt.emptyStatePrimary,a)},i),n)};He.displayName="EmptyStatePrimary";const Nt=({flowAlias:t,onClose:n})=>{const{t:a}=I(),i=L(),{addAlert:o,addError:l}=O(),{realm:c}=_(),s=async({bindingType:p})=>{const w=await g.realms.findOne({realm:c});try{await g.realms.update({realm:c},{...w,[p]:t}),o(a("updateFlowSuccess"),E.success)}catch(r){l("updateFlowError",r)}n(!0)},m=Array.from(W.keys());return e(re,{title:a("bindFlow"),variant:"small",onClose:n,actions:[e(v,{"data-testid":"save",type:"submit",form:"bind-form",children:a("save")},"confirm"),e(v,{"data-testid":"cancel",variant:M.link,onClick:()=>n(),children:a("cancel")},"cancel")],isOpen:!0,children:e(Oe,{id:"bind-form",isHorizontal:!0,onSubmit:i.handleSubmit(s),children:e($,{...i,children:e(U,{id:"chooseBindingType",name:"bindingType",label:a("chooseBindingType"),options:m.filter(p=>p!=="dockerAuthenticationFlow").map(p=>({key:p,value:a(`flow.${W.get(p)}`)})),controller:{defaultValue:m[0]},variant:ee.single,menuAppendTo:"parent","aria-label":a("chooseBindingType")})})})})},Ot=({name:t,description:n,toggleDialog:a,onComplete:i})=>{const{t:o}=I(),l=L({mode:"onChange"}),{setValue:c,getValues:s,handleSubmit:m}=l,{addAlert:p,addError:w}=O(),r=Ke(),{realm:d}=_();K(()=>{c("alias",o("copyOf",{name:t})),c("description",n)},[t,n]);const h=async()=>{const A=s();try{await g.authenticationManagement.copyFlow({flow:t,newName:A.alias});const f=(await g.authenticationManagement.getFlows()).find(S=>S.alias===A.alias);A.description!==n&&(f.description=A.description,await g.authenticationManagement.updateFlow({flowId:f.id},f)),p(o("copyFlowSuccess"),E.success),r(we({realm:d,id:f.id,usedBy:"notInUse",builtIn:f.builtIn?"builtIn":void 0}))}catch(f){w("copyFlowError",f)}i()};return e(re,{title:o("duplicateFlow"),onClose:a,variant:Ne.small,actions:[e(v,{"data-testid":"confirm",type:"submit",form:"duplicate-flow-form",children:o("duplicate")},"confirm"),e(v,{"data-testid":"cancel",variant:M.link,onClick:a,children:o("cancel")},"cancel")],isOpen:!0,children:e($,{...l,children:e(Oe,{id:"duplicate-flow-form",onSubmit:m(h),isHorizontal:!0,children:e(ft,{})})})})},xt=()=>{const{t}=I(),{addAlert:n,addError:a}=O(),[i,o]=T(),[l,c]=T(0),s=()=>c(l+1);le(async()=>{const[r,d]=await Promise.all([g.authenticationManagement.getRequiredActions(),g.authenticationManagement.getUnregisteredRequiredActions()]);return[...r.map(h=>({name:h.name,enabled:h.enabled,defaultAction:h.defaultAction,data:h})),...d.map(h=>({name:h.name,enabled:!1,defaultAction:!1,data:h}))]},r=>o(r),[l]);const m=r=>!("alias"in r),p=async(r,d)=>{try{d in r?(r[d]=!r[d],await g.authenticationManagement.updateRequiredAction({alias:r.alias},r)):m(r)&&await g.authenticationManagement.registerRequiredAction({name:r.name,providerId:r.providerId}),s(),n(t("updatedRequiredActionSuccess"),E.success)}catch(h){a("updatedRequiredActionError",h)}},w=async(r,d)=>{try{const h=r.alias;for(let A=0;A<Math.abs(d);A++)d>0?await g.authenticationManagement.lowerRequiredActionPriority({alias:h}):await g.authenticationManagement.raiseRequiredActionPriority({alias:h});s(),n(t("updatedRequiredActionSuccess"),E.success)}catch(h){a("updatedRequiredActionError",h)}};return i?e(At,{keyField:"name",onDragFinish:async(r,d)=>{const h=i.map(b=>b.name),A=d.indexOf(r),f=h.indexOf(r),S=i[f].data;if(!S.alias)return;const u=A-f;w(S,u)},columns:[{name:"name",displayKey:"requiredActions"},{name:"enabled",displayKey:"enabled",cellRenderer:r=>e(te,{id:`enable-${B(r.name)}`,label:t("on"),labelOff:t("off"),isChecked:r.enabled,onChange:()=>{p(r.data,"enabled")},"aria-label":B(r.name)})},{name:"default",displayKey:"setAsDefaultAction",thTooltipText:"authDefaultActionTooltip",cellRenderer:r=>e(te,{id:`default-${B(r.name)}`,label:t("on"),isDisabled:!r.enabled,labelOff:r.enabled?t("off"):t("disabledOff"),isChecked:r.defaultAction,onChange:()=>{p(r.data,"defaultAction")},"aria-label":B(r.name)})}],data:i}):e(oe,{})},Ht="_label_1r9ky_1",ne={label:Ht},Z=({label:t})=>y(N,{children:[e(Be,{className:ne.label})," ",t]}),Mt=({id:t,isSpecificClient:n,onClose:a})=>{const{t:i}=I(),o=async(l,c,s)=>(await gt({id:t,type:n?"clients":"idp",first:l||0,max:c||10,search:s})).map(p=>({name:p}));return e(re,{header:y(ve,{children:[e(ae,{component:je.h1,children:i("flowUsedBy")}),e(ae,{children:i("flowUsedByDescription",{value:i(n?"clients":"identiyProviders")})})]}),variant:Ne.medium,isOpen:!0,onClose:a,actions:[e(v,{"data-testid":"cancel",id:"modal-cancel",onClick:a,children:i("close")},"cancel")],children:e(Fe,{loader:o,isPaginated:!0,ariaLabelKey:"usedBy",searchPlaceholderKey:"search",columns:[{name:"name"}]})})},Vt=({authType:{id:t,usedBy:n},realm:a})=>{const{t:i}=I(),[o,l]=ie(),c=Object.entries(a).find(s=>s[1]===n?.values[0])?.[0];return y(N,{children:[o&&e(Mt,{id:t,onClose:l,isSpecificClient:n?.type==="SPECIFIC_CLIENTS"}),(n?.type==="SPECIFIC_PROVIDERS"||n?.type==="SPECIFIC_CLIENTS")&&(n.values.length<=8?e(Pe,{"aria-label":i("usedBy"),bodyContent:y("div",{children:[i("appliedBy"+(n.type==="SPECIFIC_CLIENTS"?"Clients":"Providers"))," ",n.values.map((s,m)=>y(N,{children:[e("strong",{children:s}),m<n.values.length-1?", ":""]}))]},`usedBy-${t}-${n.values}`),children:e(v,{variant:"link",className:ne.label,children:e(Z,{label:i(`used.${n.type}`)})})},t):e(v,{variant:"link",className:ne.label,onClick:l,children:e(Z,{label:i(`used.${n.type}`)})})),n?.type==="DEFAULT"&&e(Z,{label:i(`flow.${W.get(c)}`)}),!n?.type&&i("used.notInUse")]})},Dt=["poll","ping"],j=10,z=600,he=0,be=600,Lt=({realm:t,realmUpdated:n})=>{const{t:a}=I(),i=L({mode:"onChange"}),{realm:o}=_(),{addAlert:l,addError:c}=O(),s=p=>Ie(p,i.setValue);K(()=>s(t),[]);const m=async p=>{try{await g.realms.update({realm:o},Se(p));const w=await g.realms.findOne({realm:o});n(w),s(w),l(a("updateCibaSuccess"),E.success)}catch(w){c("updateCibaError",w)}};return e(D,{variant:"light",children:y(Q,{role:"manage-realm",isHorizontal:!0,onSubmit:i.handleSubmit(m),children:[y($,{...i,children:[e(U,{name:"attributes.cibaBackchannelTokenDeliveryMode",label:a("cibaBackchannelTokenDeliveryMode"),labelIcon:a("cibaBackchannelTokenDeliveryModeHelp"),options:Dt.map(p=>({key:p,value:a(`cibaBackhannelTokenDeliveryModes.${p}`)})),controller:{defaultValue:""}}),e(G,{name:"attributes.cibaExpiresIn",type:"number",min:j,max:z,label:a("cibaExpiresIn"),labelIcon:a("cibaExpiresInHelp"),rules:{min:{value:j,message:a("greaterThan",{value:j})},max:{value:z,message:a("lessThan",{value:z})},required:{value:!0,message:a("required")}}}),e(G,{name:"attributes.cibaInterval",type:"number",min:j,max:z,label:a("cibaInterval"),labelIcon:a("cibaIntervalHelp"),rules:{min:{value:he,message:a("greaterThan",{value:he})},max:{value:be,message:a("lessThan",{value:be})},required:{value:!0,message:a("required")}}}),e(U,{name:"attributes.cibaAuthRequestedUserHint",label:a("cibaAuthRequestedUserHint"),labelIcon:a("cibaAuthRequestedUserHintHelp"),options:["login_hint","id_token_hint","login_hint_token"],controller:{defaultValue:""},isDisabled:!0})]}),y(X,{children:[e(v,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!i.formState.isValid||!i.formState.isDirty,children:a("save")}),e(v,{"data-testid":"reload",variant:M.link,onClick:()=>s({...t}),children:a("reload")})]})]})})},Me=({name:t,label:n,controller:a,labelIcon:i,...o})=>{const{control:l,formState:{errors:c}}=Te();return e(x,{isRequired:a.rules?.required===!0,label:n||t,fieldId:t,labelIcon:i?e(H,{helpText:i,fieldLabelId:t}):void 0,helperTextInvalid:c[t]?.message,validated:c[t]?F.error:F.default,children:e(Y,{...a,name:t,control:l,render:({field:s})=>e(wt,{...o,id:t,"data-testid":t,value:s.value,onChange:s.onChange,validated:c[t]?F.error:F.default})})})},V=["totp","hotp"],ye=["SHA1","SHA256","SHA512"],fe=[6,8],$t=({realm:t,realmUpdated:n})=>{const{t:a}=I(),i=L({mode:"onChange",defaultValues:t}),{control:o,reset:l,handleSubmit:c,formState:{isValid:s,isDirty:m}}=i,{realm:p}=_(),{addAlert:w,addError:r}=O(),d=Ee(),h=ze({name:"otpPolicyType",control:o,defaultValue:V[0]}),A=u=>l(u);K(()=>A(t),[]);const f=ke(()=>{const u=(t.otpSupportedApplications??[]).map(b=>a(`otpSupportedApplications.${b}`));return d(u,b=>b)},[t.otpSupportedApplications]);return e(D,{variant:"light",children:e(Q,{role:"manage-realm",isHorizontal:!0,onSubmit:c(async u=>{try{await g.realms.update({realm:p},u);const b=await g.realms.findOne({realm:p});n(b),A(b),w(a("updateOtpSuccess"),E.success)}catch(b){r("updateOtpError",b)}}),className:"keycloak__otp_policies_authentication__form",children:y($,{...i,children:[e(x,{label:a("otpType"),labelIcon:e(H,{helpText:a("otpTypeHelp"),fieldLabelId:"otpType"}),hasNoPaddingTop:!0,children:e(Y,{name:"otpPolicyType","data-testid":"otpPolicyType",defaultValue:V[0],control:o,render:({field:u})=>e(N,{children:V.map(b=>e(ce,{id:b,"data-testid":b,isChecked:u.value===b,name:"otpPolicyType",onChange:()=>u.onChange(b),label:a(`policyType.${b}`),className:"keycloak__otp_policies_authentication__policy-type"},b))})})}),e(U,{name:"otpPolicyAlgorithm",label:a("otpHashAlgorithm"),labelIcon:a("otpHashAlgorithmHelp"),options:ye.map(u=>({key:`Hmac${u}`,value:u})),controller:{defaultValue:`Hmac${ye[0]}`}}),e(x,{label:a("otpPolicyDigits"),labelIcon:e(H,{helpText:a("otpPolicyDigitsHelp"),fieldLabelId:"otpPolicyDigits"}),hasNoPaddingTop:!0,children:e(Y,{name:"otpPolicyDigits","data-testid":"otpPolicyDigits",defaultValue:fe[0],control:o,render:({field:u})=>e(N,{children:fe.map(b=>e(ce,{id:`digit-${b}`,"data-testid":`digit-${b}`,isChecked:u.value===b,name:"otpPolicyDigits",onChange:()=>u.onChange(b),label:b,className:"keycloak__otp_policies_authentication__number-of-digits"},b))})})}),e(de,{name:"otpPolicyLookAheadWindow",label:a("lookAround"),labelIcon:a("lookAroundHelp"),controller:{defaultValue:1,rules:{min:0}}}),h===V[0]&&e(Me,{name:"otpPolicyPeriod",label:a("otpPolicyPeriod"),labelIcon:a("otpPolicyPeriodHelp"),units:["second","minute"],controller:{defaultValue:30,rules:{min:1,max:{value:120,message:a("maxLength",{length:"2 "+a("minutes")})}}}}),h===V[1]&&e(de,{name:"otpPolicyInitialCounter",label:a("initialCounter"),labelIcon:a("initialCounterHelp"),controller:{defaultValue:30,rules:{min:1,max:120}}}),e(x,{label:a("supportedApplications"),labelIcon:e(H,{helpText:a("supportedApplicationsHelp"),fieldLabelId:"supportedApplications"}),children:e(Ge,{"data-testid":"supportedApplications",children:f.map(u=>e(Ye,{isReadOnly:!0,children:u},u))})}),h===V[0]&&e(_e,{name:"otpPolicyCodeReusable",label:a("otpPolicyCodeReusable"),labelIcon:a("otpPolicyCodeReusableHelp"),labelOn:a("on"),labelOff:a("off")}),y(X,{children:[e(v,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!s||!m,children:a("save")}),e(v,{"data-testid":"reload",variant:M.link,onClick:()=>l({...t}),children:a("reload")})]})]})})})},qt=({policy:{id:t,configType:n,defaultValue:a,displayName:i},onRemove:o})=>{const{t:l}=I(),{control:c,register:s,formState:{errors:m}}=Te();return e(x,{label:i,fieldId:t,isRequired:!0,helperTextInvalid:l("required"),validated:m[t]?F.error:F.default,labelIcon:e(H,{helpText:l(`passwordPoliciesHelp.${t}`),fieldLabelId:t}),children:y(We,{children:[y(ue,{isFilled:!0,children:[n&&n!=="int"&&e(Pt,{id:t,"data-testid":t,...s(t,{required:!0}),defaultValue:a,validated:m[t]?F.error:F.default}),n==="int"&&e(Y,{name:t,defaultValue:Number.parseInt(a||"0"),control:c,render:({field:p})=>{const r=h=>p.onChange(Math.max(h,0)),d=Number(p.value);return e(Xe,{id:t,value:d,min:0,onPlus:()=>r(d+1),onMinus:()=>r(d-1),onChange:h=>{const A=Number(h.currentTarget.value);r(isNaN(A)?0:A)},className:"keycloak__policies_authentication__number-field"})}}),!n&&e(te,{id:t,label:l("on"),labelOff:l("off"),isChecked:!0,isDisabled:!0,"aria-label":i})]}),e(ue,{children:e(v,{"data-testid":`remove-${t}`,variant:"link",className:"keycloak__policies_authentication__minus-icon",onClick:()=>o(t),"aria-label":l("remove"),children:e(Qe,{})})})]})})},Ve=" and ",Ut=(t,n)=>t.map(a=>`${a.id}(${n[a.id]})`).join(Ve),Kt=(t,n)=>t.split(Ve).map(Bt).reduce((a,{id:i,value:o})=>{const l=n.find(c=>c.id===i);return l?a.concat({...l,value:o}):a},[]);function Bt(t){const n=t.indexOf("(");if(n===-1)return{id:t.trim()};const a=t.substring(0,n).trim(),i=t.lastIndexOf(")");if(i===-1)return{id:a};const o=t.substring(n+1,i).trim();return{id:a,value:o}}const Ae=({onSelect:t,selectedPolicies:n})=>{const{t:a}=I(),{passwordPolicies:i}=Ce(),[o,l]=T(!1),c=ke(()=>i?.filter(s=>n.find(m=>m.id===s.id)===void 0),[n]);return e(tt,{width:300,onSelect:(s,m)=>{t(m),l(!1)},onToggle:s=>l(s),isOpen:o,selections:a("addPolicy"),isDisabled:c?.length===0,children:c?.map(s=>e(at,{value:s,children:s.displayName},s.id))})},jt=({realm:t,realmUpdated:n})=>{const{t:a}=I(),{passwordPolicies:i}=Ce(),{addAlert:o,addError:l}=O(),{realm:c}=_(),[s,m]=T([]),p=u=>{m([...s,u]),d(u.id,u.defaultValue,{shouldDirty:!0})},w=L({defaultValues:{}}),{handleSubmit:r,setValue:d,reset:h,formState:{isDirty:A}}=w,f=u=>{h();const b=Kt(u.passwordPolicy||"",i);b.forEach(C=>{d(C.id,C.value)}),m(b)};K(()=>f(t),[]);const S=async u=>{const b={...t,passwordPolicy:Ut(s,u)};try{await g.realms.update({realm:c},b),n(b),f(b),o(a("updatePasswordPolicySuccess"),E.success)}catch(C){l("updatePasswordPolicyError",C)}};return y(D,{variant:"light",className:"pf-u-p-0",children:[(s.length!==0||t.passwordPolicy)&&y(N,{children:[e(Tt,{children:e(Et,{children:e(xe,{children:e(Ae,{onSelect:p,selectedPolicies:s})})})}),e(Je,{}),e(D,{variant:"light",children:e($,{...w,children:y(Q,{className:"keycloak__policies_authentication__form",role:"manage-realm",isHorizontal:!0,onSubmit:r(S),children:[s.map((u,b)=>e(qt,{policy:u,onRemove:C=>{m(s.filter(J=>J.id!==C)),d(u.id,"",{shouldDirty:!0})}},`${u.id}-${b}`)),y(X,{children:[e(v,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!A,children:a("save")}),e(v,{"data-testid":"reload",variant:M.link,onClick:()=>f(t),children:a("reload")})]})]})})})]}),!s.length&&!t.passwordPolicy&&y(It,{"data-testid":"empty-state",variant:"large",children:[e(_t,{icon:Ze}),e(et,{headingLevel:"h1",size:"lg",children:a("noPasswordPolicies")}),e(St,{children:a("noPasswordPoliciesInstructions")}),e(He,{children:e(Ae,{onSelect:p,selectedPolicies:[]})})]})]})},zt=["ES256","ES384","ES512","RS256","RS384","RS512","Ed25519","RS1"],Gt=["not specified","none","indirect","direct"],Yt=["not specified","platform","cross-platform"],Wt=["not specified","Yes","No"],Xt=["not specified","required","preferred","discouraged"],q=({name:t,label:n,options:a,labelPrefix:i,isMultiSelect:o=!1})=>{const{t:l}=I();return e(U,{name:t,label:l(n),variant:o?ee.typeaheadMulti:ee.single,controller:{defaultValue:a[0]},options:a.map(c=>({key:c,value:i?l(`${i}.${c}`):c})),typeAheadAriaLabel:l(t)})},ge=({realm:t,realmUpdated:n,isPasswordLess:a=!1})=>{const{t:i}=I(),{addAlert:o,addError:l}=O(),{realm:c}=_(),{enabled:s}=it(),m=L({mode:"onChange"}),{setValue:p,handleSubmit:w,formState:{isDirty:r}}=m,d=a?"webAuthnPolicyPasswordless":"webAuthnPolicy",h=f=>Ie(f,p);K(()=>h(t),[]);const A=async f=>{const S=Se(f);try{await g.realms.update({realm:c},S),n(S),h(S),o(i("webAuthnUpdateSuccess"),E.success)}catch(u){l("webAuthnUpdateError",u)}};return y(D,{variant:"light",children:[s&&e(Pe,{bodyContent:i(`${d}FormHelp`),children:e(ve,{className:"keycloak__section_intro__help",children:y(ae,{children:[e(Ct,{})," ",i("webauthnIntro")]})})}),y(Q,{role:"manage-realm",isHorizontal:!0,onSubmit:w(A),className:"keycloak__webauthn_policies_authentication__form",children:[y($,{...m,children:[e(G,{name:`${d}RpEntityName`,label:i("webAuthnPolicyRpEntityName"),labelIcon:i("webAuthnPolicyRpEntityNameHelp"),rules:{required:{value:!0,message:i("required")}}}),e(q,{name:`${d}SignatureAlgorithms`,label:"webAuthnPolicySignatureAlgorithms",options:zt,isMultiSelect:!0}),e(G,{name:`${d}RpId`,label:i("webAuthnPolicyRpId"),labelIcon:i("webAuthnPolicyRpIdHelp")}),e(q,{name:`${d}AttestationConveyancePreference`,label:"webAuthnPolicyAttestationConveyancePreference",options:Gt,labelPrefix:"attestationPreference"}),e(q,{name:`${d}AuthenticatorAttachment`,label:"webAuthnPolicyAuthenticatorAttachment",options:Yt,labelPrefix:"authenticatorAttachment"}),e(q,{name:`${d}RequireResidentKey`,label:"webAuthnPolicyRequireResidentKey",options:Wt,labelPrefix:"residentKey"}),e(q,{name:`${d}UserVerificationRequirement`,label:"webAuthnPolicyUserVerificationRequirement",options:Xt,labelPrefix:"userVerify"}),e(Me,{name:`${d}CreateTimeout`,label:i("webAuthnPolicyCreateTimeout"),labelIcon:i("otpPolicyPeriodHelp"),units:["second","minute","hour"],controller:{defaultValue:0,rules:{min:0,max:{value:31536,message:i("webAuthnPolicyCreateTimeoutHint")}}}}),e(_e,{name:`${d}AvoidSameAuthenticatorRegister`,label:i("webAuthnPolicyAvoidSameAuthenticatorRegister"),labelIcon:i("webAuthnPolicyAvoidSameAuthenticatorRegisterHelp"),labelOn:i("on"),labelOff:i("off")}),e(x,{label:i("webAuthnPolicyAcceptableAaguids"),fieldId:"webAuthnPolicyAcceptableAaguids",labelIcon:e(H,{helpText:i("webAuthnPolicyAcceptableAaguidsHelp"),fieldLabelId:"webAuthnPolicyAcceptableAaguids"}),children:e(pe,{name:`${d}AcceptableAaguids`,"aria-label":i("webAuthnPolicyAcceptableAaguids"),addButtonLabel:"addAaguids"})}),e(x,{label:i("webAuthnPolicyExtraOrigins"),fieldId:"webAuthnPolicyExtraOrigins",labelIcon:e(H,{helpText:i("webAuthnPolicyExtraOriginsHelp"),fieldLabelId:"webAuthnPolicyExtraOrigins"}),children:e(pe,{name:`${d}ExtraOrigins`,"aria-label":i("webAuthnPolicyExtraOrigins"),addButtonLabel:"addOrigins"})})]}),y(X,{children:[e(v,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!r,children:i("save")}),e(v,{"data-testid":"reload",variant:M.link,onClick:()=>h(t),children:i("reload")})]})]})]})},Qt=()=>{const{t}=I(),[n,a]=T(1),{realm:i}=_(),[o,l]=T();return le(async()=>{const c=await g.realms.findOne({realm:i});if(!c)throw new Error(t("notFound"));return c},c=>{l(c)},[]),o?y(Rt,{activeKey:n,onSelect:(c,s)=>a(s),mountOnEnter:!0,unmountOnExit:!0,children:[e(R,{id:"passwordPolicy",eventKey:1,title:e(k,{children:t("passwordPolicy")}),children:e(jt,{realm:o,realmUpdated:l})}),e(R,{id:"otpPolicy",eventKey:2,title:e(k,{children:t("otpPolicy")}),children:e($t,{realm:o,realmUpdated:l})}),e(R,{id:"webauthnPolicy",eventKey:3,title:e(k,{children:t("webauthnPolicy")}),children:e(ge,{realm:o,realmUpdated:l})}),e(R,{id:"webauthnPasswordlessPolicy",eventKey:4,title:e(k,{children:t("webauthnPasswordlessPolicy")}),children:e(ge,{realm:o,realmUpdated:l,isPasswordLess:!0})}),e(R,{"data-testid":"tab-ciba-policy",eventKey:5,title:e(k,{children:t("cibaPolicy")}),children:e(Lt,{realm:o,realmUpdated:l})})]}):e(oe,{})},W=new Map([["browserFlow","browser"],["registrationFlow","registration"],["directGrantFlow","direct grant"],["resetCredentialsFlow","reset credentials"],["clientAuthenticationFlow","clients"],["dockerAuthenticationFlow","docker auth"],["firstBrokerLoginFlow","firstBrokerLogin"]]),Jt=({id:t,alias:n,usedBy:a,builtIn:i})=>{const{t:o}=I(),{realm:l}=_();return y(N,{children:[e(Re,{to:we({realm:l,id:t,usedBy:a?.type||"notInUse",builtIn:i?"builtIn":void 0}),children:n},`link-${t}`)," ",i&&e(ot,{children:o("buildIn")},`label-${t}`)]})};function Zt(){const{t}=I(),{realm:n}=_(),[a,i]=T(0),o=()=>{f(void 0),i(a+1)},{addAlert:l,addError:c}=O(),s=Ee(),[m,p]=T(),[w,r]=ie(),[d,h]=ie(),[A,f]=T();le(()=>g.realms.findOne({realm:n}),f,[a]);const S=async()=>{const se=await(await rt(`${ct(g.baseUrl)}admin/realms/${n}/ui-ext/authentication-management/flows`,{method:"GET",headers:st(await g.getAccessToken())})).json();return se?Ft(s(se,dt("alias")),$e=>$e.usedBy?.type):[]},u=P=>bt(me({realm:n,tab:P})),b=u("flows"),C=u("required-actions"),J=u("policies"),[De,Le]=mt({titleKey:"deleteConfirmFlow",children:y(kt,{i18nKey:"deleteConfirmFlowMessage",children:[" ",e("strong",{children:{flow:m?m.alias:""}}),"."]}),continueButtonLabel:"delete",continueButtonVariant:M.danger,onConfirm:async()=>{try{await g.authenticationManagement.deleteFlow({flowId:m.id}),o(),l(t("deleteFlowSuccess"),E.success)}catch(P){c("deleteFlowError",P)}}});return A?y(N,{children:[e(Le,{}),w&&e(Ot,{name:m?m.alias:"",description:m?.description,toggleDialog:r,onComplete:()=>{o(),r()}}),d&&e(Nt,{onClose:()=>{h(),o()},flowAlias:m?.alias}),e(yt,{titleKey:"titleAuthentication",subKey:"authenticationExplain",helpUrl:nt.authenticationUrl,divider:!1}),e(D,{variant:"light",className:"pf-u-p-0",children:y(ht,{isBox:!0,defaultLocation:me({realm:n,tab:"flows"}),children:[e(R,{"data-testid":"flows",title:e(k,{children:t("flows")}),...b,children:e(Fe,{loader:S,ariaLabelKey:"titleAuthentication",searchPlaceholderKey:"searchForFlow",toolbarItem:e(xe,{children:e(v,{component:P=>e(Re,{...P,to:lt({realm:n})}),children:t("createFlow")})}),actionResolver:({data:P})=>[{title:t("duplicate"),onClick:()=>{r(),p(P)}},...P.usedBy?.type!=="DEFAULT"?[{title:t("bindFlow"),onClick:()=>{h(),p(P)}}]:[],...!P.builtIn&&!P.usedBy?[{title:t("delete"),onClick:()=>{p(P),De()}}]:[]],columns:[{name:"alias",displayKey:"flowName",cellRenderer:P=>e(Jt,{...P})},{name:"usedBy",displayKey:"usedBy",cellRenderer:P=>e(Vt,{authType:P,realm:A})},{name:"description",displayKey:"description"}],emptyState:e(pt,{message:t("emptyEvents"),instructions:t("emptyEventsInstructions")})},a)}),e(R,{"data-testid":"requiredActions",title:e(k,{children:t("requiredActions")}),...C,children:e(xt,{})}),e(R,{"data-testid":"policies",title:e(k,{children:t("policies")}),...J,children:e(Qt,{})})]})})]}):e(oe,{})}const Ta=Object.freeze(Object.defineProperty({__proto__:null,REALM_FLOWS:W,default:Zt},Symbol.toStringTag,{value:"Module"}));export{Ta as A,Nt as B,Ot as D};
//# sourceMappingURL=AuthenticationSection-Cd6r8c1Z.js.map
