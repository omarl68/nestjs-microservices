import{jsx as s,jsxs as n,Fragment as v}from"react/jsx-runtime";import{useState as P}from"react";import{u as L,c as D,b as E,p as k,q as w,U as x,P as K,y as d,b9 as b,z as p,a0 as U,a1 as _,V as j,L as G,aU as g,f as r}from"./index-C9t2UlUN.js";import{u as H}from"./ConfirmDialog-BDkqxnFL.js";import{T as $}from"./Trans-DcN6j3pV.js";import{F as z}from"./Form-Cdw1qhWG.js";import{a3 as A,a4 as B,a5 as T,a6 as C,a7 as M,a8 as u,ai as O}from"./KeycloakDataTable-2rLFZPhG.js";const Y=({id:a,type:l})=>{const{t:i}=L(),y=D(),{realm:t}=E(),[h,F]=P(""),[m,c]=P(),I=k(),f=e=>{switch(l){case"clients":return r.clients.updateFineGrainPermission({id:a},{enabled:e});case"users":return r.realms.updateUsersManagementPermissions({realm:t,enabled:e});case"groups":return r.groups.updatePermission({id:a},{enabled:e});case"roles":return r.roles.updatePermission({id:a},{enabled:e});case"identityProviders":return r.identityProviders.updatePermission({alias:a},{enabled:e})}};w(()=>Promise.all([r.clients.find({search:!0,clientId:t==="master"?"master-realm":"realm-management"}),(()=>{switch(l){case"clients":return r.clients.listFineGrainPermissions({id:a});case"users":return r.realms.getUsersManagementPermissions({realm:t});case"groups":return r.groups.listPermissions({id:a});case"roles":return r.roles.listPermissions({id:a});case"identityProviders":return r.identityProviders.listPermissions({alias:a})}})()]),([e,o])=>{F(e[0]?.id),c(o)},[a]);const[N,S]=H({titleKey:"permissionsDisable",messageKey:"permissionsDisableConfirm",continueButtonLabel:"confirm",onConfirm:async()=>{const e=await f(!1);c(e)}});return m?n(K,{variant:"light",children:[s(S,{}),n(d,{isFlat:!0,children:[s(b,{children:i("permissions")}),n(p,{children:[i(`${l}PermissionsHint`),s(z,{isHorizontal:!0,className:"pf-u-pt-md",children:s(U,{hasNoPaddingTop:!0,className:"permission-label",label:i("permissionsEnabled"),fieldId:"permissionsEnabled",labelIcon:s(_,{helpText:i("permissionsEnabledHelp"),fieldLabelId:"permissionsEnabled"}),children:s(j,{id:"permissionsEnabled","data-testid":"permissionSwitch",label:i("on"),labelOff:i("off"),isChecked:m.enabled,onChange:async e=>{if(e){const o=await f(e);c(o)}else N()},"aria-label":i("permissionsEnabled")})})})]})]}),m.enabled&&n(v,{children:[n(d,{isFlat:!0,className:"pf-u-mt-lg",children:[s(b,{children:i("permissionsList")}),s(p,{children:n($,{i18nKey:"permissionsListIntro",children:[" ",s("strong",{children:{realm:t==="master"?"master-realm":"realm-management"}}),"."]})})]}),s(d,{isFlat:!0,className:"keycloak__permission__permission-table",children:s(p,{className:"pf-u-p-0",children:n(A,{"aria-label":i("permissionsList"),variant:"compact",children:[s(B,{children:n(T,{children:[s(C,{id:"permissionsScopeName",children:i("permissionsScopeName")}),s(C,{id:"description",children:i("description")})]})}),s(M,{children:I(Object.entries(m.scopePermissions||{}),([e])=>e).map(([e,o])=>n(T,{children:[s(u,{children:s(G,{to:g({realm:t,id:h,permissionType:"scope",permissionId:o}),children:e})}),s(u,{children:i(`scopePermissions.${l}.${e}-description`)}),s(u,{isActionCell:!0,children:s(O,{items:[{title:i("edit"),onClick(){y(g({realm:t,id:h,permissionType:"scope",permissionId:o}))}}]})})]},o))})]})})})]})]}):s(x,{})};export{Y as P};
//# sourceMappingURL=PermissionTab-Cqx0kVF9.js.map
