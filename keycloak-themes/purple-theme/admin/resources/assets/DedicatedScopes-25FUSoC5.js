import{jsxs as h,jsx as e,Fragment as T}from"react/jsx-runtime";import{useState as v}from"react";import{u as C,e as R,aR as E,P as D,a0 as I,a1 as x,V as P,ad as F,f as n,A,c as L,q as O,U as V,av as g,by as w}from"./index-C9t2UlUN.js";import{M as k}from"./MapperList-Caj0zikG.js";import{R as H,u as K}from"./RoutableTabs-vx5wTdby.js";import{V as N}from"./ViewHeader-cxZm8XhN.js";import{u as j}from"./useParams-DL8-63Ov.js";import{F as G}from"./FormAccess-DnQCcStE.js";import{R as q}from"./AddRoleMappingModal-BWNuJU0W.js";import{a as y,b as M}from"./Tabs-CjrDEqsl.js";import"react-dom";import"./PaginatingTableToolbar-oQUfBy2J.js";import"./EmptyStateBody-CyIhnUop.js";import"./EmptyStateSecondaryActions-BekVwNvY.js";import"./ToolbarContent-D6TJq6fk.js";import"./Form-Cdw1qhWG.js";import"./KeycloakDataTable-2rLFZPhG.js";import"./grip-vertical-icon-B_ub3hpF.js";import"./_baseFlatten-BQ8y46Zj.js";import"./Modal-Bgkd26UL.js";import"./DataListItemRow-Bimi62Tu.js";import"./PageHandler-TK8xnd8P.js";import"./DynamicComponents-D5DD9CFr.js";import"./FileUpload-CTw4RKK1.js";import"./CodeEditor-Cp4g17EF.js";import"./copy-icon-CYSS18Ce.js";import"./GroupPickerDialog-tI6XV7Ln.js";import"./useToggle-K3Kx99tM.js";import"./KeycloakTextInput-DrlF32nr.js";import"./ConfirmDialog-BDkqxnFL.js";import"./FlexItem-BEayPdRt.js";import"./KeySelect-CPI9XGq0.js";import"./MultiLineInput-DibC-IV_.js";import"./PasswordInput-CJKuHljf.js";import"./KeycloakTextArea-DChmurIP.js";import"./PageList-59HC89eh.js";import"./filter-icon-C8nM2k1N.js";import"./MenuList-Br-Zu33q.js";const z=({client:d})=>{const{t:r}=C(),{addAlert:s,addError:m}=R(),[t,f]=v(d),{hasAccess:i}=E(),u=i("manage-clients")||t.access?.manage,S=async l=>{try{const c=l.filter(a=>a.client===void 0).map(a=>a.role).flat();await Promise.all([n.clients.addRealmScopeMappings({id:t.id},c),...l.filter(a=>a.client!==void 0).map(a=>n.clients.addClientScopeMappings({id:t.id,client:a.client.id},[a.role]))]),s(r("clientScopeSuccess"),A.success)}catch(c){m("clientScopeError",c)}},b=async()=>{const l={...t,fullScopeAllowed:!t.fullScopeAllowed};try{await n.clients.update({id:t.id},l),s(r("clientScopeSuccess"),A.success),f(l)}catch(c){m("clientScopeError",c)}};return h(D,{children:[e(G,{role:"manage-clients",fineGrainedAccess:t.access?.manage,isHorizontal:!0,children:e(I,{hasNoPaddingTop:!0,label:r("fullScopeAllowed"),labelIcon:e(x,{helpText:r("fullScopeAllowedHelp"),fieldLabelId:"fullScopeAllowed"}),fieldId:"fullScopeAllowed",children:e(P,{id:"fullScopeAllowed",label:r("on"),labelOff:r("off"),isChecked:t.fullScopeAllowed,onChange:b,"aria-label":r("fullScopeAllowed")})})}),!t.fullScopeAllowed&&h(T,{children:[e(F,{}),e(q,{name:t.clientId,id:t.id,type:"clients",save:S,isManager:u})]})]})};function Ee(){const{t:d}=C(),r=L(),{realm:s,clientId:m}=j(),{addAlert:t,addError:f}=R(),[i,u]=v();O(()=>n.clients.findOne({id:m}),u,[]);const S=o=>K(g({realm:s,clientId:m,tab:o})),b=S("mappers"),l=S("scope");if(!i)return e(V,{});const c=async o=>{if(Array.isArray(o))try{await n.clients.addMultipleProtocolMappers({id:i.id},o),u(await n.clients.findOne({id:i.id})),t(d("mappingCreatedSuccess"),A.success)}catch(p){f("mappingCreatedError",p)}else{const p=o;r(w({realm:s,id:i.id,mapperId:p.id}))}},a=async o=>{try{await n.clients.delProtocolMapper({id:i.id,mapperId:o.id}),u({...i,protocolMappers:i.protocolMappers?.filter(p=>p.id!==o.id)}),t(d("mappingDeletedSuccess"),A.success)}catch(p){f("mappingDeletedError",p)}return!0};return h(T,{children:[e(N,{titleKey:i.clientId+"-dedicated",subKey:"dedicatedScopeExplain",divider:!1}),e(D,{variant:"light",className:"pf-u-p-0",children:h(H,{isBox:!0,mountOnEnter:!0,defaultLocation:g({realm:s,clientId:m,tab:"mappers"}),children:[e(y,{title:e(M,{children:d("mappers")}),"data-testid":"mappersTab",...b,children:e(k,{model:i,onAdd:c,onDelete:a,detailLink:o=>w({realm:s,id:i.id,mapperId:o})})}),e(y,{title:e(M,{children:d("scope")}),"data-testid":"scopeTab",...l,children:e(z,{client:i})})]})})]})}export{Ee as default};
//# sourceMappingURL=DedicatedScopes-25FUSoC5.js.map
