{"version":3,"file":"PageList-59HC89eh.js","sources":["../../src/page/PageList.tsx"],"sourcesContent":["import ComponentRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/componentRepresentation\";\nimport type RealmRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/realmRepresentation\";\nimport type { ComponentQuery } from \"@keycloak/keycloak-admin-client/lib/resources/components\";\nimport {\n  Button,\n  ButtonVariant,\n  PageSection,\n  ToolbarItem,\n} from \"@patternfly/react-core\";\nimport { IRowData } from \"@patternfly/react-table\";\nimport { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link, useNavigate, useParams } from \"react-router-dom\";\nimport { adminClient } from \"../admin-client\";\nimport { useAlerts } from \"../components/alert/Alerts\";\nimport { useConfirmDialog } from \"../components/confirm-dialog/ConfirmDialog\";\nimport { ListEmptyState } from \"../components/list-empty-state/ListEmptyState\";\nimport { KeycloakDataTable } from \"../components/table-toolbar/KeycloakDataTable\";\nimport { ViewHeader } from \"../components/view-header/ViewHeader\";\nimport { useRealm } from \"../context/realm-context/RealmContext\";\nimport { useServerInfo } from \"../context/server-info/ServerInfoProvider\";\nimport { useFetch } from \"../utils/useFetch\";\nimport { PageListParams, toDetailPage } from \"./routes\";\n\nexport const PAGE_PROVIDER = \"org.keycloak.services.ui.extend.UiPageProvider\";\nexport const TAB_PROVIDER = \"org.keycloak.services.ui.extend.UiTabProvider\";\n\nconst DetailLink = (obj: ComponentRepresentation) => {\n  const { realm } = useRealm();\n  return (\n    <Link\n      key={obj.id}\n      to={toDetailPage({ realm, providerId: obj.providerId!, id: obj.id! })}\n    >\n      {obj.id}\n    </Link>\n  );\n};\nexport default function PageList() {\n  const { t } = useTranslation();\n  const { addAlert, addError } = useAlerts();\n  const navigate = useNavigate();\n  const { providerId } = useParams<PageListParams>();\n  const [key, setKey] = useState(0);\n  const refresh = () => setKey(key + 1);\n\n  const { realm: realmName } = useRealm();\n  const [realm, setRealm] = useState<RealmRepresentation>();\n  const [selectedItem, setSelectedItem] = useState<ComponentRepresentation>();\n  const { componentTypes } = useServerInfo();\n  const pages = componentTypes?.[PAGE_PROVIDER];\n\n  const page = pages?.find((p) => p.id === providerId)!;\n\n  useFetch(\n    async () => adminClient.realms.findOne({ realm: realmName }),\n    setRealm,\n    [],\n  );\n\n  const loader = async () => {\n    const params: ComponentQuery = {\n      parent: realm?.id,\n      type: PAGE_PROVIDER,\n    };\n    return await adminClient.components.find({ ...params });\n  };\n\n  const [toggleDeleteDialog, DeleteConfirm] = useConfirmDialog({\n    titleKey: \"itemDeleteConfirmTitle\",\n    messageKey: \"itemDeleteConfirm\",\n    continueButtonLabel: \"delete\",\n    continueButtonVariant: ButtonVariant.danger,\n    onConfirm: async () => {\n      try {\n        await adminClient.components.del({\n          id: selectedItem!.id!,\n        });\n        addAlert(t(\"itemDeletedSuccess\"));\n        refresh();\n      } catch (error) {\n        addError(\"itemSaveError\", error);\n      }\n    },\n  });\n\n  return (\n    <PageSection variant=\"light\" className=\"pf-u-p-0\">\n      <DeleteConfirm />\n      <ViewHeader titleKey={page.id} subKey={page.helpText} divider={false} />\n      <KeycloakDataTable\n        key={key}\n        toolbarItem={\n          <ToolbarItem>\n            <Button\n              component={(props) => (\n                <Link\n                  {...props}\n                  to={toDetailPage({ realm: realmName, providerId: page.id })}\n                />\n              )}\n            >\n              {t(\"createItem\")}\n            </Button>\n          </ToolbarItem>\n        }\n        actionResolver={(item: IRowData) => [\n          {\n            title: t(\"delete\"),\n            onClick() {\n              setSelectedItem(item.data);\n              toggleDeleteDialog();\n            },\n          },\n        ]}\n        searchPlaceholderKey=\"searchItem\"\n        loader={loader}\n        columns={[\n          { name: \"id\", cellRenderer: DetailLink },\n          ...page.properties.slice(0, 3).map((p) => ({\n            name: `config.${p.name}[0]`,\n            displayKey: p.label,\n          })),\n        ]}\n        ariaLabelKey=\"list\"\n        emptyState={\n          <ListEmptyState\n            hasIcon\n            message={t(\"noItems\")}\n            instructions={t(\"noItemsInstructions\")}\n            primaryActionText={t(\"createItem\")}\n            onPrimaryAction={() =>\n              navigate(toDetailPage({ realm: realmName, providerId: page.id }))\n            }\n          />\n        }\n      />\n    </PageSection>\n  );\n}\n"],"names":["PAGE_PROVIDER","TAB_PROVIDER","DetailLink","obj","realm","useRealm","jsx","Link","toDetailPage","PageList","useTranslation","addAlert","addError","useAlerts","navigate","useNavigate","providerId","useParams","key","setKey","useState","refresh","realmName","setRealm","selectedItem","setSelectedItem","componentTypes","useServerInfo","page","p","useFetch","adminClient","loader","params","toggleDeleteDialog","DeleteConfirm","useConfirmDialog","ButtonVariant","error","jsxs","PageSection","ViewHeader","KeycloakDataTable","ToolbarItem","Button","props","item","ListEmptyState"],"mappings":"urBAwBO,MAAMA,EAAgB,iDAChBC,GAAe,gDAEtBC,EAAcC,GAAiC,CAC7C,KAAA,CAAE,MAAAC,GAAUC,IAEhB,OAAAC,EAACC,EAAA,CAEC,GAAIC,EAAa,CAAE,MAAAJ,EAAO,WAAYD,EAAI,WAAa,GAAIA,EAAI,GAAK,EAEnE,SAAIA,EAAA,EAAA,EAHAA,EAAI,EAAA,CAMf,EACA,SAAwBM,IAAW,CAC3B,KAAA,CAAE,GAAMC,IACR,CAAE,SAAAC,EAAU,SAAAC,CAAS,EAAIC,EAAU,EACnCC,EAAWC,IACX,CAAE,WAAAC,GAAeC,IACjB,CAACC,EAAKC,CAAM,EAAIC,EAAS,CAAC,EAC1BC,EAAU,IAAMF,EAAOD,EAAM,CAAC,EAE9B,CAAE,MAAOI,CAAU,EAAIjB,EAAS,EAChC,CAACD,EAAOmB,CAAQ,EAAIH,EAA8B,EAClD,CAACI,EAAcC,CAAe,EAAIL,EAAkC,EACpE,CAAE,eAAAM,GAAmBC,IAGrBC,EAFQF,IAAiB1B,CAAa,GAExB,KAAM6B,GAAMA,EAAE,KAAOb,CAAU,EAEnDc,EACE,SAAYC,EAAY,OAAO,QAAQ,CAAE,MAAOT,EAAW,EAC3DC,EACA,CAAC,CAAA,EAGH,MAAMS,EAAS,SAAY,CACzB,MAAMC,EAAyB,CAC7B,OAAQ7B,GAAO,GACf,KAAMJ,CAAA,EAER,OAAO,MAAM+B,EAAY,WAAW,KAAK,CAAE,GAAGE,EAAQ,CAAA,EAGlD,CAACC,EAAoBC,CAAa,EAAIC,EAAiB,CAC3D,SAAU,yBACV,WAAY,oBACZ,oBAAqB,SACrB,sBAAuBC,EAAc,OACrC,UAAW,SAAY,CACjB,GAAA,CACI,MAAAN,EAAY,WAAW,IAAI,CAC/B,GAAIP,EAAc,EAAA,CACnB,EACQb,EAAA,EAAE,oBAAoB,CAAC,EACxBU,UACDiB,EAAO,CACd1B,EAAS,gBAAiB0B,CAAK,CACjC,CACF,CAAA,CACD,EAED,OACGC,EAAAC,EAAA,CAAY,QAAQ,QAAQ,UAAU,WACrC,SAAA,CAAAlC,EAAC6B,EAAc,EAAA,EACf7B,EAACmC,GAAW,SAAUb,EAAK,GAAI,OAAQA,EAAK,SAAU,QAAS,EAAO,CAAA,EACtEtB,EAACoC,EAAA,CAEC,cACGC,EACC,CAAA,SAAArC,EAACsC,EAAA,CACC,UAAYC,GACVvC,EAACC,EAAA,CACE,GAAGsC,EACJ,GAAIrC,EAAa,CAAE,MAAOc,EAAW,WAAYM,EAAK,GAAI,CAAA,CAC5D,EAGD,WAAE,YAAY,CAAA,CAAA,EAEnB,EAEF,eAAiBkB,GAAmB,CAClC,CACE,MAAO,EAAE,QAAQ,EACjB,SAAU,CACRrB,EAAgBqB,EAAK,IAAI,EACNZ,GACrB,CACF,CACF,EACA,qBAAqB,aACrB,OAAAF,EACA,QAAS,CACP,CAAE,KAAM,KAAM,aAAc9B,CAAW,EACvC,GAAG0B,EAAK,WAAW,MAAM,EAAG,CAAC,EAAE,IAAKC,IAAO,CACzC,KAAM,UAAUA,EAAE,IAAI,MACtB,WAAYA,EAAE,KAAA,EACd,CACJ,EACA,aAAa,OACb,WACEvB,EAACyC,EAAA,CACC,QAAO,GACP,QAAS,EAAE,SAAS,EACpB,aAAc,EAAE,qBAAqB,EACrC,kBAAmB,EAAE,YAAY,EACjC,gBAAiB,IACfjC,EAASN,EAAa,CAAE,MAAOc,EAAW,WAAYM,EAAK,EAAG,CAAC,CAAC,CAAA,CAEpE,CAAA,EA3CGV,CA6CP,CACF,CAAA,CAAA,CAEJ"}