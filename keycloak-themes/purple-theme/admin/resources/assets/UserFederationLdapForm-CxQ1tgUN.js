import{jsxs as u,Fragment as m,jsx as e}from"react/jsx-runtime";import{u as A,b as O,e as U,a4 as F,a0 as i,a1 as l,a3 as g,V as S,I as L,S as h,h as x,J as V,a2 as T,f as q,A as E,cw as j,q as $,Z as K,c as M,aP as B,dJ as _}from"./index-C9t2UlUN.js";import{F as C,a as G}from"./FormAccess-DnQCcStE.js";import{u as W,F as Y}from"./useIsFeatureEnabled-CkHhuO9z.js";import{W as w,S as J}from"./SettingsCache-VBvTpNnN.js";import{useState as D}from"react";import{K as b}from"./KeycloakTextInput-DrlF32nr.js";import{P as Z}from"./PasswordInput-CJKuHljf.js";import{i as Q}from"./isEqual-CVfl2lzU.js";import{F as X}from"./Form-Cdw1qhWG.js";const ee=["connectionUrl","bindDn","bindCredential","useTruststoreSpi","connectionTimeout","startTls","authType"],N=t=>{const n={};return ee.forEach(s=>{const a=j(t.getValues(),`config.${s}`);n[s]=Array.isArray(a)?a[0]:""}),n},te=({form:t,id:n,showSectionHeading:s=!1,showSectionDescription:a=!1})=>{const{t:r}=A(),{realm:p}=O(),{addAlert:d,addError:f}=U(),P=!!n,o=async v=>{try{const y=N(t);await q.realms.testLDAPConnection({realm:p},{...y,action:v,componentId:n}),d(r("testSuccess"),E.success)}catch(y){f("testError",y)}},[c,I]=D(!1),[k,H]=D(!1),z=F({control:t.control,name:"config.authType",defaultValue:["simple"]});return u(m,{children:[s&&e(w,{title:r("connectionAndAuthenticationSettings"),description:r("ldapConnectionAndAuthorizationSettingsDescription"),showDescription:a}),u(C,{role:"manage-realm",isHorizontal:!0,children:[e(i,{label:r("connectionURL"),labelIcon:e(l,{helpText:r("consoleDisplayConnectionUrlHelp"),fieldLabelId:"connectionURL"}),fieldId:"kc-ui-connection-url",isRequired:!0,validated:t.formState.errors.config?.connectionUrl?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.connectionUrl?.[0].message,children:e(b,{isRequired:!0,type:"url",id:"kc-ui-connection-url","data-testid":"ldap-connection-url",validated:t.formState.errors.config?.connectionUrl?.[0]?"error":"default",...t.register("config.connectionUrl.0",{required:{value:!0,message:r("validateConnectionUrl").toString()}})})}),e(i,{label:r("enableStartTls"),labelIcon:e(l,{helpText:r("enableStartTlsHelp"),fieldLabelId:"enableStartTls"}),fieldId:"kc-enable-start-tls",hasNoPaddingTop:!0,children:e(g,{name:"config.startTls",defaultValue:["false"],control:t.control,render:({field:v})=>e(S,{id:"kc-enable-start-tls","data-testid":"enable-start-tls",isDisabled:!1,onChange:y=>v.onChange([`${y}`]),isChecked:v.value[0]==="true",label:r("on"),labelOff:r("off"),"aria-label":r("enableStartTls")})})}),e(i,{label:r("useTruststoreSpi"),labelIcon:e(l,{helpText:r("useTruststoreSpiHelp"),fieldLabelId:"useTruststoreSpi"}),fieldId:"kc-use-truststore-spi",children:e(g,{name:"config.useTruststoreSpi[0]",control:t.control,defaultValue:"always",render:({field:v})=>u(L,{toggleId:"kc-use-truststore-spi",onToggle:()=>I(!c),isOpen:c,onSelect:(y,R)=>{v.onChange(R.toString()),I(!1)},selections:v.value,children:[e(h,{value:"always",children:r("always")}),e(h,{value:"never",children:r("never")})]})})}),e(i,{label:r("connectionPooling"),labelIcon:e(l,{helpText:r("connectionPoolingHelp"),fieldLabelId:"connectionPooling"}),fieldId:"kc-connection-pooling",hasNoPaddingTop:!0,children:e(g,{name:"config.connectionPooling",defaultValue:["false"],control:t.control,render:({field:v})=>e(S,{id:"kc-connection-pooling","data-testid":"connection-pooling",isDisabled:!1,onChange:y=>v.onChange([`${y}`]),isChecked:v.value[0]==="true",label:r("on"),labelOff:r("off"),"aria-label":r("connectionPooling")})})}),e(i,{label:r("connectionTimeout"),labelIcon:e(l,{helpText:r("connectionTimeoutHelp"),fieldLabelId:"consoleTimeout"}),fieldId:"kc-ui-connection-timeout",children:e(b,{type:"number",min:0,id:"kc-ui-connection-timeout","data-testid":"connection-timeout",...t.register("config.connectionTimeout.0")})}),e(i,{fieldId:"kc-test-connection-button",children:e(x,{variant:"secondary",id:"kc-test-connection-button","data-testid":"test-connection-button",onClick:()=>o("testConnection"),children:r("testConnection")})}),e(i,{label:r("bindType"),labelIcon:e(l,{helpText:r("bindTypeHelp"),fieldLabelId:"bindType"}),fieldId:"kc-bind-type",isRequired:!0,children:e(g,{name:"config.authType[0]",defaultValue:"simple",control:t.control,render:({field:v})=>u(L,{toggleId:"kc-bind-type",required:!0,onToggle:()=>H(!k),isOpen:k,onSelect:(y,R)=>{v.onChange(R),H(!1)},selections:v.value,variant:V.single,"data-testid":"ldap-bind-type","aria-label":r("selectBindType"),children:[e(h,{value:"simple"}),e(h,{value:"none"})]})})}),Q(z,["simple"])&&u(m,{children:[e(i,{label:r("bindDn"),labelIcon:e(l,{helpText:r("bindDnHelp"),fieldLabelId:"bindDn"}),fieldId:"kc-ui-bind-dn",helperTextInvalid:r("validateBindDn"),validated:t.formState.errors.config?.bindDn?T.error:T.default,isRequired:!0,children:e(b,{type:"text",id:"kc-ui-bind-dn","data-testid":"ldap-bind-dn",validated:t.formState.errors.config?.bindDn?T.error:T.default,...t.register("config.bindDn.0",{required:!0})})}),e(i,{label:r("bindCredentials"),labelIcon:e(l,{helpText:r("bindCredentialsHelp"),fieldLabelId:"bindCredentials"}),fieldId:"kc-ui-bind-credentials",helperTextInvalid:r("validateBindCredentials"),validated:t.formState.errors.config?.bindCredential?T.error:T.default,isRequired:!0,children:e(Z,{hasReveal:!P,isRequired:!0,id:"kc-ui-bind-credentials","data-testid":"ldap-bind-credentials",validated:t.formState.errors.config?.bindCredential?T.error:T.default,...t.register("config.bindCredential.0",{required:!0})})})]}),e(i,{fieldId:"kc-test-auth-button",children:e(x,{variant:"secondary",id:"kc-test-auth-button","data-testid":"test-auth-button",onClick:()=>o("testAuthentication"),children:r("testAuthentication")})})]})]})},ae="1.3.6.1.4.1.4203.1.11.1",re=({id:t,form:n,showSectionHeading:s=!1,showSectionDescription:a=!1})=>{const{t:r}=A(),{realm:p}=O(),{addAlert:d,addError:f}=U(),P=async()=>{if(await n.trigger())try{const o=N(n),c=await q.realms.ldapServerCapabilities({realm:p},{...o,componentId:t});d(r("testSuccess"));const I=c.filter(k=>k.oid===ae);n.setValue("config.usePasswordModifyExtendedOp",[(I.length>0).toString()])}catch(o){f("testError",o)}};return u(m,{children:[s&&e(w,{title:r("advancedSettings"),description:r("ldapAdvancedSettingsDescription"),showDescription:a}),u(C,{role:"manage-realm",isHorizontal:!0,children:[e(i,{label:r("enableLdapv3Password"),labelIcon:e(l,{helpText:r("enableLdapv3PasswordHelp"),fieldLabelId:"enableLdapv3Password"}),fieldId:"kc-enable-ldapv3-password",hasNoPaddingTop:!0,children:e(g,{name:"config.usePasswordModifyExtendedOp",defaultValue:["false"],control:n.control,render:({field:o})=>e(S,{id:"kc-enable-ldapv3-password","data-testid":"ldapv3-password",isDisabled:!1,onChange:c=>o.onChange([`${c}`]),isChecked:o.value[0]==="true",label:r("on"),labelOff:r("off"),"aria-label":r("enableLdapv3Password")})})}),e(i,{label:r("validatePasswordPolicy"),labelIcon:e(l,{helpText:r("validatePasswordPolicyHelp"),fieldLabelId:"validatePasswordPolicy"}),fieldId:"kc-validate-password-policy",hasNoPaddingTop:!0,children:e(g,{name:"config.validatePasswordPolicy",defaultValue:["false"],control:n.control,render:({field:o})=>e(S,{id:"kc-validate-password-policy","data-testid":"password-policy",isDisabled:!1,onChange:c=>o.onChange([`${c}`]),isChecked:o.value[0]==="true",label:r("on"),labelOff:r("off"),"aria-label":r("validatePasswordPolicy")})})}),e(i,{label:r("trustEmail"),labelIcon:e(l,{helpText:r("trustEmailHelp"),fieldLabelId:"trustEmail"}),fieldId:"kc-trust-email",hasNoPaddingTop:!0,children:e(g,{name:"config.trustEmail",defaultValue:["false"],control:n.control,render:({field:o})=>e(S,{id:"kc-trust-email","data-testid":"trust-email",isDisabled:!1,onChange:c=>o.onChange([`${c}`]),isChecked:o.value[0]==="true",label:r("on"),labelOff:r("off"),"aria-label":r("trustEmail")})})}),e(i,{fieldId:"query-extensions",children:e(x,{variant:"secondary",id:"query-extensions","data-testid":"query-extensions",onClick:P,children:r("queryExtensions")})})]})]})},ie=({form:t,showSectionHeading:n=!1,showSectionDescription:s=!1,vendorEdit:a=!1})=>{const{t:r}=A(),{realm:p}=O();$(()=>q.realms.findOne({realm:p}),o=>t.setValue("parentId",o.id),[]);const[d,f]=D(!1),P=()=>{switch(t.getValues("config.vendor[0]")){case"ad":t.setValue("config.usernameLDAPAttribute[0]","cn"),t.setValue("config.rdnLDAPAttribute[0]","cn"),t.setValue("config.uuidLDAPAttribute[0]","objectGUID"),t.setValue("config.krbPrincipalAttribute[0]","userPrincipalName"),t.setValue("config.userObjectClasses[0]","person, organizationalPerson, user");break;case"rhds":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","nsuniqueid"),t.setValue("config.krbPrincipalAttribute[0]","krbPrincipalName"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;case"tivoli":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","uniqueidentifier"),t.setValue("config.krbPrincipalAttribute[0]","krb5PrincipalName"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;case"edirectory":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","guid"),t.setValue("config.krbPrincipalAttribute[0]","krb5PrincipalName"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;case"other":t.setValue("config.usernameLDAPAttribute[0]","uid"),t.setValue("config.rdnLDAPAttribute[0]","uid"),t.setValue("config.uuidLDAPAttribute[0]","entryUUID"),t.setValue("config.krbPrincipalAttribute[0]","krb5PrincipalName"),t.setValue("config.userObjectClasses[0]","inetOrgPerson, organizationalPerson");break;default:return""}};return u(m,{children:[n&&e(w,{title:r("generalOptions"),description:r("ldapGeneralOptionsSettingsDescription"),showDescription:s}),u(C,{role:"manage-realm",isHorizontal:!0,children:[u(i,{label:r("uiDisplayName"),labelIcon:e(l,{helpText:r("uiDisplayNameHelp"),fieldLabelId:"uiDisplayName"}),fieldId:"kc-ui-display-name",isRequired:!0,validated:t.formState.errors.name?"error":"default",helperTextInvalid:t.formState.errors.name?.message,children:[e(b,{hidden:!0,id:"kc-ui-provider-id",defaultValue:"ldap",...t.register("providerId")}),e(b,{hidden:!0,id:"kc-ui-provider-type",defaultValue:"org.keycloak.storage.UserStorageProvider",...t.register("providerType")}),e(b,{hidden:!0,id:"kc-ui-parentId",defaultValue:p,...t.register("parentId")}),e(b,{isRequired:!0,id:"kc-ui-display-name",defaultValue:"ldap","data-testid":"ldap-name",validated:t.formState.errors.name?"error":"default",...t.register("name",{required:{value:!0,message:`${r("validateName")}`}})})]}),e(i,{label:r("vendor"),labelIcon:e(l,{helpText:r("vendorHelp"),fieldLabelId:"vendor"}),fieldId:"kc-vendor",isRequired:!0,children:e(g,{name:"config.vendor[0]",defaultValue:"ad",control:t.control,render:({field:o})=>u(L,{isDisabled:!!a,toggleId:"kc-vendor",required:!0,onToggle:()=>f(!d),isOpen:d,onSelect:(c,I)=>{o.onChange(I),f(!1),P()},selections:o.value,variant:V.single,"aria-label":r("selectVendor"),children:[e(h,{value:"ad",isPlaceholder:!0,children:"Active Directory"},0),e(h,{value:"rhds",children:"Red Hat Directory Server"},1),e(h,{value:"tivoli",children:"Tivoli"},2),e(h,{value:"edirectory",children:"Novell eDirectory"},3),e(h,{value:"other",children:"Other"},4)]})})})]})]})},le=({form:t,showSectionHeading:n=!1,showSectionDescription:s=!1})=>{const{t:a}=A(),r=F({control:t.control,name:"config.allowKerberosAuthentication",defaultValue:["false"]});return u(m,{children:[n&&e(w,{title:a("kerberosIntegration"),description:a("ldapKerberosSettingsDescription"),showDescription:s}),u(C,{role:"manage-realm",isHorizontal:!0,children:[e(i,{label:a("allowKerberosAuthentication"),labelIcon:e(l,{helpText:a("allowKerberosAuthenticationHelp"),fieldLabelId:"allowKerberosAuthentication"}),fieldId:"kc-allow-kerberos-authentication",hasNoPaddingTop:!0,children:e(g,{name:"config.allowKerberosAuthentication",defaultValue:["false"],control:t.control,render:({field:p})=>e(S,{id:"kc-allow-kerberos-authentication","data-testid":"allow-kerberos-auth",isDisabled:!1,onChange:d=>p.onChange([`${d}`]),isChecked:p.value[0]==="true",label:a("on"),labelOff:a("off"),"aria-label":a("allowKerberosAuthentication")})})}),r[0]==="true"&&u(m,{children:[e(i,{label:a("kerberosRealm"),labelIcon:e(l,{helpText:a("kerberosRealmHelp"),fieldLabelId:"kerberosRealm"}),fieldId:"kc-kerberos-realm",isRequired:!0,validated:t.formState.errors.config?.kerberosRealm?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.kerberosRealm?.[0].message,children:e(b,{isRequired:!0,id:"kc-kerberos-realm","data-testid":"kerberos-realm",validated:t.formState.errors.config?.kerberosRealm?.[0]?"error":"default",...t.register("config.kerberosRealm.0",{required:{value:!0,message:a("validateRealm").toString()}})})}),e(i,{label:a("serverPrincipal"),labelIcon:e(l,{helpText:a("serverPrincipalHelp"),fieldLabelId:"serverPrincipal"}),fieldId:"kc-server-principal",isRequired:!0,validated:t.formState.errors.config?.serverPrincipal?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.serverPrincipal?.[0].message,children:e(b,{isRequired:!0,id:"kc-server-principal","data-testid":"kerberos-principal",validated:t.formState.errors.config?.serverPrincipal?.[0]?"error":"default",...t.register("config.serverPrincipal.0",{required:{value:!0,message:`${a("validateServerPrincipal")}`}})})}),e(i,{label:a("keyTab"),labelIcon:e(l,{helpText:a("keyTabHelp"),fieldLabelId:"keyTab"}),fieldId:"kc-key-tab",isRequired:!0,validated:t.formState.errors.config?.keyTab?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.keyTab?.[0].message,children:e(b,{isRequired:!0,id:"kc-key-tab","data-testid":"kerberos-keytab",validated:t.formState.errors.config?.keyTab?.[0]?"error":"default",...t.register("config.keyTab.0",{required:{value:!0,message:`${a("validateKeyTab")}`}})})}),e(i,{label:a("krbPrincipalAttribute"),labelIcon:e(l,{helpText:a("krbPrincipalAttributeHelp"),fieldLabelId:"krbPrincipalAttribute"}),fieldId:"kc-krb-principal-attribute",validated:t.formState.errors.config?.krbPrincipalAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.krbPrincipalAttribute?.[0].message,children:e(b,{id:"kc-krb-principal-attribute","data-testid":"krb-principal-attribute",validated:t.formState.errors.config?.krbPrincipalAttribute?.[0]?"error":"default",...t.register("config.krbPrincipalAttribute.0")})}),u(i,{label:a("debug"),labelIcon:e(l,{helpText:a("debugHelp"),fieldLabelId:"debug"}),fieldId:"kc-debug",hasNoPaddingTop:!0,children:[" ",e(g,{name:"config.debug",defaultValue:["false"],control:t.control,render:({field:p})=>e(S,{id:"kc-debug","data-testid":"debug",isDisabled:!1,onChange:d=>p.onChange([`${d}`]),isChecked:p.value[0]==="true",label:a("on"),labelOff:a("off"),"aria-label":a("debug")})})]})]}),e(i,{label:a("useKerberosForPasswordAuthentication"),labelIcon:e(l,{helpText:a("useKerberosForPasswordAuthenticationHelp"),fieldLabelId:"useKerberosForPasswordAuthentication"}),fieldId:"kc-use-kerberos-password-authentication",hasNoPaddingTop:!0,children:e(g,{name:"config.useKerberosForPasswordAuthentication",defaultValue:["false"],control:t.control,render:({field:p})=>e(S,{id:"kc-use-kerberos-password-authentication","data-testid":"use-kerberos-pw-auth",isDisabled:!1,onChange:d=>p.onChange([`${d}`]),isChecked:p.value[0]==="true",label:a("on"),labelOff:a("off"),"aria-label":a("useKerberosForPasswordAuthentication")})})})]})]})},ne=({form:t,showSectionHeading:n=!1,showSectionDescription:s=!1})=>{const{t:a}=A(),[r,p]=D(!1),[d,f]=D(!1),[P,o]=D(!1);return u(m,{children:[n&&e(w,{title:a("ldapSearchingAndUpdatingSettings"),description:a("ldapSearchingAndUpdatingSettingsDescription"),showDescription:s}),u(C,{role:"manage-realm",isHorizontal:!0,children:[e(i,{label:a("editMode"),labelIcon:e(l,{helpText:a("editModeLdapHelp"),fieldLabelId:"editMode"}),fieldId:"kc-edit-mode",isRequired:!0,validated:t.formState.errors.config?.editMode?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.editMode?.[0].message,children:e(g,{name:"config.editMode[0]",defaultValue:"",control:t.control,rules:{required:{value:!0,message:a("validateEditMode")}},render:({field:c})=>u(L,{toggleId:"kc-edit-mode",required:!0,onToggle:()=>f(!d),isOpen:d,onSelect:(I,k)=>{c.onChange(k.toString()),f(!1)},selections:c.value,variant:V.single,"aria-label":a("selectEditMode"),validated:t.formState.errors.config?.editMode?.[0]?"error":"default",children:[e(h,{"aria-label":a("emptySelection"),value:"",isPlaceholder:!0}),e(h,{"aria-label":a("readOnlySelection"),value:"READ_ONLY"}),e(h,{"aria-label":a("writableSelection"),value:"WRITABLE"}),e(h,{"aria-label":a("unsyncedSelection"),value:"UNSYNCED"})]})})}),e(i,{label:a("usersDN"),labelIcon:e(l,{helpText:a("usersDNHelp"),fieldLabelId:"usersDn"}),fieldId:"kc-ui-users-dn",isRequired:!0,validated:t.formState.errors.config?.usersDn?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.usersDn?.[0].message,children:e(b,{isRequired:!0,defaultValue:"",id:"kc-ui-users-dn","data-testid":"ldap-users-dn",validated:t.formState.errors.config?.usersDn?.[0]?"error":"default",...t.register("config.usersDn.0",{required:{value:!0,message:a("validateUsersDn").toString()}})})}),e(i,{label:a("usernameLdapAttribute"),labelIcon:e(l,{helpText:a("usernameLdapAttributeHelp"),fieldLabelId:"usernameLdapAttribute"}),fieldId:"kc-username-ldap-attribute",isRequired:!0,validated:t.formState.errors.config?.usernameLDAPAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.usernameLDAPAttribute?.[0].message,children:e(b,{isRequired:!0,defaultValue:"cn",id:"kc-username-ldap-attribute","data-testid":"ldap-username-attribute",validated:t.formState.errors.config?.usernameLDAPAttribute?.[0]?"error":"default",...t.register("config.usernameLDAPAttribute.0",{required:{value:!0,message:`${a("validateUsernameLDAPAttribute")}`}})})}),e(i,{label:a("rdnLdapAttribute"),labelIcon:e(l,{helpText:a("rdnLdapAttributeHelp"),fieldLabelId:"rdnLdapAttribute"}),fieldId:"kc-rdn-ldap-attribute",isRequired:!0,validated:t.formState.errors.config?.rdnLDAPAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.rdnLDAPAttribute?.[0].message,children:e(b,{isRequired:!0,defaultValue:"cn",id:"kc-rdn-ldap-attribute","data-testid":"ldap-rdn-attribute",validated:t.formState.errors.config?.rdnLDAPAttribute?.[0]?"error":"default",...t.register("config.rdnLDAPAttribute.0",{required:{value:!0,message:`${a("validateRdnLdapAttribute")}`}})})}),e(i,{label:a("uuidLdapAttribute"),labelIcon:e(l,{helpText:a("uuidLdapAttributeHelp"),fieldLabelId:"uuidLdapAttribute"}),fieldId:"kc-uuid-ldap-attribute",isRequired:!0,validated:t.formState.errors.config?.uuidLDAPAttribute?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.uuidLDAPAttribute?.[0].message,children:e(b,{isRequired:!0,defaultValue:"objectGUID",id:"kc-uuid-ldap-attribute","data-testid":"ldap-uuid-attribute",validated:t.formState.errors.config?.uuidLDAPAttribute?.[0]?"error":"default",...t.register("config.uuidLDAPAttribute.0",{required:{value:!0,message:`${a("validateUuidLDAPAttribute")}`}})})}),e(i,{label:a("userObjectClasses"),labelIcon:e(l,{helpText:a("userObjectClassesHelp"),fieldLabelId:"userObjectClasses"}),fieldId:"kc-user-object-classes",isRequired:!0,validated:t.formState.errors.config?.userObjectClasses?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.userObjectClasses?.[0].message,children:e(b,{isRequired:!0,defaultValue:"person, organizationalPerson, user",id:"kc-user-object-classes","data-testid":"ldap-user-object-classes",validated:t.formState.errors.config?.userObjectClasses?.[0]?"error":"default",...t.register("config.userObjectClasses.0",{required:{value:!0,message:a("validateUserObjectClasses").toString()}})})}),e(i,{label:a("userLdapFilter"),labelIcon:e(l,{helpText:a("userLdapFilterHelp"),fieldLabelId:"userLdapFilter"}),fieldId:"kc-user-ldap-filter",validated:t.formState.errors.config?.customUserSearchFilter?.[0]?"error":"default",helperTextInvalid:t.formState.errors.config?.customUserSearchFilter?.[0].message,children:e(b,{id:"kc-user-ldap-filter","data-testid":"user-ldap-filter",validated:t.formState.errors.config?.customUserSearchFilter?.[0]?"error":"default",...t.register("config.customUserSearchFilter.0",{pattern:{value:/(\(.*\))$/,message:a("validateCustomUserSearchFilter").toString()}})})}),e(i,{label:a("searchScope"),labelIcon:e(l,{helpText:a("searchScopeHelp"),fieldLabelId:"searchScope"}),fieldId:"kc-search-scope",children:e(g,{name:"config.searchScope[0]",defaultValue:"",control:t.control,render:({field:c})=>u(L,{toggleId:"kc-search-scope",required:!0,onToggle:()=>p(!r),isOpen:r,onSelect:(I,k)=>{c.onChange(k),p(!1)},selections:c.value,variant:V.single,children:[e(h,{value:"1",isPlaceholder:!0,children:a("oneLevel")},0),e(h,{value:"2",children:a("subtree")},1)]})})}),e(i,{label:a("readTimeout"),labelIcon:e(l,{helpText:a("readTimeoutHelp"),fieldLabelId:"readTimeout"}),fieldId:"kc-read-timeout",children:e(b,{type:"number",min:0,id:"kc-read-timeout","data-testid":"ldap-read-timeout",...t.register("config.readTimeout.0")})}),e(i,{label:a("pagination"),labelIcon:e(l,{helpText:a("paginationHelp"),fieldLabelId:"pagination"}),fieldId:"kc-ui-pagination",hasNoPaddingTop:!0,children:e(g,{name:"config.pagination",defaultValue:["false"],control:t.control,render:({field:c})=>e(S,{id:"kc-ui-pagination","data-testid":"ui-pagination",isDisabled:!1,onChange:I=>c.onChange([`${I}`]),isChecked:c.value[0]==="true",label:a("on"),labelOff:a("off"),"aria-label":a("pagination")})})}),e(i,{label:a("referral"),labelIcon:e(l,{helpText:a("referralHelp"),fieldLabelId:"referral"}),fieldId:"kc-referral",children:e(g,{name:"config.referral.0",defaultValue:"",control:t.control,render:({field:c})=>u(L,{toggleId:"kc-referral",onToggle:()=>o(!P),isOpen:P,onSelect:(I,k)=>{c.onChange(k),o(!1)},selections:c.value,variant:V.single,children:[e(h,{value:"ignore",isPlaceholder:!0}),e(h,{value:"follow"})]})})})]})]})},de=({form:t,showSectionHeading:n=!1,showSectionDescription:s=!1})=>{const{t:a}=A(),r=t.watch("config.periodicFullSync",!1),p=t.watch("config.periodicChangedUsersSync",!1);return u(m,{children:[n&&e(w,{title:a("synchronizationSettings"),description:a("ldapSynchronizationSettingsDescription"),showDescription:s}),u(C,{role:"manage-realm",isHorizontal:!0,children:[e(i,{hasNoPaddingTop:!0,label:a("importUsers"),labelIcon:e(l,{helpText:a("importUsersHelp"),fieldLabelId:"importUsers"}),fieldId:"kc-import-users",children:e(g,{name:"config.importEnabled",defaultValue:["true"],control:t.control,render:({field:d})=>e(S,{id:"kc-import-users","data-testid":"import-users",name:"importEnabled",label:a("on"),labelOff:a("off"),onChange:f=>d.onChange([`${f}`]),isChecked:d.value[0]==="true",isDisabled:!1,"aria-label":a("importUsers")})})}),e(i,{hasNoPaddingTop:!0,label:a("syncRegistrations"),labelIcon:e(l,{helpText:a("syncRegistrations"),fieldLabelId:"syncRegistrations"}),fieldId:"syncRegistrations",children:e(g,{name:"config.syncRegistrations",defaultValue:["true"],control:t.control,render:({field:d})=>e(S,{id:"syncRegistrations","data-testid":"syncRegistrations",label:a("on"),labelOff:a("off"),onChange:f=>d.onChange([`${f}`]),isChecked:d.value[0]==="true","aria-label":a("syncRegistrations")})})}),e(i,{label:a("batchSize"),labelIcon:e(l,{helpText:a("batchSizeHelp"),fieldLabelId:"batchSize"}),fieldId:"kc-batch-size",children:e(b,{type:"number",min:0,id:"kc-batch-size","data-testid":"batch-size",...t.register("config.batchSizeForSync.0")})}),e(i,{label:a("periodicFullSync"),labelIcon:e(l,{helpText:a("periodicFullSyncHelp"),fieldLabelId:"periodicFullSync"}),fieldId:"kc-periodic-full-sync",hasNoPaddingTop:!0,children:e(g,{name:"config.periodicFullSync",defaultValue:!1,control:t.control,render:({field:d})=>e(S,{id:"kc-periodic-full-sync","data-testid":"periodic-full-sync",isDisabled:!1,onChange:f=>d.onChange(f),isChecked:d.value===!0,label:a("on"),labelOff:a("off"),"aria-label":a("periodicFullSync")})})}),r&&e(i,{hasNoPaddingTop:!0,label:a("fullSyncPeriod"),labelIcon:e(l,{helpText:a("fullSyncPeriodHelp"),fieldLabelId:"fullSyncPeriod"}),fieldId:"kc-full-sync-period",children:e(b,{type:"number",min:-1,defaultValue:604800,id:"kc-full-sync-period","data-testid":"full-sync-period",...t.register("config.fullSyncPeriod.0")})}),e(i,{label:a("periodicChangedUsersSync"),labelIcon:e(l,{helpText:a("periodicChangedUsersSyncHelp"),fieldLabelId:"periodicChangedUsersSync"}),fieldId:"kc-periodic-changed-users-sync",hasNoPaddingTop:!0,children:e(g,{name:"config.periodicChangedUsersSync",defaultValue:!1,control:t.control,render:({field:d})=>e(S,{id:"kc-periodic-changed-users-sync","data-testid":"periodic-changed-users-sync",isDisabled:!1,onChange:f=>d.onChange(f),isChecked:d.value===!0,label:a("on"),labelOff:a("off"),"aria-label":a("periodicChangedUsersSync")})})}),p&&e(i,{label:a("changedUsersSyncPeriod"),labelIcon:e(l,{helpText:a("changedUsersSyncHelp"),fieldLabelId:"changedUsersSyncPeriod"}),fieldId:"kc-changed-users-sync-period",hasNoPaddingTop:!0,children:e(b,{type:"number",min:-1,defaultValue:86400,id:"kc-changed-users-sync-period","data-testid":"changed-users-sync-period",...t.register("config.changedSyncPeriod.0")})})]})]})},Se=({id:t,onSubmit:n})=>{const{t:s}=A(),a=K(),r=M(),{realm:p}=O(),d=W();return u(m,{children:[e(B,{label:s("jumpToSection"),sections:[{title:s("generalOptions"),panel:e(ie,{form:a,vendorEdit:!!t})},{title:s("connectionAndAuthenticationSettings"),panel:e(te,{form:a,id:t})},{title:s("ldapSearchingAndUpdatingSettings"),panel:e(ne,{form:a})},{title:s("synchronizationSettings"),panel:e(de,{form:a})},{title:s("kerberosIntegration"),panel:e(le,{form:a}),isHidden:!d(Y.Kerberos)},{title:s("cacheSettings"),panel:e(J,{form:a})},{title:s("advancedSettings"),panel:e(re,{form:a,id:t})}]}),e(X,{onSubmit:a.handleSubmit(n),children:e(G,{name:"ldap",isActive:a.formState.isDirty,isSubmit:!0,children:e(x,{variant:"link",onClick:()=>r(_({realm:p})),"data-testid":"ldap-cancel",children:s("cancel")})})})]})};function Ie(t){const{config:n}=t;return n?.periodicChangedUsersSync!==void 0&&(n.periodicChangedUsersSync===!1&&(n.changedSyncPeriod=["-1"]),delete n.periodicChangedUsersSync),n?.periodicFullSync!==void 0&&(n.periodicFullSync===!1&&(n.fullSyncPeriod=["-1"]),delete n.periodicFullSync),t}export{Se as U,Ie as s};
//# sourceMappingURL=UserFederationLdapForm-CxQ1tgUN.js.map
