import{jsxs as c,Fragment as y,jsx as e}from"react/jsx-runtime";import{u as v,Z as b,T as F,a0 as P,a1 as S,f as h,c as k,bs as D,g as E,e as C,b as O,P as A,F as x,h as f,L as w,bY as T,A as L,bZ as U}from"./index-C9t2UlUN.js";import{F as V}from"./FormAccess-DnQCcStE.js";import{V as j}from"./ViewHeader-cxZm8XhN.js";import{D as G,O as H,a as J}from"./OIDCGeneralSettings-DSZraG0A.js";import{J as K}from"./JsonFileUpload-BSVnFg4G.js";import{D as N}from"./DiscoveryEndpointField-Dgm9W27d.js";import{A as z}from"./Form-Cdw1qhWG.js";import"react";import"react-dom";import"./copy-icon-CYSS18Ce.js";import"./ToolbarContent-D6TJq6fk.js";import"./KeycloakTextArea-DChmurIP.js";import"./KeycloakTextInput-DrlF32nr.js";import"./discovery-settings-sewf1As9.js";import"./ExpandableSection-DjAskWMd.js";import"./ClientIdSecret-4ICGdsMs.js";import"./PasswordInput-CJKuHljf.js";import"./DisplayOrder-Dong-iTt.js";import"./FileUploadForm-DmYGfve4.js";import"./FileUpload-CTw4RKK1.js";import"./CodeEditor-Cp4g17EF.js";import"./EmptyStateBody-CyIhnUop.js";import"./EmptyStateSecondaryActions-BekVwNvY.js";import"./Modal-Bgkd26UL.js";const B=()=>{const{t}=v(),l="oidc",{setValue:m,setError:d,clearErrors:s,formState:{errors:o}}=b(),p=r=>{Object.keys(r).map(i=>m(`config.${i}`,r[i]))},u=async r=>{if(s("discoveryError"),!r)return;const i=new FormData;i.append("providerId",l),i.append("file",new Blob([JSON.stringify(r)]));try{const a=await h.identityProviders.importFromUrl(i);p(a)}catch(a){d("discoveryError",{type:"manual",message:a.message})}};return c(y,{children:[e(F,{headingLevel:"h2",size:"xl",className:"kc-form-panel__title",children:t("oidcSettings")}),e(N,{id:"oidc",fileUpload:e(P,{label:t("importConfig"),fieldId:"kc-import-config",labelIcon:e(S,{helpText:t("importConfigHelp"),fieldLabelId:"importConfig"}),validated:o.discoveryError?"error":"default",helperTextInvalid:o.discoveryError?.message,children:e(K,{id:"kc-import-config",helpText:t("identity=providers-help:jsonFileUpload"),hideDefaultPreview:!0,unWrap:!0,validated:o.discoveryError?"error":"default",onChange:r=>u(r)})}),children:r=>e(G,{readOnly:r})})]})};function ye(){const{t}=v(),l=k(),{pathname:m}=D(),d=m.includes("keycloak-oidc"),s=`${d?"keycloak-":""}oidc`,o=E({defaultValues:{alias:s}}),{handleSubmit:p,formState:{isDirty:u}}=o,{addAlert:r,addError:i}=C(),{realm:a}=O(),g=async n=>{delete n.discoveryEndpoint;try{await h.identityProviders.create({...n,providerId:s}),r(t("createIdentityProviderSuccess"),L.success),l(U({realm:a,providerId:s,alias:n.alias,tab:"settings"}))}catch(I){i("createIdentityProviderError",I)}};return c(y,{children:[e(j,{titleKey:t(d?"addKeycloakOpenIdProvider":"addOpenIdProvider")}),e(A,{variant:"light",children:e(x,{...o,children:c(V,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:p(g),children:[e(H,{}),e(B,{}),e(J,{}),c(z,{children:[e(f,{isDisabled:!u,variant:"primary",type:"submit","data-testid":"createProvider",children:t("add")}),e(f,{variant:"link","data-testid":"cancel",component:n=>e(w,{...n,to:T({realm:a})}),children:t("cancel")})]})]})})})]})}export{ye as default};
//# sourceMappingURL=AddOpenIdConnect-D55oX34I.js.map
