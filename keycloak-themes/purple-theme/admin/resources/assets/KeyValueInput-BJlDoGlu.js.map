{"version":3,"file":"KeyValueInput-BJlDoGlu.js","sources":["../../../../node_modules/.pnpm/@patternfly+react-styles@4.92.8/node_modules/@patternfly/react-styles/css/components/HelperText/helper-text.mjs","../../../../node_modules/.pnpm/@patternfly+react-core@4.278.0_react-dom@18.2.0_react@18.2.0/node_modules/@patternfly/react-core/dist/esm/components/HelperText/HelperText.js","../../../../node_modules/.pnpm/@patternfly+react-core@4.278.0_react-dom@18.2.0_react@18.2.0/node_modules/@patternfly/react-core/dist/esm/components/HelperText/HelperTextItem.js","../../src/components/key-value-form/ValueSelect.tsx","../../src/components/key-value-form/KeyValueInput.tsx"],"sourcesContent":["import './helper-text.css';\nexport default {\n  \"helperText\": \"pf-c-helper-text\",\n  \"helperTextItem\": \"pf-c-helper-text__item\",\n  \"helperTextItemIcon\": \"pf-c-helper-text__item-icon\",\n  \"helperTextItemText\": \"pf-c-helper-text__item-text\",\n  \"modifiers\": {\n    \"indeterminate\": \"pf-m-indeterminate\",\n    \"warning\": \"pf-m-warning\",\n    \"success\": \"pf-m-success\",\n    \"error\": \"pf-m-error\",\n    \"dynamic\": \"pf-m-dynamic\"\n  },\n  \"themeDark\": \"pf-theme-dark\"\n};","import { __rest } from \"tslib\";\nimport * as React from 'react';\nimport styles from '@patternfly/react-styles/css/components/HelperText/helper-text';\nimport { css } from '@patternfly/react-styles';\nexport const HelperText = (_a) => {\n    var { children, className, component = 'div', id, isLiveRegion = false } = _a, props = __rest(_a, [\"children\", \"className\", \"component\", \"id\", \"isLiveRegion\"]);\n    const Component = component;\n    return (React.createElement(Component, Object.assign({ id: id, className: css(styles.helperText, className) }, (isLiveRegion && { 'aria-live': 'polite' }), props), children));\n};\nHelperText.displayName = 'HelperText';\n//# sourceMappingURL=HelperText.js.map","import { __rest } from \"tslib\";\nimport * as React from 'react';\nimport styles from '@patternfly/react-styles/css/components/HelperText/helper-text';\nimport { css } from '@patternfly/react-styles';\nimport MinusIcon from '@patternfly/react-icons/dist/esm/icons/minus-icon';\nimport ExclamationTriangleIcon from '@patternfly/react-icons/dist/esm/icons/exclamation-triangle-icon';\nimport CheckCircleIcon from '@patternfly/react-icons/dist/esm/icons/check-circle-icon';\nimport ExclamationCircleIcon from '@patternfly/react-icons/dist/esm/icons/exclamation-circle-icon';\nconst variantStyle = {\n    default: '',\n    indeterminate: styles.modifiers.indeterminate,\n    warning: styles.modifiers.warning,\n    success: styles.modifiers.success,\n    error: styles.modifiers.error\n};\nexport const HelperTextItem = (_a) => {\n    var { children, className, component = 'div', variant = 'default', icon, isDynamic = false, hasIcon = isDynamic, id, screenReaderText = `${variant} status` } = _a, props = __rest(_a, [\"children\", \"className\", \"component\", \"variant\", \"icon\", \"isDynamic\", \"hasIcon\", \"id\", \"screenReaderText\"]);\n    const Component = component;\n    return (React.createElement(Component, Object.assign({ className: css(styles.helperTextItem, variantStyle[variant], isDynamic && styles.modifiers.dynamic, className), id: id }, props),\n        icon && (React.createElement(\"span\", { className: css(styles.helperTextItemIcon), \"aria-hidden\": true }, icon)),\n        hasIcon && !icon && (React.createElement(\"span\", { className: css(styles.helperTextItemIcon), \"aria-hidden\": true },\n            (variant === 'default' || variant === 'indeterminate') && React.createElement(MinusIcon, null),\n            variant === 'warning' && React.createElement(ExclamationTriangleIcon, null),\n            variant === 'success' && React.createElement(CheckCircleIcon, null),\n            variant === 'error' && React.createElement(ExclamationCircleIcon, null))),\n        React.createElement(\"span\", { className: css(styles.helperTextItemText) },\n            children,\n            isDynamic && React.createElement(\"span\", { className: \"pf-u-screen-reader\" },\n                \": \",\n                screenReaderText,\n                \";\"))));\n};\nHelperTextItem.displayName = 'HelperTextItem';\n//# sourceMappingURL=HelperTextItem.js.map","import { Select, SelectOption } from \"@patternfly/react-core\";\nimport { useMemo, useState } from \"react\";\nimport { UseControllerProps, useController } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\nimport { KeycloakTextInput } from \"ui-shared\";\n\nimport { DefaultValue } from \"./KeyValueInput\";\n\ntype ValueSelectProps = UseControllerProps & {\n  selectItems: DefaultValue[];\n  keyValue: string;\n};\n\nexport const ValueSelect = ({\n  selectItems,\n  keyValue,\n  ...rest\n}: ValueSelectProps) => {\n  const { t } = useTranslation();\n  const { field } = useController(rest);\n  const [open, setOpen] = useState(false);\n\n  const defaultItem = useMemo(\n    () => selectItems.find((v) => v.key === keyValue),\n    [selectItems, keyValue],\n  );\n\n  return defaultItem?.values ? (\n    <Select\n      onToggle={(isOpen) => setOpen(isOpen)}\n      isOpen={open}\n      onSelect={(_, value) => {\n        field.onChange(value);\n        setOpen(false);\n      }}\n      selections={field.value ? [field.value] : t(\"choose\")}\n      placeholder={t(\"valuePlaceholder\")}\n    >\n      {defaultItem.values.map((item) => (\n        <SelectOption key={item} value={item} />\n      ))}\n    </Select>\n  ) : (\n    <KeycloakTextInput\n      aria-label={t(\"customValue\")}\n      data-testid={rest.name}\n      {...field}\n    />\n  );\n};\n","import {\n  ActionList,\n  ActionListItem,\n  Button,\n  EmptyState,\n  EmptyStateBody,\n  Grid,\n  GridItem,\n  HelperText,\n  HelperTextItem,\n} from \"@patternfly/react-core\";\nimport { MinusCircleIcon, PlusCircleIcon } from \"@patternfly/react-icons\";\nimport { Fragment } from \"react\";\nimport {\n  FieldValues,\n  useFieldArray,\n  useFormContext,\n  useWatch,\n} from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { KeycloakTextInput } from \"../keycloak-text-input/KeycloakTextInput\";\nimport { KeySelect } from \"./KeySelect\";\nimport { ValueSelect } from \"./ValueSelect\";\n\nexport type DefaultValue = {\n  key: string;\n  values?: string[];\n  label: string;\n};\n\ntype KeyValueInputProps = {\n  name: string;\n  label?: string;\n  defaultKeyValue?: DefaultValue[];\n  isDisabled?: boolean;\n};\n\nexport const KeyValueInput = ({\n  name,\n  label = \"attributes\",\n  defaultKeyValue,\n  isDisabled = false,\n}: KeyValueInputProps) => {\n  const { t } = useTranslation();\n  const {\n    control,\n    register,\n    formState: { errors },\n  } = useFormContext();\n\n  const { fields, append, remove } = useFieldArray({\n    shouldUnregister: true,\n    control,\n    name,\n  });\n\n  const appendNew = () => append({ key: \"\", value: \"\" });\n\n  const values = useWatch<FieldValues>({\n    name,\n    control,\n    defaultValue: [],\n  });\n\n  return fields.length > 0 ? (\n    <>\n      <Grid hasGutter>\n        <GridItem className=\"pf-c-form__label\" span={5}>\n          <span className=\"pf-c-form__label-text\">{t(\"key\")}</span>\n        </GridItem>\n        <GridItem className=\"pf-c-form__label\" span={7}>\n          <span className=\"pf-c-form__label-text\">{t(\"value\")}</span>\n        </GridItem>\n        {fields.map((attribute, index) => {\n          const error = (errors as any)[name]?.[index];\n          const keyError = !!error?.key;\n          const valueErrorPresent = !!error?.value || !!error?.message;\n          const valueError = error?.message || t(\"valueError\");\n          return (\n            <Fragment key={attribute.id}>\n              <GridItem span={5}>\n                {defaultKeyValue ? (\n                  <KeySelect\n                    name={`${name}.${index}.key`}\n                    selectItems={defaultKeyValue}\n                    rules={{ required: true }}\n                  />\n                ) : (\n                  <KeycloakTextInput\n                    placeholder={t(\"keyPlaceholder\")}\n                    aria-label={t(\"key\")}\n                    data-testid={`${name}-key`}\n                    {...register(`${name}.${index}.key`, { required: true })}\n                    validated={keyError ? \"error\" : \"default\"}\n                    isRequired\n                    isDisabled={isDisabled}\n                  />\n                )}\n                {keyError && (\n                  <HelperText>\n                    <HelperTextItem variant=\"error\">\n                      {t(\"keyError\")}\n                    </HelperTextItem>\n                  </HelperText>\n                )}\n              </GridItem>\n              <GridItem span={5}>\n                {defaultKeyValue ? (\n                  <ValueSelect\n                    name={`${name}.${index}.value`}\n                    keyValue={values[index]?.key}\n                    selectItems={defaultKeyValue}\n                    rules={{ required: true }}\n                  />\n                ) : (\n                  <KeycloakTextInput\n                    placeholder={t(\"valuePlaceholder\")}\n                    aria-label={t(\"value\")}\n                    data-testid={`${name}-value`}\n                    {...register(`${name}.${index}.value`, { required: true })}\n                    validated={valueErrorPresent ? \"error\" : \"default\"}\n                    isRequired\n                    isDisabled={isDisabled}\n                  />\n                )}\n                {valueErrorPresent && (\n                  <HelperText>\n                    <HelperTextItem variant=\"error\">\n                      {valueError}\n                    </HelperTextItem>\n                  </HelperText>\n                )}\n              </GridItem>\n              <GridItem span={2}>\n                <Button\n                  variant=\"link\"\n                  title={t(\"removeAttribute\")}\n                  onClick={() => remove(index)}\n                  data-testid={`${name}-remove`}\n                  isDisabled={isDisabled}\n                >\n                  <MinusCircleIcon />\n                </Button>\n              </GridItem>\n            </Fragment>\n          );\n        })}\n      </Grid>\n      <ActionList>\n        <ActionListItem>\n          <Button\n            data-testid={`${name}-add-row`}\n            className=\"pf-u-px-0 pf-u-mt-sm\"\n            variant=\"link\"\n            icon={<PlusCircleIcon />}\n            onClick={appendNew}\n            isDisabled={isDisabled}\n          >\n            {t(\"addAttribute\", { label })}\n          </Button>\n        </ActionListItem>\n      </ActionList>\n    </>\n  ) : (\n    <EmptyState\n      data-testid={`${name}-empty-state`}\n      className=\"pf-u-p-0\"\n      variant=\"xs\"\n    >\n      <EmptyStateBody>{t(\"missingAttributes\", { label })}</EmptyStateBody>\n      <Button\n        data-testid={`${name}-add-row`}\n        variant=\"link\"\n        icon={<PlusCircleIcon />}\n        isSmall\n        onClick={appendNew}\n        isDisabled={isDisabled}\n      >\n        {t(\"addAttribute\", { label })}\n      </Button>\n    </EmptyState>\n  );\n};\n"],"names":["styles","HelperText","_a","children","className","component","id","isLiveRegion","props","__rest","Component","React","css","variantStyle","HelperTextItem","variant","icon","isDynamic","hasIcon","screenReaderText","MinusIcon","ExclamationTriangleIcon","CheckCircleIcon","ExclamationCircleIcon","ValueSelect","selectItems","keyValue","rest","t","useTranslation","field","useController","open","setOpen","useState","defaultItem","useMemo","v","jsx","Select","isOpen","_","value","item","SelectOption","KeycloakTextInput","KeyValueInput","name","label","defaultKeyValue","isDisabled","control","register","errors","useFormContext","fields","append","remove","useFieldArray","appendNew","values","useWatch","jsxs","Fragment","Grid","GridItem","attribute","index","error","keyError","valueErrorPresent","valueError","KeySelect","Button","MinusCircleIcon","ActionList","ActionListItem","PlusCircleIcon","EmptyState","EmptyStateBody"],"mappings":"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","x_google_ignoreList":[0,1,2]}