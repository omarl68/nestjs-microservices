{"version":3,"file":"UsersSection-BDZa1IE6.js","sources":["../../src/user/details/SearchFilter.tsx","../../src/components/users/UserDataTableAttributeSearchForm.tsx","../../src/components/users/UserDataTableToolbarItems.tsx","../../src/components/users/UserDataTable.tsx","../../src/user/UsersSection.tsx"],"sourcesContent":["import { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport {\n  Dropdown,\n  DropdownItem,\n  DropdownToggle,\n  Select,\n  SelectOption,\n  ToolbarItem,\n} from \"@patternfly/react-core\";\nimport { FilterIcon } from \"@patternfly/react-icons\";\n\nexport type SearchType = \"default\" | \"attribute\";\n\ntype SearchToolbarProps = SearchDropdownProps;\n\ntype SearchDropdownProps = {\n  searchType: SearchType;\n  onSelect: (value: SearchType) => void;\n};\n\nexport const SearchDropdown = ({\n  searchType,\n  onSelect,\n}: SearchDropdownProps) => {\n  const { t } = useTranslation();\n  const [searchToggle, setSearchToggle] = useState(false);\n\n  const createDropdown = (searchType: SearchType) => (\n    <DropdownItem\n      key={searchType}\n      onClick={() => {\n        onSelect(searchType);\n        setSearchToggle(false);\n      }}\n    >\n      {t(`searchType.${searchType}`)}\n    </DropdownItem>\n  );\n  const options = [createDropdown(\"default\"), createDropdown(\"attribute\")];\n\n  return (\n    <Dropdown\n      className=\"keycloak__users__searchtype\"\n      toggle={\n        <DropdownToggle id=\"toggle-id\" onToggle={setSearchToggle}>\n          <FilterIcon /> {t(`searchType.${searchType}`)}\n        </DropdownToggle>\n      }\n      isOpen={searchToggle}\n      dropdownItems={options}\n    />\n  );\n};\n\nexport const SearchToolbar = ({ searchType, onSelect }: SearchToolbarProps) => {\n  const { t } = useTranslation();\n  const [open, setOpen] = useState(false);\n\n  return (\n    <>\n      <ToolbarItem>\n        <SearchDropdown searchType={searchType} onSelect={onSelect} />\n      </ToolbarItem>\n      <ToolbarItem>\n        <Select\n          className=\"keycloak__users__searchtype\"\n          onToggle={setOpen}\n          isOpen={open}\n          selections={[t(\"default\"), t(\"attribute\")]}\n          onSelect={() => setOpen(false)}\n        >\n          <SelectOption value={\"default\"}>{t(\"default\")}</SelectOption>\n          <SelectOption value={\"attribute\"}>{t(\"attribute\")}</SelectOption>\n        </Select>\n      </ToolbarItem>\n    </>\n  );\n};\n","import type { UserProfileConfig } from \"@keycloak/keycloak-admin-client/lib/defs/userProfileMetadata\";\nimport {\n  ActionGroup,\n  Alert,\n  AlertVariant,\n  Button,\n  ButtonVariant,\n  InputGroup,\n  Select,\n  SelectOption,\n  SelectVariant,\n  Text,\n  TextContent,\n  TextVariants,\n} from \"@patternfly/react-core\";\nimport { CheckIcon } from \"@patternfly/react-icons\";\nimport { ReactNode, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\nimport { Form } from \"react-router-dom\";\nimport { label } from \"ui-shared\";\n\nimport { useAlerts } from \"../alert/Alerts\";\nimport { KeycloakTextInput } from \"../keycloak-text-input/KeycloakTextInput\";\nimport { UserAttribute } from \"./UserDataTable\";\n\ntype UserDataTableAttributeSearchFormProps = {\n  activeFilters: UserAttribute[];\n  setActiveFilters: (filters: UserAttribute[]) => void;\n  profile: UserProfileConfig;\n  createAttributeSearchChips: () => ReactNode;\n  searchUserWithAttributes: () => void;\n};\n\nexport function UserDataTableAttributeSearchForm({\n  activeFilters,\n  setActiveFilters,\n  profile,\n  createAttributeSearchChips,\n  searchUserWithAttributes,\n}: UserDataTableAttributeSearchFormProps) {\n  const { t } = useTranslation();\n  const { addAlert } = useAlerts();\n  const [selectAttributeKeyOpen, setSelectAttributeKeyOpen] = useState(false);\n\n  const defaultValues: UserAttribute = {\n    name: \"\",\n    displayName: \"\",\n    value: \"\",\n  };\n\n  const {\n    getValues,\n    register,\n    reset,\n    formState: { errors },\n    setValue,\n    setError,\n    clearErrors,\n  } = useForm<UserAttribute>({\n    mode: \"onChange\",\n    defaultValues,\n  });\n\n  const isAttributeKeyDuplicate = () => {\n    return activeFilters.some((filter) => filter.name === getValues().name);\n  };\n\n  const isAttributeNameValid = () => {\n    let valid = false;\n    if (!getValues().name.length) {\n      setError(\"name\", {\n        type: \"empty\",\n        message: t(\"searchUserByAttributeMissingKeyError\"),\n      });\n    } else if (\n      activeFilters.some((filter) => filter.name === getValues().name)\n    ) {\n      setError(\"name\", {\n        type: \"conflict\",\n        message: t(\"searchUserByAttributeKeyAlreadyInUseError\"),\n      });\n    } else {\n      valid = true;\n    }\n    return valid;\n  };\n\n  const isAttributeValueValid = () => {\n    let valid = false;\n    if (!getValues().value.length) {\n      setError(\"value\", {\n        type: \"empty\",\n        message: t(\"searchUserByAttributeMissingValueError\"),\n      });\n    } else {\n      valid = true;\n    }\n    return valid;\n  };\n\n  const isAttributeValid = () =>\n    isAttributeNameValid() && isAttributeValueValid();\n\n  const addToFilter = () => {\n    if (isAttributeValid()) {\n      setActiveFilters([\n        ...activeFilters,\n        {\n          ...getValues(),\n        },\n      ]);\n      reset();\n    } else {\n      errors.name?.message &&\n        addAlert(errors.name.message, AlertVariant.danger);\n      errors.value?.message &&\n        addAlert(errors.value.message, AlertVariant.danger);\n    }\n  };\n\n  const clearActiveFilters = () => {\n    const filtered = [...activeFilters].filter(\n      (chip) => chip.name !== chip.name,\n    );\n    setActiveFilters(filtered);\n  };\n\n  const createAttributeKeyInputField = () => {\n    if (profile) {\n      return (\n        <Select\n          data-testid=\"search-attribute-name\"\n          variant={SelectVariant.typeahead}\n          onToggle={(isOpen) => setSelectAttributeKeyOpen(isOpen)}\n          selections={getValues().displayName}\n          onSelect={(_, selectedValue) => {\n            setValue(\"displayName\", selectedValue.toString());\n            if (isAttributeKeyDuplicate()) {\n              setError(\"name\", { type: \"conflict\" });\n            } else {\n              clearErrors(\"name\");\n            }\n          }}\n          isOpen={selectAttributeKeyOpen}\n          placeholderText={t(\"selectAttribute\")}\n          validated={errors.name && \"error\"}\n          maxHeight={300}\n          {...register(\"displayName\", {\n            required: true,\n            validate: isAttributeNameValid,\n          })}\n        >\n          {profile.attributes?.map((option) => (\n            <SelectOption\n              key={option.name}\n              value={label(t, option.displayName!, option.name)}\n              onClick={(e) => {\n                e.stopPropagation();\n                setSelectAttributeKeyOpen(false);\n                setValue(\"name\", option.name!);\n              }}\n            />\n          ))}\n        </Select>\n      );\n    } else {\n      return (\n        <KeycloakTextInput\n          id=\"name\"\n          placeholder={t(\"keyPlaceholder\")}\n          validated={errors.name && \"error\"}\n          onKeyDown={(e) => e.key === \"Enter\" && addToFilter()}\n          {...register(\"name\", {\n            required: true,\n            validate: isAttributeNameValid,\n          })}\n        />\n      );\n    }\n  };\n\n  return (\n    <Form className=\"user-attribute-search-form\">\n      <TextContent className=\"user-attribute-search-form-headline\">\n        <Text component={TextVariants.h2}>{t(\"selectAttributes\")}</Text>\n      </TextContent>\n      <Alert\n        isInline\n        className=\"user-attribute-search-form-alert\"\n        variant=\"info\"\n        title={t(\"searchUserByAttributeDescription\")}\n        component=\"h3\"\n      />\n      <TextContent className=\"user-attribute-search-form-key-value\">\n        <div className=\"user-attribute-search-form-left\">\n          <Text component={TextVariants.h3}>{t(\"key\")}</Text>\n        </div>\n        <div className=\"user-attribute-search-form-right\">\n          <Text component={TextVariants.h3}>{t(\"value\")}</Text>\n        </div>\n      </TextContent>\n      <div className=\"user-attribute-search-form-left\">\n        {createAttributeKeyInputField()}\n      </div>\n      <div className=\"user-attribute-search-form-right\">\n        <InputGroup>\n          <KeycloakTextInput\n            id=\"value\"\n            placeholder={t(\"valuePlaceholder\")}\n            validated={errors.value && \"error\"}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\") {\n                e.preventDefault();\n                addToFilter();\n              }\n            }}\n            {...register(\"value\", {\n              required: true,\n              validate: isAttributeValueValid,\n            })}\n          />\n          <Button\n            variant=\"control\"\n            icon={<CheckIcon />}\n            onClick={addToFilter}\n            aria-label={t(\"addToFilter\")}\n          />\n        </InputGroup>\n      </div>\n      {createAttributeSearchChips()}\n      <ActionGroup className=\"user-attribute-search-form-action-group\">\n        <Button\n          data-testid=\"search-user-attribute-btn\"\n          variant=\"primary\"\n          type=\"submit\"\n          isDisabled={!activeFilters.length}\n          onClick={searchUserWithAttributes}\n        >\n          {t(\"search\")}\n        </Button>\n        <Button\n          variant={ButtonVariant.link}\n          onClick={() => {\n            reset();\n            clearActiveFilters();\n          }}\n        >\n          {t(\"reset\")}\n        </Button>\n      </ActionGroup>\n    </Form>\n  );\n}\n","import type RealmRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/realmRepresentation\";\nimport type { UserProfileConfig } from \"@keycloak/keycloak-admin-client/lib/defs/userProfileMetadata\";\nimport {\n  Button,\n  ButtonVariant,\n  Dropdown,\n  DropdownItem,\n  InputGroup,\n  KebabToggle,\n  SearchInput,\n  ToolbarItem,\n} from \"@patternfly/react-core\";\nimport { ArrowRightIcon } from \"@patternfly/react-icons\";\nimport { ReactNode, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { useAccess } from \"../../context/access/Access\";\nimport { SearchDropdown, SearchType } from \"../../user/details/SearchFilter\";\nimport { UserAttribute } from \"./UserDataTable\";\nimport { UserDataTableAttributeSearchForm } from \"./UserDataTableAttributeSearchForm\";\nimport DropdownPanel from \"../dropdown-panel/DropdownPanel\";\n\ntype UserDataTableToolbarItemsProps = {\n  searchDropdownOpen: boolean;\n  setSearchDropdownOpen: (open: boolean) => void;\n  realm: RealmRepresentation;\n  hasSelectedRows: boolean;\n  toggleDeleteDialog: () => void;\n  toggleUnlockUsersDialog: () => void;\n  goToCreate: () => void;\n  searchType: SearchType;\n  setSearchType: (searchType: SearchType) => void;\n  searchUser: string;\n  setSearchUser: (searchUser: string) => void;\n  activeFilters: UserAttribute[];\n  setActiveFilters: (activeFilters: UserAttribute[]) => void;\n  refresh: () => void;\n  profile: UserProfileConfig;\n  clearAllFilters: () => void;\n  createAttributeSearchChips: () => ReactNode;\n  searchUserWithAttributes: () => void;\n};\n\nexport function UserDataTableToolbarItems({\n  searchDropdownOpen,\n  setSearchDropdownOpen,\n  realm,\n  hasSelectedRows,\n  toggleDeleteDialog,\n  toggleUnlockUsersDialog,\n  goToCreate,\n  searchType,\n  setSearchType,\n  searchUser,\n  setSearchUser,\n  activeFilters,\n  setActiveFilters,\n  refresh,\n  profile,\n  clearAllFilters,\n  createAttributeSearchChips,\n  searchUserWithAttributes,\n}: UserDataTableToolbarItemsProps) {\n  const { t } = useTranslation();\n  const [kebabOpen, setKebabOpen] = useState(false);\n\n  const { hasAccess } = useAccess();\n\n  // Only needs query-users access to attempt add/delete of users.\n  // This is because the user could have fine-grained access to users\n  // of a group.  There is no way to know this without searching the\n  // permissions of every group.\n  const isManager = hasAccess(\"query-users\");\n\n  const searchItem = () => {\n    return (\n      <ToolbarItem>\n        <InputGroup>\n          <SearchDropdown\n            searchType={searchType}\n            onSelect={(searchType) => {\n              clearAllFilters();\n              setSearchType(searchType);\n            }}\n          />\n          {searchType === \"default\" && defaultSearchInput()}\n          {searchType === \"attribute\" && attributeSearchInput()}\n        </InputGroup>\n      </ToolbarItem>\n    );\n  };\n\n  const defaultSearchInput = () => {\n    return (\n      <ToolbarItem>\n        <SearchInput\n          placeholder={t(\"searchForUser\")}\n          aria-label={t(\"search\")}\n          value={searchUser}\n          onChange={(_, value) => {\n            setSearchUser(value);\n          }}\n          onSearch={() => {\n            setSearchUser(searchUser);\n            refresh();\n          }}\n          onKeyDown={(e) => {\n            if (e.key === \"Enter\") {\n              setSearchUser(searchUser);\n              refresh();\n            }\n          }}\n          onClear={() => {\n            setSearchUser(\"\");\n            refresh();\n          }}\n        />\n      </ToolbarItem>\n    );\n  };\n\n  const attributeSearchInput = () => {\n    return (\n      <>\n        <DropdownPanel\n          buttonText={t(\"selectAttributes\")}\n          setSearchDropdownOpen={setSearchDropdownOpen}\n          searchDropdownOpen={searchDropdownOpen}\n          width=\"15vw\"\n        >\n          <UserDataTableAttributeSearchForm\n            activeFilters={activeFilters}\n            setActiveFilters={setActiveFilters}\n            profile={profile}\n            createAttributeSearchChips={createAttributeSearchChips}\n            searchUserWithAttributes={() => {\n              searchUserWithAttributes();\n              setSearchDropdownOpen(false);\n            }}\n          />\n        </DropdownPanel>\n        <Button\n          icon={<ArrowRightIcon />}\n          variant=\"control\"\n          onClick={() => {\n            searchUserWithAttributes();\n            setSearchDropdownOpen(false);\n          }}\n          aria-label={t(\"searchAttributes\")}\n        />\n      </>\n    );\n  };\n\n  const bruteForceProtectionToolbarItem = !realm.bruteForceProtected ? (\n    <ToolbarItem>\n      <Button\n        variant={ButtonVariant.link}\n        onClick={toggleDeleteDialog}\n        data-testid=\"delete-user-btn\"\n        isDisabled={hasSelectedRows}\n      >\n        {t(\"deleteUser\")}\n      </Button>\n    </ToolbarItem>\n  ) : (\n    <ToolbarItem>\n      <Dropdown\n        toggle={<KebabToggle onToggle={(open) => setKebabOpen(open)} />}\n        isOpen={kebabOpen}\n        isPlain\n        dropdownItems={[\n          <DropdownItem\n            key=\"deleteUser\"\n            component=\"button\"\n            isDisabled={hasSelectedRows}\n            onClick={() => {\n              toggleDeleteDialog();\n              setKebabOpen(false);\n            }}\n          >\n            {t(\"deleteUser\")}\n          </DropdownItem>,\n\n          <DropdownItem\n            key=\"unlock\"\n            component=\"button\"\n            onClick={() => {\n              toggleUnlockUsersDialog();\n              setKebabOpen(false);\n            }}\n          >\n            {t(\"unlockAllUsers\")}\n          </DropdownItem>,\n        ]}\n      />\n    </ToolbarItem>\n  );\n\n  const actionItems = (\n    <>\n      <ToolbarItem>\n        <Button data-testid=\"add-user\" onClick={goToCreate}>\n          {t(\"addUser\")}\n        </Button>\n      </ToolbarItem>\n      {bruteForceProtectionToolbarItem}\n    </>\n  );\n\n  return (\n    <>\n      {searchItem()}\n      {isManager ? actionItems : null}\n    </>\n  );\n}\n","import type ComponentRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/componentRepresentation\";\nimport type RealmRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/realmRepresentation\";\nimport type { UserProfileConfig } from \"@keycloak/keycloak-admin-client/lib/defs/userProfileMetadata\";\nimport type UserRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/userRepresentation\";\nimport {\n  AlertVariant,\n  Button,\n  ButtonVariant,\n  Chip,\n  ChipGroup,\n  EmptyState,\n  FlexItem,\n  Label,\n  Text,\n  TextContent,\n  Toolbar,\n  ToolbarContent,\n  ToolbarItem,\n  Tooltip,\n} from \"@patternfly/react-core\";\nimport {\n  ExclamationCircleIcon,\n  InfoCircleIcon,\n  WarningTriangleIcon,\n} from \"@patternfly/react-icons\";\nimport type { IRowData } from \"@patternfly/react-table\";\nimport { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link, useNavigate } from \"react-router-dom\";\n\nimport { adminClient } from \"../../admin-client\";\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\nimport { SearchType } from \"../../user/details/SearchFilter\";\nimport { toAddUser } from \"../../user/routes/AddUser\";\nimport { toUser } from \"../../user/routes/User\";\nimport { emptyFormatter } from \"../../util\";\nimport { useFetch } from \"../../utils/useFetch\";\nimport { useAlerts } from \"../alert/Alerts\";\nimport { useConfirmDialog } from \"../confirm-dialog/ConfirmDialog\";\nimport { KeycloakSpinner } from \"../keycloak-spinner/KeycloakSpinner\";\nimport { ListEmptyState } from \"../list-empty-state/ListEmptyState\";\nimport { BruteUser, findUsers } from \"../role-mapping/resource\";\nimport { KeycloakDataTable } from \"../table-toolbar/KeycloakDataTable\";\nimport { UserDataTableToolbarItems } from \"./UserDataTableToolbarItems\";\n\nexport type UserAttribute = {\n  name: string;\n  displayName: string;\n  value: string;\n};\n\nconst UserDetailLink = (user: BruteUser) => {\n  const { realm } = useRealm();\n  return (\n    <Link to={toUser({ realm, id: user.id!, tab: \"settings\" })}>\n      {user.username} <StatusRow user={user} />\n    </Link>\n  );\n};\n\ntype StatusRowProps = {\n  user: BruteUser;\n};\n\nconst StatusRow = ({ user }: StatusRowProps) => {\n  const { t } = useTranslation();\n  return (\n    <>\n      {!user.enabled && (\n        <Label color=\"red\" icon={<InfoCircleIcon />}>\n          {t(\"disabled\")}\n        </Label>\n      )}\n      {user.bruteForceStatus?.disabled && (\n        <Label color=\"orange\" icon={<WarningTriangleIcon />}>\n          {t(\"temporaryLocked\")}\n        </Label>\n      )}\n    </>\n  );\n};\n\nconst ValidatedEmail = (user: UserRepresentation) => {\n  const { t } = useTranslation();\n  return (\n    <>\n      {!user.emailVerified && (\n        <Tooltip content={t(\"notVerified\")}>\n          <ExclamationCircleIcon className=\"keycloak__user-section__email-verified\" />\n        </Tooltip>\n      )}{\" \"}\n      {emptyFormatter()(user.email)}\n    </>\n  );\n};\n\nexport function UserDataTable() {\n  const { t } = useTranslation();\n  const { addAlert, addError } = useAlerts();\n  const { realm: realmName } = useRealm();\n  const navigate = useNavigate();\n  const [userStorage, setUserStorage] = useState<ComponentRepresentation[]>();\n  const [searchUser, setSearchUser] = useState(\"\");\n  const [realm, setRealm] = useState<RealmRepresentation | undefined>();\n  const [selectedRows, setSelectedRows] = useState<UserRepresentation[]>([]);\n  const [searchType, setSearchType] = useState<SearchType>(\"default\");\n  const [searchDropdownOpen, setSearchDropdownOpen] = useState(false);\n  const [activeFilters, setActiveFilters] = useState<UserAttribute[]>([]);\n  const [profile, setProfile] = useState<UserProfileConfig>({});\n  const [query, setQuery] = useState(\"\");\n\n  const [key, setKey] = useState(0);\n  const refresh = () => setKey(key + 1);\n\n  useFetch(\n    async () => {\n      const testParams = {\n        type: \"org.keycloak.storage.UserStorageProvider\",\n      };\n\n      try {\n        return await Promise.all([\n          adminClient.components.find(testParams),\n          adminClient.realms.findOne({ realm: realmName }),\n          adminClient.users.getProfile(),\n        ]);\n      } catch {\n        return [[], {}, {}] as [\n          ComponentRepresentation[],\n          RealmRepresentation | undefined,\n          UserProfileConfig,\n        ];\n      }\n    },\n    ([storageProviders, realm, profile]) => {\n      setUserStorage(\n        storageProviders.filter((p) => p.config?.enabled?.[0] === \"true\"),\n      );\n      setRealm(realm);\n      setProfile(profile);\n    },\n    [],\n  );\n\n  const loader = async (first?: number, max?: number, search?: string) => {\n    const params: { [name: string]: string | number } = {\n      first: first!,\n      max: max!,\n      q: query!,\n    };\n\n    const searchParam = search || searchUser || \"\";\n    if (searchParam) {\n      params.search = searchParam;\n    }\n\n    if (!listUsers && !(params.search || params.q)) {\n      return [];\n    }\n\n    try {\n      return await findUsers({\n        briefRepresentation: true,\n        ...params,\n      });\n    } catch (error) {\n      if (userStorage?.length) {\n        addError(\"noUsersFoundErrorStorage\", error);\n      } else {\n        addError(\"noUsersFoundError\", error);\n      }\n      return [];\n    }\n  };\n\n  const [toggleUnlockUsersDialog, UnlockUsersConfirm] = useConfirmDialog({\n    titleKey: \"unlockAllUsers\",\n    messageKey: \"unlockUsersConfirm\",\n    continueButtonLabel: \"unlock\",\n    onConfirm: async () => {\n      try {\n        await adminClient.attackDetection.delAll();\n        refresh();\n        addAlert(t(\"unlockUsersSuccess\"), AlertVariant.success);\n      } catch (error) {\n        addError(\"unlockUsersError\", error);\n      }\n    },\n  });\n\n  const [toggleDeleteDialog, DeleteConfirm] = useConfirmDialog({\n    titleKey: \"deleteConfirmUsers\",\n    messageKey: t(\"deleteConfirmDialog\", { count: selectedRows.length }),\n    continueButtonLabel: \"delete\",\n    continueButtonVariant: ButtonVariant.danger,\n    onConfirm: async () => {\n      try {\n        for (const user of selectedRows) {\n          await adminClient.users.del({ id: user.id! });\n        }\n        setSelectedRows([]);\n        clearAllFilters();\n        addAlert(t(\"userDeletedSuccess\"), AlertVariant.success);\n      } catch (error) {\n        addError(\"userDeletedError\", error);\n      }\n    },\n  });\n\n  const goToCreate = () => navigate(toAddUser({ realm: realmName }));\n\n  if (!userStorage || !realm) {\n    return <KeycloakSpinner />;\n  }\n\n  //should *only* list users when no user federation is configured\n  const listUsers = !(userStorage.length > 0);\n\n  const clearAllFilters = () => {\n    const filtered = [...activeFilters].filter(\n      (chip) => chip.name !== chip.name,\n    );\n    setActiveFilters(filtered);\n    setSearchUser(\"\");\n    setQuery(\"\");\n    refresh();\n  };\n\n  const createQueryString = (filters: UserAttribute[]) => {\n    return filters.map((filter) => `${filter.name}:${filter.value}`).join(\" \");\n  };\n\n  const searchUserWithAttributes = () => {\n    const attributes = createQueryString(activeFilters);\n    setQuery(attributes);\n    refresh();\n  };\n\n  const createAttributeSearchChips = () => {\n    return (\n      <FlexItem>\n        {activeFilters.length > 0 && (\n          <>\n            {Object.values(activeFilters).map((entry) => {\n              return (\n                <ChipGroup\n                  className=\"pf-u-mt-md pf-u-mr-md\"\n                  key={entry.name}\n                  categoryName={\n                    entry.displayName.length ? entry.displayName : entry.name\n                  }\n                  isClosable\n                  onClick={(event) => {\n                    event.stopPropagation();\n\n                    const filtered = [...activeFilters].filter(\n                      (chip) => chip.name !== entry.name,\n                    );\n                    const attributes = createQueryString(filtered);\n\n                    setActiveFilters(filtered);\n                    setQuery(attributes);\n                    refresh();\n                  }}\n                >\n                  <Chip key={entry.name} isReadOnly>\n                    {entry.value}\n                  </Chip>\n                </ChipGroup>\n              );\n            })}\n          </>\n        )}\n      </FlexItem>\n    );\n  };\n\n  const toolbar = () => {\n    return (\n      <UserDataTableToolbarItems\n        searchDropdownOpen={searchDropdownOpen}\n        setSearchDropdownOpen={setSearchDropdownOpen}\n        realm={realm}\n        hasSelectedRows={selectedRows.length === 0}\n        toggleDeleteDialog={toggleDeleteDialog}\n        toggleUnlockUsersDialog={toggleUnlockUsersDialog}\n        goToCreate={goToCreate}\n        searchType={searchType}\n        setSearchType={setSearchType}\n        searchUser={searchUser}\n        setSearchUser={setSearchUser}\n        activeFilters={activeFilters}\n        setActiveFilters={setActiveFilters}\n        refresh={refresh}\n        profile={profile}\n        clearAllFilters={clearAllFilters}\n        createAttributeSearchChips={createAttributeSearchChips}\n        searchUserWithAttributes={searchUserWithAttributes}\n      />\n    );\n  };\n\n  const subtoolbar = () => {\n    if (!activeFilters.length) {\n      return;\n    }\n    return (\n      <div className=\"user-attribute-search-form-subtoolbar\">\n        <ToolbarItem>{createAttributeSearchChips()}</ToolbarItem>\n        <ToolbarItem>\n          <Button\n            variant=\"link\"\n            onClick={() => {\n              clearAllFilters();\n            }}\n          >\n            {t(\"clearAllFilters\")}\n          </Button>\n        </ToolbarItem>\n      </div>\n    );\n  };\n\n  return (\n    <>\n      <DeleteConfirm />\n      <UnlockUsersConfirm />\n      <KeycloakDataTable\n        isSearching={searchUser !== \"\" || activeFilters.length !== 0}\n        key={key}\n        loader={loader}\n        isPaginated\n        ariaLabelKey=\"titleUsers\"\n        canSelectAll\n        onSelect={(rows: UserRepresentation[]) => setSelectedRows([...rows])}\n        emptyState={\n          !listUsers ? (\n            <>\n              <Toolbar>\n                <ToolbarContent>{toolbar()}</ToolbarContent>\n              </Toolbar>\n              <EmptyState data-testid=\"empty-state\" variant=\"large\">\n                <TextContent className=\"kc-search-users-text\">\n                  <Text>{t(\"searchForUserDescription\")}</Text>\n                </TextContent>\n              </EmptyState>\n            </>\n          ) : (\n            <ListEmptyState\n              message={t(\"noUsersFound\")}\n              instructions={t(\"emptyInstructions\")}\n              primaryActionText={t(\"createNewUser\")}\n              onPrimaryAction={goToCreate}\n            />\n          )\n        }\n        toolbarItem={toolbar()}\n        subToolbar={subtoolbar()}\n        actionResolver={(rowData: IRowData) => {\n          const user: UserRepresentation = rowData.data;\n          if (!user.access?.manage) return [];\n\n          return [\n            {\n              title: t(\"delete\"),\n              onClick: () => {\n                setSelectedRows([user]);\n                toggleDeleteDialog();\n              },\n            },\n          ];\n        }}\n        columns={[\n          {\n            name: \"username\",\n            displayKey: \"username\",\n            cellRenderer: UserDetailLink,\n          },\n          {\n            name: \"email\",\n            displayKey: \"email\",\n            cellRenderer: ValidatedEmail,\n          },\n          {\n            name: \"lastName\",\n            displayKey: \"lastName\",\n            cellFormatters: [emptyFormatter()],\n          },\n          {\n            name: \"firstName\",\n            displayKey: \"firstName\",\n            cellFormatters: [emptyFormatter()],\n          },\n        ]}\n      />\n    </>\n  );\n}\n","import { useTranslation } from \"react-i18next\";\nimport { PageSection, Tab, TabTitleText } from \"@patternfly/react-core\";\n\nimport { ViewHeader } from \"../components/view-header/ViewHeader\";\nimport { useRealm } from \"../context/realm-context/RealmContext\";\nimport helpUrls from \"../help-urls\";\nimport { PermissionsTab } from \"../components/permission-tab/PermissionTab\";\nimport { UserDataTable } from \"../components/users/UserDataTable\";\nimport { toUsers, UserTab } from \"./routes/Users\";\nimport {\n  RoutableTabs,\n  useRoutableTab,\n} from \"../components/routable-tabs/RoutableTabs\";\nimport useIsFeatureEnabled, { Feature } from \"../utils/useIsFeatureEnabled\";\nimport \"./user-section.css\";\nimport { useAccess } from \"../context/access/Access\";\n\nexport default function UsersSection() {\n  const { t } = useTranslation();\n  const { realm: realmName } = useRealm();\n  const { hasAccess } = useAccess();\n  const isFeatureEnabled = useIsFeatureEnabled();\n\n  const canViewPermissions =\n    isFeatureEnabled(Feature.AdminFineGrainedAuthz) &&\n    hasAccess(\"manage-authorization\", \"manage-users\", \"manage-clients\");\n\n  const useTab = (tab: UserTab) =>\n    useRoutableTab(\n      toUsers({\n        realm: realmName,\n        tab,\n      }),\n    );\n\n  const listTab = useTab(\"list\");\n  const permissionsTab = useTab(\"permissions\");\n\n  return (\n    <>\n      <ViewHeader\n        titleKey=\"titleUsers\"\n        subKey=\"usersExplain\"\n        helpUrl={helpUrls.usersUrl}\n        divider={false}\n      />\n      <PageSection\n        data-testid=\"users-page\"\n        variant=\"light\"\n        className=\"pf-u-p-0\"\n      >\n        <RoutableTabs\n          data-testid=\"user-tabs\"\n          defaultLocation={toUsers({\n            realm: realmName,\n            tab: \"list\",\n          })}\n          isBox\n          mountOnEnter\n        >\n          <Tab\n            id=\"list\"\n            data-testid=\"listTab\"\n            title={<TabTitleText>{t(\"userList\")}</TabTitleText>}\n            {...listTab}\n          >\n            <UserDataTable />\n          </Tab>\n          {canViewPermissions && (\n            <Tab\n              id=\"permissions\"\n              data-testid=\"permissionsTab\"\n              title={<TabTitleText>{t(\"permissions\")}</TabTitleText>}\n              {...permissionsTab}\n            >\n              <PermissionsTab type=\"users\" />\n            </Tab>\n          )}\n        </RoutableTabs>\n      </PageSection>\n    </>\n  );\n}\n"],"names":["SearchDropdown","searchType","onSelect","t","useTranslation","searchToggle","setSearchToggle","useState","createDropdown","jsx","DropdownItem","options","Dropdown","jsxs","DropdownToggle","FilterIcon","UserDataTableAttributeSearchForm","activeFilters","setActiveFilters","profile","createAttributeSearchChips","searchUserWithAttributes","addAlert","useAlerts","selectAttributeKeyOpen","setSelectAttributeKeyOpen","defaultValues","getValues","register","reset","errors","setValue","setError","clearErrors","useForm","isAttributeKeyDuplicate","filter","isAttributeNameValid","valid","isAttributeValueValid","isAttributeValid","addToFilter","AlertVariant","clearActiveFilters","filtered","chip","createAttributeKeyInputField","Select","SelectVariant","isOpen","_","selectedValue","option","SelectOption","label","e","KeycloakTextInput","Form","TextContent","Text","TextVariants","Alert","InputGroup","Button","CheckIcon","ActionGroup","ButtonVariant","UserDataTableToolbarItems","searchDropdownOpen","setSearchDropdownOpen","realm","hasSelectedRows","toggleDeleteDialog","toggleUnlockUsersDialog","goToCreate","setSearchType","searchUser","setSearchUser","refresh","clearAllFilters","kebabOpen","setKebabOpen","hasAccess","useAccess","isManager","searchItem","ToolbarItem","defaultSearchInput","attributeSearchInput","SearchInput","value","Fragment","DropdownPanel","ArrowRightIcon","bruteForceProtectionToolbarItem","KebabToggle","open","actionItems","UserDetailLink","user","useRealm","Link","toUser","StatusRow","Label","InfoCircleIcon","WarningTriangleIcon","ValidatedEmail","Tooltip","ExclamationCircleIcon","emptyFormatter","UserDataTable","addError","realmName","navigate","useNavigate","userStorage","setUserStorage","setRealm","selectedRows","setSelectedRows","setProfile","query","setQuery","key","setKey","useFetch","testParams","adminClient","storageProviders","p","loader","first","max","search","params","searchParam","listUsers","findUsers","error","UnlockUsersConfirm","useConfirmDialog","DeleteConfirm","toAddUser","KeycloakSpinner","createQueryString","filters","attributes","FlexItem","entry","ChipGroup","event","Chip","toolbar","subtoolbar","KeycloakDataTable","rows","ListEmptyState","Toolbar","ToolbarContent","EmptyState","rowData","UsersSection","canViewPermissions","useIsFeatureEnabled","Feature","useTab","tab","useRoutableTab","toUsers","listTab","permissionsTab","ViewHeader","helpUrls","PageSection","RoutableTabs","Tab","TabTitleText","PermissionsTab"],"mappings":"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"}