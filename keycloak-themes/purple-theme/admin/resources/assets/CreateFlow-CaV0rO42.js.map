{"version":3,"file":"CreateFlow-CaV0rO42.js","sources":["../../src/authentication/form/CreateFlow.tsx"],"sourcesContent":["import type AuthenticationFlowRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/authenticationFlowRepresentation\";\nimport {\n  ActionGroup,\n  AlertVariant,\n  Button,\n  PageSection,\n} from \"@patternfly/react-core\";\nimport { FormProvider, useForm } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link, useNavigate } from \"react-router-dom\";\n\nimport { SelectControl } from \"ui-shared\";\nimport { adminClient } from \"../../admin-client\";\nimport { useAlerts } from \"../../components/alert/Alerts\";\nimport { FormAccess } from \"../../components/form/FormAccess\";\nimport { ViewHeader } from \"../../components/view-header/ViewHeader\";\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\nimport { toAuthentication } from \"../routes/Authentication\";\nimport { toFlow } from \"../routes/Flow\";\nimport { NameDescription } from \"./NameDescription\";\n\nconst TYPES = [\"basic-flow\", \"client-flow\"] as const;\n\nexport default function CreateFlow() {\n  const { t } = useTranslation();\n  const navigate = useNavigate();\n  const { realm } = useRealm();\n  const { addAlert } = useAlerts();\n  const form = useForm<AuthenticationFlowRepresentation>();\n  const { handleSubmit } = form;\n\n  const onSubmit = async (formValues: AuthenticationFlowRepresentation) => {\n    const flow = { ...formValues, builtIn: false, topLevel: true };\n\n    try {\n      const { id } =\n        await adminClient.authenticationManagement.createFlow(flow);\n      addAlert(t(\"flowCreatedSuccess\"), AlertVariant.success);\n      navigate(\n        toFlow({\n          realm,\n          id: id!,\n          usedBy: \"notInUse\",\n        }),\n      );\n    } catch (error: any) {\n      addAlert(\n        t(\"flowCreateError\", {\n          error: error.response?.data?.errorMessage || error,\n        }),\n        AlertVariant.danger,\n      );\n    }\n  };\n\n  return (\n    <>\n      <ViewHeader titleKey=\"createFlow\" subKey=\"authenticationCreateFlowHelp\" />\n      <PageSection variant=\"light\">\n        <FormProvider {...form}>\n          <FormAccess\n            isHorizontal\n            role=\"manage-authorization\"\n            onSubmit={handleSubmit(onSubmit)}\n          >\n            <NameDescription />\n            <SelectControl\n              name=\"providerId\"\n              label={t(\"flowType\")}\n              labelIcon={t(\"topLevelFlowTypeHelp\")}\n              aria-label={t(\"selectFlowType\")}\n              controller={{ defaultValue: TYPES[0] }}\n              options={TYPES.map((type) => ({\n                key: type,\n                value: t(`top-level-flow-type.${type}`),\n              }))}\n            />\n            <ActionGroup>\n              <Button data-testid=\"create\" type=\"submit\">\n                {t(\"create\")}\n              </Button>\n              <Button\n                data-testid=\"cancel\"\n                variant=\"link\"\n                component={(props) => (\n                  <Link {...props} to={toAuthentication({ realm })}></Link>\n                )}\n              >\n                {t(\"cancel\")}\n              </Button>\n            </ActionGroup>\n          </FormAccess>\n        </FormProvider>\n      </PageSection>\n    </>\n  );\n}\n"],"names":["TYPES","CreateFlow","t","useTranslation","navigate","useNavigate","realm","useRealm","addAlert","useAlerts","form","useForm","handleSubmit","jsxs","Fragment","jsx","ViewHeader","PageSection","FormProvider","FormAccess","formValues","flow","id","adminClient","AlertVariant","toFlow","error","NameDescription","SelectControl","type","ActionGroup","Button","props","Link","toAuthentication"],"mappings":"sdAqBA,MAAMA,EAAQ,CAAC,aAAc,aAAa,EAE1C,SAAwBC,GAAa,CAC7B,KAAA,CAAE,EAAAC,GAAMC,IACRC,EAAWC,IACX,CAAE,MAAAC,GAAUC,IACZ,CAAE,SAAAC,GAAaC,IACfC,EAAOC,IACP,CAAE,aAAAC,CAAiB,EAAAF,EA0BzB,OAEIG,EAAAC,EAAA,CAAA,SAAA,CAAAC,EAACC,EAAW,CAAA,SAAS,aAAa,OAAO,+BAA+B,IACvEC,EAAY,CAAA,QAAQ,QACnB,SAACF,EAAAG,EAAA,CAAc,GAAGR,EAChB,SAAAG,EAACM,EAAA,CACC,aAAY,GACZ,KAAK,uBACL,SAAUP,EAhCH,MAAOQ,GAAiD,CACvE,MAAMC,EAAO,CAAE,GAAGD,EAAY,QAAS,GAAO,SAAU,IAEpD,GAAA,CACF,KAAM,CAAE,GAAAE,CAAG,EACT,MAAMC,EAAY,yBAAyB,WAAWF,CAAI,EAC5Db,EAASN,EAAE,oBAAoB,EAAGsB,EAAa,OAAO,EACtDpB,EACEqB,EAAO,CACL,MAAAnB,EACA,GAAAgB,EACA,OAAQ,UAAA,CACT,CAAA,QAEII,EAAY,CACnBlB,EACEN,EAAE,kBAAmB,CACnB,MAAOwB,EAAM,UAAU,MAAM,cAAgBA,CAAA,CAC9C,EACDF,EAAa,MAAA,CAEjB,CAAA,CAWuC,EAE/B,SAAA,CAAAT,EAACY,EAAgB,EAAA,EACjBZ,EAACa,EAAA,CACC,KAAK,aACL,MAAO1B,EAAE,UAAU,EACnB,UAAWA,EAAE,sBAAsB,EACnC,aAAYA,EAAE,gBAAgB,EAC9B,WAAY,CAAE,aAAcF,EAAM,CAAC,CAAE,EACrC,QAASA,EAAM,IAAK6B,IAAU,CAC5B,IAAKA,EACL,MAAO3B,EAAE,uBAAuB2B,CAAI,EAAE,CAAA,EACtC,CAAA,CACJ,IACCC,EACC,CAAA,SAAA,CAAAf,EAACgB,GAAO,cAAY,SAAS,KAAK,SAC/B,SAAA7B,EAAE,QAAQ,EACb,EACAa,EAACgB,EAAA,CACC,cAAY,SACZ,QAAQ,OACR,UAAYC,GACVjB,EAACkB,EAAM,CAAA,GAAGD,EAAO,GAAIE,EAAiB,CAAE,MAAA5B,CAAM,CAAC,CAAG,CAAA,EAGnD,WAAE,QAAQ,CAAA,CACb,CAAA,EACF,CAAA,CAAA,GAEJ,CACF,CAAA,CACF,CAAA,CAAA,CAEJ"}