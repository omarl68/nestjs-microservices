{"version":3,"file":"CreateInitialAccessToken-DoRD4Zpe.js","sources":["../../src/clients/initial-access/AccessTokenDialog.tsx","../../src/clients/initial-access/CreateInitialAccessToken.tsx"],"sourcesContent":["import { useTranslation } from \"react-i18next\";\nimport {\n  Alert,\n  AlertVariant,\n  ClipboardCopy,\n  Form,\n  FormGroup,\n  Modal,\n  ModalVariant,\n} from \"@patternfly/react-core\";\n\ntype AccessTokenDialogProps = {\n  token: string;\n  toggleDialog: () => void;\n};\n\nexport const AccessTokenDialog = ({\n  token,\n  toggleDialog,\n}: AccessTokenDialogProps) => {\n  const { t } = useTranslation();\n  return (\n    <Modal\n      title={t(\"initialAccessTokenDetails\")}\n      isOpen={true}\n      onClose={toggleDialog}\n      variant={ModalVariant.medium}\n    >\n      <Alert\n        title={t(\"copyInitialAccessToken\")}\n        titleHeadingLevel=\"h2\"\n        isInline\n        variant={AlertVariant.warning}\n      />\n      <Form className=\"pf-u-mt-md\">\n        <FormGroup label={t(\"initialAccessToken\")} fieldId=\"initialAccessToken\">\n          <ClipboardCopy id=\"initialAccessToken\" isReadOnly>\n            {token}\n          </ClipboardCopy>\n        </FormGroup>\n      </Form>\n    </Modal>\n  );\n};\n","import type ClientInitialAccessPresentation from \"@keycloak/keycloak-admin-client/lib/defs/clientInitialAccessPresentation\";\nimport {\n  ActionGroup,\n  AlertVariant,\n  Button,\n  FormGroup,\n  NumberInput,\n  PageSection,\n} from \"@patternfly/react-core\";\nimport { useState } from \"react\";\nimport { Controller, useForm } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { FormAccess } from \"../../components/form/FormAccess\";\nimport { ViewHeader } from \"../../components/view-header/ViewHeader\";\nimport { HelpItem } from \"ui-shared\";\nimport { TimeSelector } from \"../../components/time-selector/TimeSelector\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { adminClient } from \"../../admin-client\";\nimport { useAlerts } from \"../../components/alert/Alerts\";\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\nimport { toClients } from \"../routes/Clients\";\nimport { AccessTokenDialog } from \"./AccessTokenDialog\";\n\nexport default function CreateInitialAccessToken() {\n  const { t } = useTranslation();\n  const {\n    handleSubmit,\n    control,\n    formState: { isValid, errors },\n  } = useForm({ mode: \"onChange\" });\n\n  const { realm } = useRealm();\n  const { addAlert, addError } = useAlerts();\n\n  const navigate = useNavigate();\n  const [token, setToken] = useState(\"\");\n\n  const save = async (clientToken: ClientInitialAccessPresentation) => {\n    try {\n      const access = await adminClient.realms.createClientsInitialAccess(\n        { realm },\n        clientToken,\n      );\n      setToken(access.token!);\n    } catch (error) {\n      addError(\"tokenSaveError\", error);\n    }\n  };\n\n  return (\n    <>\n      {token && (\n        <AccessTokenDialog\n          token={token}\n          toggleDialog={() => {\n            setToken(\"\");\n            addAlert(t(\"tokenSaveSuccess\"), AlertVariant.success);\n            navigate(toClients({ realm, tab: \"initial-access-token\" }));\n          }}\n        />\n      )}\n      <ViewHeader titleKey=\"createToken\" subKey=\"createTokenHelp\" />\n      <PageSection variant=\"light\">\n        <FormAccess\n          isHorizontal\n          role=\"create-client\"\n          onSubmit={handleSubmit(save)}\n        >\n          <FormGroup\n            label={t(\"expiration\")}\n            fieldId=\"expiration\"\n            labelIcon={\n              <HelpItem\n                helpText={t(\"tokenExpirationHelp\")}\n                fieldLabelId=\"expiration\"\n              />\n            }\n            helperTextInvalid={t(\"expirationValueNotValid\")}\n            validated={errors.expiration ? \"error\" : \"default\"}\n          >\n            <Controller\n              name=\"expiration\"\n              defaultValue={86400}\n              control={control}\n              rules={{ min: 1 }}\n              render={({ field }) => (\n                <TimeSelector\n                  data-testid=\"expiration\"\n                  value={field.value}\n                  onChange={field.onChange}\n                  min={1}\n                  validated={errors.expiration ? \"error\" : \"default\"}\n                />\n              )}\n            />\n          </FormGroup>\n          <FormGroup\n            label={t(\"count\")}\n            fieldId=\"count\"\n            labelIcon={\n              <HelpItem helpText={t(\"countHelp\")} fieldLabelId=\"count\" />\n            }\n          >\n            <Controller\n              name=\"count\"\n              defaultValue={1}\n              control={control}\n              render={({ field }) => (\n                <NumberInput\n                  data-testid=\"count\"\n                  inputName=\"count\"\n                  inputAriaLabel={t(\"count\")}\n                  min={1}\n                  value={field.value}\n                  onPlus={() => field.onChange(field.value + 1)}\n                  onMinus={() => field.onChange(field.value - 1)}\n                  onChange={(event) => {\n                    const value = Number(\n                      (event.target as HTMLInputElement).value,\n                    );\n                    field.onChange(value < 1 ? 1 : value);\n                  }}\n                />\n              )}\n            />\n          </FormGroup>\n          <ActionGroup>\n            <Button\n              variant=\"primary\"\n              type=\"submit\"\n              data-testid=\"save\"\n              isDisabled={!isValid}\n            >\n              {t(\"save\")}\n            </Button>\n            <Button\n              data-testid=\"cancel\"\n              variant=\"link\"\n              component={(props) => (\n                <Link\n                  {...props}\n                  to={toClients({ realm, tab: \"initial-access-token\" })}\n                />\n              )}\n            >\n              {t(\"cancel\")}\n            </Button>\n          </ActionGroup>\n        </FormAccess>\n      </PageSection>\n    </>\n  );\n}\n"],"names":["AccessTokenDialog","token","toggleDialog","t","useTranslation","jsxs","Modal","ModalVariant","jsx","Alert","AlertVariant","Form","FormGroup","ClipboardCopy","CreateInitialAccessToken","handleSubmit","control","isValid","errors","useForm","realm","useRealm","addAlert","addError","useAlerts","navigate","useNavigate","setToken","useState","Fragment","toClients","ViewHeader","PageSection","FormAccess","clientToken","access","adminClient","error","HelpItem","Controller","field","TimeSelector","NumberInput","event","value","ActionGroup","Button","props","Link"],"mappings":"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"}