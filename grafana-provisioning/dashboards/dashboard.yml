apiVersion: 1

providers:
  - name: 'Default'
    orgId: 1
    folder: ''
    type: file
    disableDeletion: false
    editable: true
    options:
      path: /etc/grafana/provisioning/dashboards

dashboards:
  - name: 'Microservices Overview'
    uid: microservices-overview
    gnetId: null
    disableDeletion: false
    editable: true
    version: 1
    panels:
      - title: "HTTP Request Duration"
        type: "graph"
        datasource: "Prometheus"
        targets:
          - expr: 'histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket[5m])) by (le, service))'
            legendFormat: '{{service}}'
        gridPos:
          h: 8
          w: 12
          x: 0
          y: 0

      - title: "Request Count"
        type: "graph"
        datasource: "Prometheus"
        targets:
          - expr: 'sum(rate(http_request_duration_seconds_count[5m])) by (service)'
            legendFormat: '{{service}}'
        gridPos:
          h: 8
          w: 12
          x: 12
          y: 0

      - title: "Logs"
        type: "logs"
        datasource: "Loki"
        targets:
          - expr: '{job=~"varlogs"}'
        gridPos:
          h: 8
          w: 24
          x: 0
          y: 8